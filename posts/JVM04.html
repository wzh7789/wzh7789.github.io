<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>JVM类加载 | Wzh的纸箱🧊</title><meta name="keywords" content="JVM"><meta name="author" content="爱学技术的小吴🏵"><meta name="copyright" content="爱学技术的小吴🏵"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="JAVA中类的加载过程">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM类加载">
<meta property="og:url" content="https://w-zx.cc/posts/JVM04.html">
<meta property="og:site_name" content="Wzh的纸箱🧊">
<meta property="og:description" content="JAVA中类的加载过程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imgbed.link/file/27059">
<meta property="article:published_time" content="2023-05-07T10:19:03.000Z">
<meta property="article:modified_time" content="2023-05-17T14:00:00.000Z">
<meta property="article:author" content="爱学技术的小吴🏵">
<meta property="article:tag" content="JVM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imgbed.link/file/27059"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://w-zx.cc/posts/JVM04"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JVM类加载',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-17 22:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><link rel="stylesheet" href="https://npm.elemecdn.com/ethan4116-blog/lib/css/plane_v2.css"><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Wzh的纸箱🧊" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/26921" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> 回忆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Wzh的纸箱🧊</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> 回忆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="检索站内任何你想要的信息"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> 搜索</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="美化设置-自定义你的风格" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="浅色和深色模式转换" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">JVM类加载</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">发表于 </span><time class="post-meta-date-created" datetime="2023-05-07T10:19:03.000Z" title="发表于 2023-05-07 18:19:03">2023-05-07</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-17T14:00:00.000Z" title="更新于 2023-05-17 22:00:00">2023-05-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/JVM/">JVM</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">字数总计:</span><span class="word-count">2.4w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">阅读时长:</span><span>111分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JVM类加载"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>类文件结构</h1>
<ul>
<li>
<p>一个简单的HelloWorld.java</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        <span class="title class_">System</span>.<span class="property">out</span>.<span class="title function_">println</span>(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后查看其二进制字节码文件的内容</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">od -t xC target<span class="regexp">/classes/</span>com<span class="regexp">/demo/</span>HelloWorld.<span class="keyword">class</span></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/05/pp5L8lF.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/05/pp5L8lF.png" alt="img"></a></p>
</li>
<li>
<p>根据JVM规范，类文件结构如下</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">LESS</span><br><span class="line">ClassFile &#123;</span><br><span class="line">    u4 magic;                  <span class="regexp">//</span> 魔数，用于标识文件类型</span><br><span class="line">    u2 minor_version;          <span class="regexp">//</span> Java虚拟机的次版本号</span><br><span class="line">    u2 major_version;          <span class="regexp">//</span> Java虚拟机的主版本号</span><br><span class="line">    u2 constant_pool_count;    <span class="regexp">//</span> 常量池大小</span><br><span class="line">    cp_info constant_pool[constant_pool_count-<span class="number">1</span>]; <span class="regexp">//</span> 常量池数组</span><br><span class="line">    u2 access_flags;           <span class="regexp">//</span> 访问标识符，用于表示类或接口的访问控制</span><br><span class="line">    u2 this_class;             <span class="regexp">//</span> 当前类或接口的索引</span><br><span class="line">    u2 super_class;            <span class="regexp">//</span> 当前类的超类(父类)索引</span><br><span class="line">    u2 interfaces_count;       <span class="regexp">//</span> 接口数量</span><br><span class="line">    u2 interfaces[interfaces_count]; <span class="regexp">//</span> 接口索引列表</span><br><span class="line">    u2 fields_count;           <span class="regexp">//</span> 字段数量</span><br><span class="line">    field_info fields[fields_count]; <span class="regexp">//</span> 字段信息数组</span><br><span class="line">    u2 methods_count;          <span class="regexp">//</span> 方法数量</span><br><span class="line">    method_info methods[methods_count]; <span class="regexp">//</span> 方法信息数组</span><br><span class="line">    u2 attributes_count;       <span class="regexp">//</span> 类或接口的附加属性数量</span><br><span class="line">    attribute_info attributes[attributes_count]; <span class="regexp">//</span> 类或接口的附加属性信息数组</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="魔数">魔数</h2>
<ul>
<li>
<p>以下面的字节码文件，按顺序逐个进行分析</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute">0000000</span> ca fe ba be <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">34</span> <span class="number">00</span> <span class="number">23</span> <span class="number">0</span>a <span class="number">00</span> <span class="number">06</span> <span class="number">00</span> <span class="number">15</span> <span class="number">09</span></span><br><span class="line"><span class="attribute">0000020</span> <span class="number">00</span> <span class="number">16</span> <span class="number">00</span> <span class="number">17</span> <span class="number">08</span> <span class="number">00</span> <span class="number">18</span> <span class="number">0</span>a <span class="number">00</span> <span class="number">19</span> <span class="number">00</span> <span class="number">1</span>a <span class="number">07</span> <span class="number">00</span> <span class="number">1</span>b <span class="number">07</span></span><br><span class="line"><span class="attribute">0000040</span> <span class="number">00</span> <span class="number">1</span>c <span class="number">01</span> <span class="number">00</span> <span class="number">06</span> <span class="number">3</span>c <span class="number">69</span> <span class="number">6</span>e <span class="number">69</span> <span class="number">74</span> <span class="number">3</span>e <span class="number">01</span> <span class="number">00</span> <span class="number">03</span> <span class="number">28</span> <span class="number">29</span></span><br><span class="line"><span class="attribute">0000060</span> <span class="number">56</span> <span class="number">01</span> <span class="number">00</span> <span class="number">04</span> <span class="number">43</span> <span class="number">6</span>f <span class="number">64</span> <span class="number">65</span> <span class="number">01</span> <span class="number">00</span> <span class="number">0</span>f <span class="number">4</span>c <span class="number">69</span> <span class="number">6</span>e <span class="number">65</span> <span class="number">4</span>e</span><br><span class="line"><span class="attribute">0000100</span> <span class="number">75</span> <span class="number">6</span>d <span class="number">62</span> <span class="number">65</span> <span class="number">72</span> <span class="number">54</span> <span class="number">61</span> <span class="number">62</span> <span class="number">6</span>c <span class="number">65</span> <span class="number">01</span> <span class="number">00</span> <span class="number">12</span> <span class="number">4</span>c <span class="number">6</span>f <span class="number">63</span></span><br><span class="line"><span class="attribute">0000120</span> <span class="number">61</span> <span class="number">6</span>c <span class="number">56</span> <span class="number">61</span> <span class="number">72</span> <span class="number">69</span> <span class="number">61</span> <span class="number">62</span> <span class="number">6</span>c <span class="number">65</span> <span class="number">54</span> <span class="number">61</span> <span class="number">62</span> <span class="number">6</span>c <span class="number">65</span> <span class="number">01</span></span><br><span class="line"><span class="attribute">0000140</span> <span class="number">00</span> <span class="number">04</span> <span class="number">74</span> <span class="number">68</span> <span class="number">69</span> <span class="number">73</span> <span class="number">01</span> <span class="number">00</span> <span class="number">1</span>d <span class="number">4</span>c <span class="number">63</span> <span class="number">6</span>e <span class="number">2</span>f <span class="number">69</span> <span class="number">74</span> <span class="number">63</span></span><br><span class="line"><span class="attribute">0000160</span> <span class="number">61</span> <span class="number">73</span> <span class="number">74</span> <span class="number">2</span>f <span class="number">6</span>a <span class="number">76</span> <span class="number">6</span>d <span class="number">2</span>f <span class="number">74</span> <span class="number">35</span> <span class="number">2</span>f <span class="number">48</span> <span class="number">65</span> <span class="number">6</span>c <span class="number">6</span>c <span class="number">6</span>f</span><br><span class="line"><span class="attribute">0000200</span> <span class="number">57</span> <span class="number">6</span>f <span class="number">72</span> <span class="number">6</span>c <span class="number">64</span> <span class="number">3</span>b <span class="number">01</span> <span class="number">00</span> <span class="number">04</span> <span class="number">6</span>d <span class="number">61</span> <span class="number">69</span> <span class="number">6</span>e <span class="number">01</span> <span class="number">00</span> <span class="number">16</span></span><br><span class="line"><span class="attribute">0000220</span> <span class="number">28</span> <span class="number">5</span>b <span class="number">4</span>c <span class="number">6</span>a <span class="number">61</span> <span class="number">76</span> <span class="number">61</span> <span class="number">2</span>f <span class="number">6</span>c <span class="number">61</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">2</span>f <span class="number">53</span> <span class="number">74</span> <span class="number">72</span></span><br><span class="line"><span class="attribute">0000240</span> <span class="number">69</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">3</span>b <span class="number">29</span> <span class="number">56</span> <span class="number">01</span> <span class="number">00</span> <span class="number">04</span> <span class="number">61</span> <span class="number">72</span> <span class="number">67</span> <span class="number">73</span> <span class="number">01</span> <span class="number">00</span> <span class="number">13</span></span><br><span class="line"><span class="attribute">0000260</span> <span class="number">5</span>b <span class="number">4</span>c <span class="number">6</span>a <span class="number">61</span> <span class="number">76</span> <span class="number">61</span> <span class="number">2</span>f <span class="number">6</span>c <span class="number">61</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">2</span>f <span class="number">53</span> <span class="number">74</span> <span class="number">72</span> <span class="number">69</span></span><br><span class="line"><span class="attribute">0000300</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">3</span>b <span class="number">01</span> <span class="number">00</span> <span class="number">10</span> <span class="number">4</span>d <span class="number">65</span> <span class="number">74</span> <span class="number">68</span> <span class="number">6</span>f <span class="number">64</span> <span class="number">50</span> <span class="number">61</span> <span class="number">72</span> <span class="number">61</span></span><br><span class="line"><span class="attribute">0000320</span> <span class="number">6</span>d <span class="number">65</span> <span class="number">74</span> <span class="number">65</span> <span class="number">72</span> <span class="number">73</span> <span class="number">01</span> <span class="number">00</span> <span class="number">0</span>a <span class="number">53</span> <span class="number">6</span>f <span class="number">75</span> <span class="number">72</span> <span class="number">63</span> <span class="number">65</span> <span class="number">46</span></span><br><span class="line"><span class="attribute">0000340</span> <span class="number">69</span> <span class="number">6</span>c <span class="number">65</span> <span class="number">01</span> <span class="number">00</span> <span class="number">0</span>f <span class="number">48</span> <span class="number">65</span> <span class="number">6</span>c <span class="number">6</span>c <span class="number">6</span>f <span class="number">57</span> <span class="number">6</span>f <span class="number">72</span> <span class="number">6</span>c <span class="number">64</span></span><br><span class="line"><span class="attribute">0000360</span> <span class="number">2</span>e <span class="number">6</span>a <span class="number">61</span> <span class="number">76</span> <span class="number">61</span> <span class="number">0</span>c <span class="number">00</span> <span class="number">07</span> <span class="number">00</span> <span class="number">08</span> <span class="number">07</span> <span class="number">00</span> <span class="number">1</span>d <span class="number">0</span>c <span class="number">00</span> <span class="number">1</span>e</span><br><span class="line"><span class="attribute">0000400</span> <span class="number">00</span> <span class="number">1</span>f <span class="number">01</span> <span class="number">00</span> <span class="number">0</span>b <span class="number">68</span> <span class="number">65</span> <span class="number">6</span>c <span class="number">6</span>c <span class="number">6</span>f <span class="number">20</span> <span class="number">77</span> <span class="number">6</span>f <span class="number">72</span> <span class="number">6</span>c <span class="number">64</span></span><br><span class="line"><span class="attribute">0000420</span> <span class="number">07</span> <span class="number">00</span> <span class="number">20</span> <span class="number">0</span>c <span class="number">00</span> <span class="number">21</span> <span class="number">00</span> <span class="number">22</span> <span class="number">01</span> <span class="number">00</span> <span class="number">1</span>b <span class="number">63</span> <span class="number">6</span>e <span class="number">2</span>f <span class="number">69</span> <span class="number">74</span></span><br><span class="line"><span class="attribute">0000440</span> <span class="number">63</span> <span class="number">61</span> <span class="number">73</span> <span class="number">74</span> <span class="number">2</span>f <span class="number">6</span>a <span class="number">76</span> <span class="number">6</span>d <span class="number">2</span>f <span class="number">74</span> <span class="number">35</span> <span class="number">2</span>f <span class="number">48</span> <span class="number">65</span> <span class="number">6</span>c <span class="number">6</span>c</span><br><span class="line"><span class="attribute">0000460</span> <span class="number">6</span>f <span class="number">57</span> <span class="number">6</span>f <span class="number">72</span> <span class="number">6</span>c <span class="number">64</span> <span class="number">01</span> <span class="number">00</span> <span class="number">10</span> <span class="number">6</span>a <span class="number">61</span> <span class="number">76</span> <span class="number">61</span> <span class="number">2</span>f <span class="number">6</span>c <span class="number">61</span></span><br><span class="line"><span class="attribute">0000500</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">2</span>f <span class="number">4</span>f <span class="number">62</span> <span class="number">6</span>a <span class="number">65</span> <span class="number">63</span> <span class="number">74</span> <span class="number">01</span> <span class="number">00</span> <span class="number">10</span> <span class="number">6</span>a <span class="number">61</span> <span class="number">76</span> <span class="number">61</span></span><br><span class="line"><span class="attribute">0000520</span> <span class="number">2</span>f <span class="number">6</span>c <span class="number">61</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">2</span>f <span class="number">53</span> <span class="number">79</span> <span class="number">73</span> <span class="number">74</span> <span class="number">65</span> <span class="number">6</span>d <span class="number">01</span> <span class="number">00</span> <span class="number">03</span> <span class="number">6</span>f</span><br><span class="line"><span class="attribute">0000540</span> <span class="number">75</span> <span class="number">74</span> <span class="number">01</span> <span class="number">00</span> <span class="number">15</span> <span class="number">4</span>c <span class="number">6</span>a <span class="number">61</span> <span class="number">76</span> <span class="number">61</span> <span class="number">2</span>f <span class="number">69</span> <span class="number">6</span>f <span class="number">2</span>f <span class="number">50</span> <span class="number">72</span></span><br><span class="line"><span class="attribute">0000560</span> <span class="number">69</span> <span class="number">6</span>e <span class="number">74</span> <span class="number">53</span> <span class="number">74</span> <span class="number">72</span> <span class="number">65</span> <span class="number">61</span> <span class="number">6</span>d <span class="number">3</span>b <span class="number">01</span> <span class="number">00</span> <span class="number">13</span> <span class="number">6</span>a <span class="number">61</span> <span class="number">76</span></span><br><span class="line"><span class="attribute">0000600</span> <span class="number">61</span> <span class="number">2</span>f <span class="number">69</span> <span class="number">6</span>f <span class="number">2</span>f <span class="number">50</span> <span class="number">72</span> <span class="number">69</span> <span class="number">6</span>e <span class="number">74</span> <span class="number">53</span> <span class="number">74</span> <span class="number">72</span> <span class="number">65</span> <span class="number">61</span> <span class="number">6</span>d</span><br><span class="line"><span class="attribute">0000620</span> <span class="number">01</span> <span class="number">00</span> <span class="number">07</span> <span class="number">70</span> <span class="number">72</span> <span class="number">69</span> <span class="number">6</span>e <span class="number">74</span> <span class="number">6</span>c <span class="number">6</span>e <span class="number">01</span> <span class="number">00</span> <span class="number">15</span> <span class="number">28</span> <span class="number">4</span>c <span class="number">6</span>a</span><br><span class="line"><span class="attribute">0000640</span> <span class="number">61</span> <span class="number">76</span> <span class="number">61</span> <span class="number">2</span>f <span class="number">6</span>c <span class="number">61</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">2</span>f <span class="number">53</span> <span class="number">74</span> <span class="number">72</span> <span class="number">69</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">3</span>b</span><br><span class="line"><span class="attribute">0000660</span> <span class="number">29</span> <span class="number">56</span> <span class="number">00</span> <span class="number">21</span> <span class="number">00</span> <span class="number">05</span> <span class="number">00</span> <span class="number">06</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">01</span></span><br><span class="line"><span class="attribute">0000700</span> <span class="number">00</span> <span class="number">07</span> <span class="number">00</span> <span class="number">08</span> <span class="number">00</span> <span class="number">01</span> <span class="number">00</span> <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">2</span>f <span class="number">00</span> <span class="number">01</span> <span class="number">00</span> <span class="number">01</span></span><br><span class="line"><span class="attribute">0000720</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">05</span> <span class="number">2</span>a b7 <span class="number">00</span> <span class="number">01</span> b1 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>a <span class="number">00</span></span><br><span class="line"><span class="attribute">0000740</span> <span class="number">00</span> <span class="number">00</span> <span class="number">06</span> <span class="number">00</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">04</span> <span class="number">00</span> <span class="number">0</span>b <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">0</span>c <span class="number">00</span></span><br><span class="line"><span class="attribute">0000760</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">05</span> <span class="number">00</span> <span class="number">0</span>c <span class="number">00</span> <span class="number">0</span>d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">09</span> <span class="number">00</span> <span class="number">0</span>e <span class="number">00</span></span><br><span class="line"><span class="attribute">0001000</span> <span class="number">0</span>f <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">37</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0001020</span> <span class="number">09</span> b2 <span class="number">00</span> <span class="number">02</span> <span class="number">12</span> <span class="number">03</span> b6 <span class="number">00</span> <span class="number">04</span> b1 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>a</span><br><span class="line"><span class="attribute">0001040</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">0</span>a <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">06</span> <span class="number">00</span> <span class="number">08</span> <span class="number">00</span> <span class="number">07</span> <span class="number">00</span> <span class="number">0</span>b</span><br><span class="line"><span class="attribute">0001060</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">0</span>c <span class="number">00</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">09</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">11</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0001100</span> <span class="number">00</span> <span class="number">12</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">05</span> <span class="number">01</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">01</span> <span class="number">00</span> <span class="number">13</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0001120</span> <span class="number">00</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">14</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>0-3字节，表示它是否是<code>class</code>类型的文件</p>
<ul>
<li>0000000 <code>ca fe ba be</code> 00 00 00 34 00 22 0a 00 06 00 14 09</li>
</ul>
</li>
<li>
<p>在Java中，所有的.class文件都以魔数</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ca</span> fe <span class="keyword">ba</span> <span class="keyword">be</span></span><br></pre></td></tr></table></figure>
<p>开头，这个魔数的前4个字节用于识别该文件是否为Java类文件，如果这个魔数不匹配，那么Java虚拟机将无法加载该文件。</p>
<ul>
<li>
<p>关于</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cafebabe</span></span><br></pre></td></tr></table></figure>
<p>这个魔数的由来并没有具体的官方解释，但有一些有趣的猜测和传说。</p>
<ul>
<li>一种说法是，这个魔数是由Java的创造者之一、现任谷歌高管James Gosling取的。据说Gosling是个爱好咖啡的人，他认为Java这个名字也与咖啡有关，所以他将cafebabe取作魔数来向咖啡致敬。另外，有一种传说认为这个魔数是来自于一个好莱坞电影中的经典台词，<code>cafe babe</code>（咖啡宝贝？）。</li>
<li>然而，无论是什么样的由来，cafebabe这个魔数现在已经成为Java世界中的一个标志，每一个Java程序员都能够轻松地辨认出这个魔数，这也是Java文件格式稳定性的一个体现。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="版本">版本</h2>
<ul>
<li>4-7字节，表示类的版本 <code>00 34(52)</code>对应十进制为52，表示的是<code>Java 8</code></li>
</ul>
<h2 id="常量池">常量池</h2>
<table>
<thead>
<tr>
<th style="text-align:center">Constant Type</th>
<th style="text-align:center">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">CONSTANT_Utf8</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Integer</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Float</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Long</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Double</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Class</td>
<td style="text-align:center">7</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_String</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Fieldref</td>
<td style="text-align:center">9</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Methodref</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_InterfaceMethodref</td>
<td style="text-align:center">11</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_NameAndType</td>
<td style="text-align:center">12</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_MethodHandle</td>
<td style="text-align:center">15</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_MethodType</td>
<td style="text-align:center">16</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_InvokeDynamic</td>
<td style="text-align:center">18</td>
</tr>
</tbody>
</table>
<ul>
<li>8-9字节，表示常量池长度
<ul>
<li>0000000 ca fe ba be 00 00 00 34 <code>00 22</code> 0a 00 06 00 14 09</li>
<li><code>00 22(34)</code>，表示常量池有<code>#1-#33</code>项，注意#0项不计入，也没有值</li>
</ul>
</li>
</ul>
<ol>
<li>
<p><code>第#1项</code> 0a 表示一个 Method 信息，00 06 和 00 14（20） 表示它引用了常量池中 #6 和 #20 项来获得这个方法的<code>所属类</code>和<code>方法名</code></p>
<ul>
<li>0000000 ca fe ba be 00 00 00 34 00 22 <code>0a 00 06 00 14</code> 09</li>
</ul>
</li>
<li>
<p><code>第#2项</code> 09 表示一个 Field 信息，00 16（22）和 00 17（23） 表示它引用了常量池中 #22 和 # 23 项来获得这个成员变量的<code>所属类</code>和<code>成员变量名</code></p>
<ul>
<li>0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 <code>09</code></li>
<li>0000020 <code>00 16 00 17</code> 08 00 18 0a 00 19 00 1a 07 00 1b 07</li>
</ul>
</li>
<li>
<p><code>第#3项</code> 08 表示一个字符串常量名称，00 18（24）表示它引用了常量池中 #24 项</p>
<ul>
<li>0000020 00 16 00 17 <code>08 00 18</code> 0a 00 19 00 1a 07 00 1b 07</li>
</ul>
</li>
<li>
<p><code>第#4项</code> 0a 表示一个 Method 信息，00 19（25） 和 00 1a（26） 表示它引用了常量池中 #25 和 #26项来获得这个方法的<code>所属类</code>和<code>方法名</code></p>
<ul>
<li>0000020 00 16 00 17 08 00 18 <code>0a 00 19 00 1a</code> 07 00 1b 07</li>
</ul>
</li>
<li>
<pre><code>第#5项
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">  <span class="number"> 07 </span>表示一个 Class 信息，00 1b（27） 表示它引用了常量池中 <span class="comment">#27 项</span></span><br><span class="line"></span><br><span class="line">   -<span class="number"> 0000020 </span>00<span class="number"> 16 </span>00<span class="number"> 17 </span>08<span class="number"> 00 </span>18 0a<span class="number"> 00 </span>19<span class="number"> 00 </span>1a `07<span class="number"> 00 </span>1b` 07</span><br><span class="line"></span><br><span class="line">6. ```</span><br><span class="line">   第<span class="comment">#6项</span></span><br></pre></td></tr></table></figure>

 

07 表示一个 Class 信息，00 1c（28） 表示它引用了常量池中 #28 项

- 0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b `07`
- 0000040 `00 1c` 01 00 06 3c 69 6e 69 74 3e 01 00 03 28 29

</code></pre>
</li>
<li>
<pre><code>第#7项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">06</span> 表示长度，<span class="number">3</span>c <span class="number">69</span> <span class="number">6</span>e <span class="number">69</span> <span class="number">74</span> <span class="number">3</span>e 是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
&lt;init&gt;
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   -<span class="number"> 0000040 </span>00 1c<span class="number"> 01 </span>`00<span class="number"> 06 </span>3c<span class="number"> 69 </span>6e<span class="number"> 69 </span>74 3e`<span class="number"> 01 </span>00<span class="number"> 03 </span>28 29</span><br><span class="line"></span><br><span class="line">8. ```</span><br><span class="line">   第<span class="comment">#8项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 03 表示长度，28 29 56 是

<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">()</span>V</span><br></pre></td></tr></table></figure>

其实就是表示无参、无返回值

- 0000040 00 1c 01 00 06 3c 69 6e 69 74 3e `01 00 03 28 29`
- 0000060 `56` 01 00 04 43 6f 64 65 01 00 0f 4c 69 6e 65 4e

</code></pre>
</li>
<li>
<pre><code>第#9项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">04</span> 表示长度，<span class="number">43</span> <span class="number">6</span>f <span class="number">64</span> <span class="number">65</span> 是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
Code
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   -<span class="number"> 0000060 </span>56 `01<span class="number"> 00 </span>04<span class="number"> 43 </span>6f<span class="number"> 64 </span>65`<span class="number"> 01 </span>00 0f 4c<span class="number"> 69 </span>6e<span class="number"> 65 </span>4e</span><br><span class="line"></span><br><span class="line">10. ```</span><br><span class="line">    第<span class="comment">#10项</span></span><br></pre></td></tr></table></figure>

  

 01 表示一个 utf8 串，00 0f（15） 表示长度，4c 69 6e 65 4e 75 6d 62 65 72 54 61 62 6c 65 是

 <figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">LineNumberTable</span></span><br></pre></td></tr></table></figure>

 - 0000060 56 01 00 04 43 6f 64 `65 01 00 0f 4c 69 6e 65 4e`
 - 0000100 `75 6d 62 65 72 54 61 62 6c 65` 01 00 12 4c 6f 63

</code></pre>
</li>
<li>
<pre><code>第#11项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">12</span>（<span class="number">18</span>） 表示长度，<span class="number">4</span>c <span class="number">6</span>f <span class="number">63</span> <span class="number">61</span> <span class="number">6</span>c <span class="number">56</span> <span class="number">61</span> <span class="number">72</span> <span class="number">69</span> <span class="number">61</span> <span class="number">62</span> <span class="number">6</span>c <span class="number">65</span> <span class="number">54</span> <span class="number">61</span> <span class="number">62</span> <span class="number">6</span>c <span class="number">65</span>是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
LocalVariableTable
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000100 </span>75 6d<span class="number"> 62 </span>65<span class="number"> 72 </span>54<span class="number"> 61 </span>62 6c<span class="number"> 65 </span>`01<span class="number"> 00 </span>12 4c 6f 63`</span><br><span class="line">    -<span class="number"> 0000120 </span>`61 6c<span class="number"> 56 </span>61<span class="number"> 72 </span>69<span class="number"> 61 </span>62 6c<span class="number"> 65 </span>54<span class="number"> 61 </span>62 6c 65` 01</span><br><span class="line"></span><br><span class="line">12. ```</span><br><span class="line">    第<span class="comment">#12项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 04 表示长度，74 68 69 73 是

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span></span><br></pre></td></tr></table></figure>

- 0000120 61 6c 56 61 72 69 61 62 6c 65 54 61 62 6c 65 `01`
- 0000140 `00 04 74 68 69 73` 01 00 1d 4c 63 6e 2f 69 74 63

</code></pre>
</li>
<li>
<pre><code>第#13项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">1</span>d（<span class="number">29</span>） 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
Lcn/itcast/jvm/t5/HelloWorld;
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000140 </span>00<span class="number"> 04 </span>74<span class="number"> 68 </span>69<span class="number"> 73 </span>`01<span class="number"> 00 </span>1d 4c<span class="number"> 63 </span>6e 2f<span class="number"> 69 </span>74 63`</span><br><span class="line">    -<span class="number"> 0000160 </span>`61<span class="number"> 73 </span>74 2f 6a<span class="number"> 76 </span>6d 2f<span class="number"> 74 </span>35 2f<span class="number"> 48 </span>65 6c 6c 6f`</span><br><span class="line">    -<span class="number"> 0000200 </span>`57 6f<span class="number"> 72 </span>6c<span class="number"> 64 </span>3b`<span class="number"> 01 </span>00<span class="number"> 04 </span>6d<span class="number"> 61 </span>69 6e<span class="number"> 01 </span>00 16</span><br><span class="line"></span><br><span class="line">14. ```</span><br><span class="line">    第<span class="comment">#14项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 04 表示长度，74 68 69 73 是

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">main</span></span><br></pre></td></tr></table></figure>

- 0000200 57 6f 72 6c 64 3b `01 00 04 6d 61 69 6e` 01 00 16

</code></pre>
</li>
<li>
<pre><code>第#15项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">16</span>（<span class="number">22</span>） 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
([Ljava/lang/String;)V
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    其实就是参数为字符串数组，无返回值</span><br><span class="line"></span><br><span class="line">    -<span class="number"> 0000200 </span>57 6f<span class="number"> 72 </span>6c<span class="number"> 64 </span>3b<span class="number"> 01 </span>00<span class="number"> 04 </span>6d<span class="number"> 61 </span>69 6e `01<span class="number"> 00 </span>16`</span><br><span class="line">    -<span class="number"> 0000220 </span>`28 5b 4c 6a<span class="number"> 61 </span>76<span class="number"> 61 </span>2f 6c<span class="number"> 61 </span>6e<span class="number"> 67 </span>2f<span class="number"> 53 </span>74 72`</span><br><span class="line">    -<span class="number"> 0000240 </span>`69 6e<span class="number"> 67 </span>3b<span class="number"> 29 </span>56`<span class="number"> 01 </span>00<span class="number"> 04 </span>61<span class="number"> 72 </span>67<span class="number"> 73 </span>01<span class="number"> 00 </span>13</span><br><span class="line"></span><br><span class="line">16. ```</span><br><span class="line">    第<span class="comment">#16项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 04 表示长度，是

<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">args</span></span><br></pre></td></tr></table></figure>

- 0000240 69 6e 67 3b 29 56 `01 00 04 61 72 67 73` 01 00 13

</code></pre>
</li>
<li>
<pre><code>第#17项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">13</span>（<span class="number">19</span>） 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
[Ljava/lang/String;
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000240 </span>69 6e<span class="number"> 67 </span>3b<span class="number"> 29 </span>56<span class="number"> 01 </span>00<span class="number"> 04 </span>61<span class="number"> 72 </span>67<span class="number"> 73 </span>`01<span class="number"> 00 </span>13`</span><br><span class="line">    -<span class="number"> 0000260 </span>`5b 4c 6a<span class="number"> 61 </span>76<span class="number"> 61 </span>2f 6c<span class="number"> 61 </span>6e<span class="number"> 67 </span>2f<span class="number"> 53 </span>74<span class="number"> 72 </span>69`</span><br><span class="line">    -<span class="number"> 0000300 </span>`6e<span class="number"> 67 </span>3b`<span class="number"> 01 </span>00<span class="number"> 10 </span>4d<span class="number"> 65 </span>74<span class="number"> 68 </span>6f<span class="number"> 64 </span>50<span class="number"> 61 </span>72 61</span><br><span class="line"></span><br><span class="line">18. ```</span><br><span class="line">    第<span class="comment">#18项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 10（16） 表示长度，是

<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">MethodParameters</span></span><br></pre></td></tr></table></figure>

- 0000300 6e 67 3b `01 00 10 4d 65 74 68 6f 64 50 61 72 61`
- 0000320 `6d 65 74 65 72 73` 01 00 0a 53 6f 75 72 63 65 46

</code></pre>
</li>
<li>
<pre><code>第#19项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">0</span>a（<span class="number">10</span>） 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
SourceFile
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000320 </span>6d<span class="number"> 65 </span>74<span class="number"> 65 </span>72<span class="number"> 73 </span>`01<span class="number"> 00 </span>0a<span class="number"> 53 </span>6f<span class="number"> 75 </span>72<span class="number"> 63 </span>65 46`</span><br><span class="line">    -<span class="number"> 0000340 </span>`69 6c 65`<span class="number"> 01 </span>00 0f<span class="number"> 48 </span>65 6c 6c 6f<span class="number"> 57 </span>6f<span class="number"> 72 </span>6c 64</span><br><span class="line"></span><br><span class="line">20. ```</span><br><span class="line">    第<span class="comment">#20项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 0f（15） 表示长度，是

<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">HelloWorld</span>.</span></span>java</span><br></pre></td></tr></table></figure>

- 0000340 69 6c 65 `01 00 0f 48 65 6c 6c 6f 57 6f 72 6c 64`
- 0000360 `2e 6a 61 76 61` 0c 00 07 00 08 07 00 1d 0c 00 1e

</code></pre>
</li>
<li>
<pre><code>第#21项
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="number">0</span><span class="keyword">c</span> 表示一个</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
名+类型
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    ，00<span class="number"> 07 </span>00<span class="number"> 08 </span>引用了常量池中 <span class="comment">#7 #8 两项</span></span><br><span class="line"></span><br><span class="line">    -<span class="number"> 0000360 </span>2e 6a<span class="number"> 61 </span>76<span class="number"> 61 </span>`0c<span class="number"> 00 </span>07<span class="number"> 00 </span>08`<span class="number"> 07 </span>00 1d 0c<span class="number"> 00 </span>1e</span><br><span class="line"></span><br><span class="line">22. ```</span><br><span class="line">    第<span class="comment">#22项</span></span><br></pre></td></tr></table></figure>

 

07 表示一个 Class 信息，00 1d（29） 引用了常量池中 #29 项

- 0000360 2e 6a 61 76 61 0c 00 07 00 08 `07 00 1d` 0c 00 1e

</code></pre>
</li>
<li>
<pre><code>第#23项
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="number">0</span><span class="keyword">c</span> 表示一个</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
名+类型
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    ，00 1e（30）<span class="number"> 00 </span>1f （31）引用了常量池中 <span class="comment">#30 #31 两项</span></span><br><span class="line"></span><br><span class="line">    -<span class="number"> 0000360 </span>2e 6a<span class="number"> 61 </span>76<span class="number"> 61 </span>0c<span class="number"> 00 </span>07<span class="number"> 00 </span>08<span class="number"> 07 </span>00 1d `0c<span class="number"> 00 </span>1e`</span><br><span class="line">    -<span class="number"> 0000400 </span>`00 1f`<span class="number"> 01 </span>00 0b<span class="number"> 68 </span>65 6c 6c 6f<span class="number"> 20 </span>77 6f<span class="number"> 72 </span>6c 64</span><br><span class="line"></span><br><span class="line">24. ```</span><br><span class="line">    第<span class="comment">#24项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 0f（15） 表示长度，是

<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hello world</span></span><br></pre></td></tr></table></figure>

- 0000400 00 1f `01 00 0b 68 65 6c 6c 6f 20 77 6f 72 6c 64`

</code></pre>
</li>
<li>
<pre><code>第#25项
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">     </span><br><span class="line"></span><br><span class="line">   <span class="number"> 07 </span>表示一个 Class 信息，00 20（32） 引用了常量池中 <span class="comment">#32 项</span></span><br><span class="line"></span><br><span class="line">    -<span class="number"> 0000420 </span>`07<span class="number"> 00 </span>20` 0c<span class="number"> 00 </span>21<span class="number"> 00 </span>22<span class="number"> 01 </span>00 1b<span class="number"> 63 </span>6e 2f<span class="number"> 69 </span>74</span><br><span class="line"></span><br><span class="line">26. ```</span><br><span class="line">    第<span class="comment">#26项</span></span><br></pre></td></tr></table></figure>

 

0c 表示一个

 

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">名+类型</span><br></pre></td></tr></table></figure>

，00 21（33） 00 22（34）引用了常量池中 #33 #34 两项

- 0000420 07 00 20 `0c 00 21 00 22` 01 00 1b 63 6e 2f 69 74

</code></pre>
</li>
<li>
<pre><code>第#27项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">1</span>b（<span class="number">27</span>） 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
cn/itcast/jvm/t5/HelloWorld
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000420 </span>07<span class="number"> 00 </span>20 0c<span class="number"> 00 </span>21<span class="number"> 00 </span>22<span class="number"> 01 </span>`00 1b<span class="number"> 63 </span>6e 2f<span class="number"> 69 </span>74`</span><br><span class="line">    -<span class="number"> 0000440 </span>`63<span class="number"> 61 </span>73<span class="number"> 74 </span>2f 6a<span class="number"> 76 </span>6d 2f<span class="number"> 74 </span>35 2f<span class="number"> 48 </span>65 6c 6c`</span><br><span class="line">    -<span class="number"> 0000460 </span>`6f<span class="number"> 57 </span>6f<span class="number"> 72 </span>6c 64`<span class="number"> 01 </span>00<span class="number"> 10 </span>6a<span class="number"> 61 </span>76<span class="number"> 61 </span>2f 6c 61</span><br><span class="line"></span><br><span class="line">28. ```</span><br><span class="line">    第<span class="comment">#28项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 10（16） 表示长度，是

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java<span class="regexp">/lang/</span>Object</span><br></pre></td></tr></table></figure>

- 0000460 6f 57 6f 72 6c 64 `01 00 10 6a 61 76 61 2f 6c 61`
- 0000500 `6e 67 2f 4f 62 6a 65 63 74` 01 00 10 6a 61 76 61

</code></pre>
</li>
<li>
<pre><code>第#29项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">10</span>（<span class="number">16</span>） 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
java/lang/System
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000500 </span>6e<span class="number"> 67 </span>2f 4f<span class="number"> 62 </span>6a<span class="number"> 65 </span>63<span class="number"> 74 </span>`01<span class="number"> 00 </span>10 6a<span class="number"> 61 </span>76 61`</span><br><span class="line">    -<span class="number"> 0000520 </span>`2f 6c<span class="number"> 61 </span>6e<span class="number"> 67 </span>2f<span class="number"> 53 </span>79<span class="number"> 73 </span>74<span class="number"> 65 </span>6d`<span class="number"> 01 </span>00<span class="number"> 03 </span>6f</span><br><span class="line"></span><br><span class="line">30. ```</span><br><span class="line">    第<span class="comment">#30项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 03 表示长度，是

<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">out</span></span><br></pre></td></tr></table></figure>

- 0000520 2f 6c 61 6e 67 2f 53 79 73 74 65 6d `01 00 03 6f`
- 0000540 `75 74` 01 00 15 4c 6a 61 76 61 2f 69 6f 2f 50 72

</code></pre>
</li>
<li>
<pre><code>第#31项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">15</span>（<span class="number">21</span>） 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
Ljava/io/PrintStream;
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000540 </span>75<span class="number"> 74 </span>`01<span class="number"> 00 </span>15 4c 6a<span class="number"> 61 </span>76<span class="number"> 61 </span>2f<span class="number"> 69 </span>6f 2f<span class="number"> 50 </span>72`</span><br><span class="line">    -<span class="number"> 0000560 </span>`69 6e<span class="number"> 74 </span>53<span class="number"> 74 </span>72<span class="number"> 65 </span>61 6d 3b`<span class="number"> 01 </span>00<span class="number"> 13 </span>6a<span class="number"> 61 </span>76</span><br><span class="line"></span><br><span class="line">32. ```</span><br><span class="line">    第<span class="comment">#32项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 13（19） 表示长度，是

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java<span class="regexp">/io/</span>PrintStream</span><br></pre></td></tr></table></figure>

- 0000560 69 6e 74 53 74 72 65 61 6d 3b `01 00 13 6a 61 76`
- 0000600 `61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d`

</code></pre>
</li>
<li>
<pre><code>第#33项
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attribute">01</span> 表示一个 utf8 串，<span class="number">00</span> <span class="number">07</span> 表示长度，是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
println
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    -<span class="number"> 0000620 </span>`01<span class="number"> 00 </span>07<span class="number"> 70 </span>72<span class="number"> 69 </span>6e<span class="number"> 74 </span>6c 6e`<span class="number"> 01 </span>00<span class="number"> 15 </span>28 4c 6a</span><br><span class="line"></span><br><span class="line">34. ```</span><br><span class="line">    第<span class="comment">#34项</span></span><br></pre></td></tr></table></figure>

 

01 表示一个 utf8 串，00 15（21） 表示长度，是

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Ljava<span class="regexp">/lang/</span>String;)V</span><br></pre></td></tr></table></figure>

- 0000620 01 00 07 70 72 69 6e 74 6c 6e `01 00 15 28 4c 6a`
- 0000640 `61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b`
- 0000660 `29 56` 00 21 00 05 00 06 00 00 00 00 00 02 00 01

</code></pre>
</li>
</ol>
<h2 id="访问标识与继承信息">访问标识与继承信息</h2>
<ul>
<li>访问标识符：21表示class是一个类，公共的
<ul>
<li>0000660 29 56 <code>00 21</code> 00 05 00 06 00 00 00 00 00 02 00 01</li>
</ul>
</li>
<li>当前类或接口的索引：05表示根据常量池中的#5找到本类的全限定名
<ul>
<li>0000660 29 56 00 21 <code>00 05</code> 00 06 00 00 00 00 00 02 00 01</li>
</ul>
</li>
<li>当前类的超类（父类）索引：06表示根据常量池中的#6找到父类全限定名
<ul>
<li>0000660 29 56 00 21 00 05 <code>00 06</code> 00 00 00 00 00 02 00 01</li>
</ul>
</li>
<li>接口数量：本类为0
<ul>
<li>0000660 29 56 00 21 00 05 00 06 <code>00 00</code> 00 00 00 02 00 01</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">Flag Name</th>
<th style="text-align:center">Value</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ACC_PUBLIC</td>
<td style="text-align:center">0x0001</td>
<td>Declared public; may be accessed from outside its package.</td>
</tr>
<tr>
<td style="text-align:center">ACC_FINAL</td>
<td style="text-align:center">0x0010</td>
<td>Declared final; no subclasses allowed.</td>
</tr>
<tr>
<td style="text-align:center">ACC_SUPER</td>
<td style="text-align:center">0x0020</td>
<td>Treat superclass methods specially when invoked by the invokespecial instruction.</td>
</tr>
<tr>
<td style="text-align:center">ACC_INTERFACE</td>
<td style="text-align:center">0x0200</td>
<td>Is an interface, not a class.</td>
</tr>
<tr>
<td style="text-align:center">ACC_ABSTRACT</td>
<td style="text-align:center">0x0400</td>
<td>Declared abstract; must not be instantiated.</td>
</tr>
<tr>
<td style="text-align:center">ACC_SYNTHETIC</td>
<td style="text-align:center">0x1000</td>
<td>Declared synthetic; not present in the source code.</td>
</tr>
<tr>
<td style="text-align:center">ACC_ANNOTATION</td>
<td style="text-align:center">0x2000</td>
<td>Declared as an annotation type.</td>
</tr>
<tr>
<td style="text-align:center">ACC_ENUM</td>
<td style="text-align:center">0x4000</td>
<td>Declared as an enum type.</td>
</tr>
</tbody>
</table>
<h2 id="Field信息">Field信息</h2>
<ul>
<li>字段数量（成员变量数量），本类为0
<ul>
<li>0000660 29 56 00 21 00 05 00 06 00 00 <code>00 00</code> 00 02 00 01</li>
</ul>
</li>
</ul>
<h2 id="Method信息">Method信息</h2>
<ul>
<li>
<p>方法数量：本类为2，构造方法和main方法</p>
<ul>
<li>0000660 29 56 00 21 00 05 00 06 00 00 00 00 <code>00 02</code> 00 01</li>
</ul>
</li>
<li>
<p>一个方法由访问修饰符、名称、参数描述、方法苏属性数量、方法属性组成</p>
</li>
<li>
<p>00 01表示访问修饰符（本类中为public）</p>
<ul>
<li>0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 <code>00 01</code></li>
</ul>
</li>
<li>
<p>00 07表示引用了常量池中的#07项作为方法名称</p>
<ul>
<li>0000700 <code>00 07</code> 00 08 00 01 00 09 00 00 00 2f 00 01 00 01</li>
</ul>
</li>
<li>
<p>00 08表示引用了常量池中的#08项作为方法参数描述</p>
<ul>
<li>0000700 00 07 <code>00 08</code> 00 01 00 09 00 00 00 2f 00 01 00 01</li>
</ul>
</li>
<li>
<p>01表示引方法属性数量，本方法是1</p>
<ul>
<li>0000700 00 07 00 08 <code>00 01</code> 00 09 00 00 00 2f 00 01 00 01</li>
</ul>
</li>
<li>
<p>00 09表示引用常量池#09项，发现是</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">code</span></span><br></pre></td></tr></table></figure>
<p>属性</p>
<ul>
<li>0000700 00 07 00 08 00 01 <code>00 09</code> 00 00 00 2f 00 01 00 01</li>
</ul>
</li>
<li>
<p>00 00 00 2f表示此属性的长度是47</p>
<ul>
<li>0000700 00 07 00 08 00 01 00 09 <code>00 00 00 2f</code> 00 01 00 01</li>
</ul>
</li>
<li>
<p>00 01表示操作数栈最大深度</p>
<ul>
<li>0000700 00 07 00 08 00 01 00 09 00 00 00 2f <code>00 01</code> 00 01</li>
</ul>
</li>
<li>
<p>00 01表示局部变量最大槽(slot)数</p>
<ul>
<li>0000700 00 07 00 08 00 01 00 09 00 00 00 2f 00 01 <code>00 01</code></li>
</ul>
</li>
<li>
<p>00 00 00 05表示字节码长度，本例为5</p>
<ul>
<li>0000720 <code>00 00 00 05</code> 2a b7 00 01 b1 00 00 00 02 00 0a 00</li>
</ul>
</li>
<li>
<p>2a b7 00 01 b1 是字节码指令</p>
<ul>
<li>0000720 00 00 00 05 <code>2a b7 00 01 b1</code> 00 00 00 02 00 0a 00</li>
</ul>
</li>
<li>
<p>00 00 00 02 表示方法细节属性数量，本例为2</p>
<ul>
<li>0000720 00 00 00 05 2a b7 00 01 b1 <code>00 00 00 02</code> 00 0a 00</li>
</ul>
</li>
<li>
<p>00 0a表示引用了常量池#10项，发现是LineNumberTable属性</p>
<ul>
<li>0000720 00 00 00 05 2a b7 00 01 b1 00 00 00 02 <code>00 0a</code> 00</li>
<li>00 00 00 06表示此属性的总长度，本例是6
<ul>
<li>0000720 00 00 00 05 2a b7 00 01 b1 00 00 00 02 00 0a <code>00</code></li>
<li>0000740 <code>00 00 06</code> 00 01 00 00 00 04 00 0b 00 00 00 0c 00</li>
</ul>
</li>
<li>00 01表示LineNumberTable长度
<ul>
<li>0000740 00 00 06 <code>00 01</code> 00 00 00 04 00 0b 00 00 00 0c 00</li>
</ul>
</li>
<li>00 00 表示字节码行号
<ul>
<li>0000740 00 00 06 00 01 <code>00 00</code> 00 04 00 0b 00 00 00 0c 00</li>
</ul>
</li>
<li>00 04表示Java源码行号
<ul>
<li>0000740 00 00 06 00 01 00 00 <code>00 04</code> 00 0b 00 00 00 0c 00</li>
</ul>
</li>
</ul>
</li>
<li>
<p>00 0b表示引用了常量池#11项，发现是LocalVariableTable属性</p>
<ul>
<li>
<p>0000740 00 00 06 00 01 00 00 00 04 <code>00 0b</code> 00 00 00 0c 00</p>
</li>
<li>
<p>00 00 00 0c 表示此属性总长度，本例为12</p>
<ul>
<li>0000740 00 00 06 00 01 00 00 00 04 00 0b <code>00 00 00 0c</code> 00</li>
</ul>
</li>
<li>
<p>00 01 表示</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">LocalVariableTable</span></span><br></pre></td></tr></table></figure>
<p>长度</p>
<ul>
<li>0000740 00 00 06 00 01 00 00 00 04 00 0b 00 00 00 0c <code>00</code></li>
<li>0000760 <code>01</code> 00 00 00 05 00 0c 00 0d 00 00 00 09 00 0e 00</li>
</ul>
</li>
<li>
<p>00 00 表示局部变量生命周期开始，相对于字节码的偏移量</p>
<ul>
<li>
<ul>
<li>0000760 01 <code>00 00</code> 00 05 00 0c 00 0d 00 00 00 09 00 0e 00</li>
</ul>
</li>
</ul>
</li>
<li>
<p>00 05 表示局部变量覆盖的范围长度</p>
<ul>
<li>0000760 01 00 00 <code>00 05</code> 00 0c 00 0d 00 00 00 09 00 0e 00</li>
</ul>
</li>
<li>
<p>00 0c 表示局部变量的名称，引用常量池#12项</p>
<ul>
<li>0000760 01 00 00 00 05 <code>00 0c</code> 00 0d 00 00 00 09 00 0e 00</li>
</ul>
</li>
<li>
<p>00 0d 表示局部变量的类型，本例引用了常量池 #13 项，是</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lcn<span class="regexp">/itcast/</span>jvm<span class="regexp">/t5/</span>HelloWorld;</span><br></pre></td></tr></table></figure>
<ul>
<li>0000760 01 00 00 00 05 00 0c <code>00 0d</code> 00 00 00 09 00 0e 00</li>
</ul>
</li>
<li>
<p>00 00 表述局部变量占有的槽位(slot)编号，本例是0</p>
<ul>
<li>0000760 01 00 00 00 05 00 0c 00 0d <code>00 00</code> 00 09 00 0e 00</li>
</ul>
</li>
</ul>
</li>
<li>
<p>00 09代表访问修饰符（本类中是 public static）</p>
</li>
<li>
<p>00 0e 代表引用了常量池 #14 项作为方法名称</p>
</li>
<li>
<p>00 0f 代表引用了常量池 #15 项作为方法参数描述</p>
</li>
<li>
<p>00 02 代表方法属性数量，本方法是 2</p>
</li>
<li>
<p>其余代表方法属性（属性1）</p>
<ul>
<li>
<p>00 09 表示引用了常量池 #09 项，发现是<code>Code</code>属性</p>
</li>
<li>
<p>00 00 00 37 表示此属性的长度是 55</p>
</li>
<li>
<p>00 02 表示<code>操作数栈</code>最大深度</p>
</li>
<li>
<p>00 01 表示<code>局部变量表</code>最大槽（slot）数</p>
</li>
<li>
<p>00 00 00 05 表示字节码长度，本例是 9</p>
</li>
<li>
<p>b2 00 02 12 03 b6 00 04 b1 是字节码指令</p>
</li>
<li>
<p>00 00 00 02 表示方法细节属性数量，本例是 2</p>
</li>
<li>
<p>00 0a 表示引用了常量池 #10 项，发现是</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">LineNumberTable</span></span><br></pre></td></tr></table></figure>
<p>属性</p>
<ul>
<li>00 00 00 0a 表示此属性的总长度，本例是 10</li>
<li>00 02 表示<code>LineNumberTable</code>长度</li>
<li>00 00 表示<code>字节码</code>行号 00 06 表示<code>java 源码</code>行号</li>
<li>00 08 表示<code>字节码</code>行号 00 07 表示<code>java 源码</code>行号</li>
</ul>
</li>
</ul>
</li>
<li>
<p>00 0b 表示引用了常量池 #11 项，发现是<code>LocalVariableTable</code>属性</p>
<ul>
<li>00 00 00 0c 表示此属性的总长度，本例是 12</li>
<li>00 01 表示<code>LocalVariableTable</code>长度</li>
<li>00 00 表示局部变量生命周期开始，相对于字节码的偏移量</li>
<li>00 09 表示局部变量覆盖的范围长度</li>
<li>00 10 表示局部变量名称，本例引用了常量池 #16 项，是<code>args</code></li>
<li>00 11 表示局部变量的类型，本例引用了常量池 #17 项，是<code>[Ljava/lang/String;</code></li>
<li>00 00 表示局部变量占有的槽位（slot）编号，本例是 0</li>
</ul>
</li>
<li>
<p>0000760 01 00 00 00 05 00 0c 00 0d 00 00 <code>00 09 00 0e 00</code></p>
</li>
<li>
<p>0001000 <code>0f 00 02 00 09 00 00 00 37 00 02 00 01 00 00 00</code></p>
</li>
<li>
<p>0001020 <code>09 b2 00 02 12 03 b6 00 04 b1 00 00 00 02 00 0a</code></p>
</li>
<li>
<p>0001040 <code>00 00 00 0a 00 02 00 00 00 06 00 08 00 07 00 0b</code></p>
</li>
<li>
<p>0001060 <code>00 00 00 0c 00 01 00 00 00 09 00 10 00 11 00 00</code></p>
</li>
<li>
<p>红色代表方法属性（属性2）</p>
<ul>
<li>00 12 表示引用了常量池 #18 项，发现是<code>MethodParameters</code>属性</li>
<li>00 00 00 05 表示此属性的总长度，本例是 5</li>
<li>01 参数数量</li>
<li>00 10 表示引用了常量池 #16 项，是<code>args</code></li>
<li>00 00 访问修饰符</li>
<li>0001100 <code>00 12 00 00 00 05 01 00 10 00 00</code> 00 01 00 13 00</li>
</ul>
</li>
</ul>
<h2 id="附加属性">附加属性</h2>
<ul>
<li>
<p>00 01 表示附加属性数量</p>
</li>
<li>
<p>00 13 表示引用了常量池 #19 项，即<code>SourceFile</code></p>
</li>
<li>
<p>00 00 00 02 表示此属性的长度</p>
</li>
<li>
<p>00 14 表示引用了常量池 #20 项，即</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">HelloWorld</span>.</span></span>java</span><br></pre></td></tr></table></figure>
<ul>
<li>0001100 00 12 00 00 00 05 01 00 10 00 00 <code>00 01 00 13 00</code></li>
<li>0001120 <code>00 00 02 00 14</code>分</li>
</ul>
</li>
</ul>
<h1>字节码指令</h1>
<h2 id="入门">入门</h2>
<ul>
<li>
<p>在上一小节，有两个字节码指令，我们没有细说，那现在就来具体看看</p>
</li>
<li>
<p>一个是</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="literal">cn</span>.itcast.jvm.t5.HelloWorld();</span><br></pre></td></tr></table></figure>
<p>构造方法的字节码指令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute">2a</span> b7 <span class="number">00</span> <span class="number">01</span> b1</span><br></pre></td></tr></table></figure>
<ol>
<li>2a =&gt; aload_0 加载 slot 0 的局部变量，即 this，做为下面的 invokespecial 构造方法调用的参数</li>
<li>b7 =&gt; invokespecial 预备调用构造方法，哪个方法呢？</li>
<li>00 01 引用常量池中 #1 项，即<code>Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</code></li>
<li>b1 表示返回</li>
</ol>
</li>
<li>
<p>另一个是</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(java.lang.<span class="type">String</span>[])</span></span>;</span><br></pre></td></tr></table></figure>
<p>主方法的字节码指令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute">b2</span> <span class="number">00</span> <span class="number">02</span> <span class="number">12</span> <span class="number">03</span> b6 <span class="number">00</span> <span class="number">04</span> b1</span><br></pre></td></tr></table></figure>
<ol>
<li>b2 =&gt; getstatic 用来加载静态变量，哪个静态变量呢？</li>
<li>00 02 引用常量池中 #2 项，即<code>Field java/lang/System.out:Ljava/io/PrintStream;</code></li>
<li>12 =&gt; ldc 加载参数，哪个参数呢？</li>
<li>03 引用常量池中 #3 项，即 <code>String hello world</code></li>
<li>b6 =&gt; invokevirtual 预备调用成员方法，哪个方法呢？</li>
<li>00 04 引用常量池中 #4 项，即<code>Method java/io/PrintStream.println:(Ljava/lang/String;)V</code></li>
<li>b1 表示返回</li>
</ol>
</li>
<li>
<p>详情请参考官方文档：<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5">https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5</a></p>
</li>
</ul>
<h2 id="javap工具">javap工具</h2>
<ul>
<li>
<p>自己分析类文件结构太麻烦了，Oracle提供了javap工具来反编译class文件</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">$ javap <span class="params">-v</span> HelloWorld.class</span><br><span class="line">Classfile /D:/Workspace/JVM/demo/target/classes/com/demo/HelloWorld.class</span><br><span class="line">  Last modified <span class="number">2023</span><span class="number">-4</span><span class="number">-5</span>; size <span class="number">551</span> <span class="built_in">bytes</span></span><br><span class="line">  MD5 checksum <span class="number">1389</span>d939c65ba536eb81d1a5c61d99be</span><br><span class="line">  Compiled from <span class="string">&quot;HelloWorld.java&quot;</span>              </span><br><span class="line"><span class="keyword">public</span> class com.demo.HelloWorld               </span><br><span class="line">  minor version: <span class="number">0</span>                             </span><br><span class="line">  major version: <span class="number">52</span>                            </span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   #1 = Methodref          #6.#20         <span class="comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #2 = Fieldref           #21.#22        <span class="comment">// java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">   #3 = <span class="built_in">String</span>             #23            <span class="comment">// hello world</span></span><br><span class="line">   #4 = Methodref          #24.#25        <span class="comment">// java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">   #5 = Class              #26            <span class="comment">// com/demo/HelloWorld</span></span><br><span class="line">   #6 = Class              #27            <span class="comment">// java/lang/Object</span></span><br><span class="line">   #7 = Utf8               &lt;init&gt;</span><br><span class="line">   #8 = Utf8               ()V</span><br><span class="line">   #9 = Utf8               Code</span><br><span class="line">  #10 = Utf8               LineNumberTable</span><br><span class="line">  #11 = Utf8               LocalVariableTable</span><br><span class="line">  #12 = Utf8               this</span><br><span class="line">  #13 = Utf8               Lcom/demo/HelloWorld;</span><br><span class="line">  #14 = Utf8               main</span><br><span class="line">  #15 = Utf8               (<span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;)V</span><br><span class="line">  #16 = Utf8               args</span><br><span class="line">  #17 = Utf8               <span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;</span><br><span class="line">  #18 = Utf8               SourceFile</span><br><span class="line">  #19 = Utf8               HelloWorld.java</span><br><span class="line">  #20 = NameAndType        #7:#8          <span class="comment">// &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">  #21 = Class              #28            <span class="comment">// java/lang/System</span></span><br><span class="line">  #22 = NameAndType        #29:#30        <span class="comment">// out:Ljava/io/PrintStream;</span></span><br><span class="line">  #23 = Utf8               hello world</span><br><span class="line">  #24 = Class              #31            <span class="comment">// java/io/PrintStream</span></span><br><span class="line">  #25 = NameAndType        #32:#33        <span class="comment">// println:(Ljava/lang/String;)V</span></span><br><span class="line">  #26 = Utf8               com/demo/HelloWorld</span><br><span class="line">  #27 = Utf8               java/lang/Object</span><br><span class="line">  #28 = Utf8               java/lang/System</span><br><span class="line">  #29 = Utf8               out</span><br><span class="line">  #30 = Utf8               Ljava/io/PrintStream;</span><br><span class="line">  #31 = Utf8               java/io/PrintStream</span><br><span class="line">  #32 = Utf8               println</span><br><span class="line">  #33 = Utf8               (Ljava/lang/<span class="built_in">String</span>;)V</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> com.demo.HelloWorld();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      <span class="built_in">stack</span>=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #1                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">    Code:</span><br><span class="line">      <span class="built_in">stack</span>=<span class="number">2</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: getstatic     #2                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">         <span class="number">3</span>: ldc           #3                  <span class="comment">// String hello world</span></span><br><span class="line">         <span class="number">5</span>: invokevirtual #4                  <span class="comment">// Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">         <span class="number">8</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">5</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">6</span>: <span class="number">8</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">9</span>     <span class="number">0</span>  args   <span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;HelloWorld.java&quot;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="图解方法执行流程">图解方法执行流程</h2>
<ol>
<li>
<p>原始Java代码</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 演示 字节码指令 和 操作数栈、常量池的关系</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_20</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> b = Short.MAX_VALUE + <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> c = a + b;</span><br><span class="line">        System.out.<span class="built_in">println</span>(c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">$ javap <span class="params">-v</span> Demo_20.class</span><br><span class="line">Classfile /D:/Workspace/JVM/demo/target/classes/com/demo/Demo_20.class</span><br><span class="line">  Last modified <span class="number">2023</span><span class="number">-4</span><span class="number">-7</span>; size <span class="number">601</span> <span class="built_in">bytes</span>       </span><br><span class="line">  MD5 checksum <span class="number">0</span>f9e41fb2a7334a69c89d2661540f4f1</span><br><span class="line">  Compiled from <span class="string">&quot;Demo_20.java&quot;</span>                 </span><br><span class="line"><span class="keyword">public</span> class com.demo.Demo_20                  </span><br><span class="line">  minor version: <span class="number">0</span>                             </span><br><span class="line">  major version: <span class="number">52</span>                            </span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER                 </span><br><span class="line">Constant pool:                                 </span><br><span class="line">   #1 = Methodref          #7.#25         <span class="comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V             </span></span><br><span class="line">   #2 = Class              #26            <span class="comment">// java/lang/Short                           </span></span><br><span class="line">   #3 = <span class="built_in">Integer</span>            <span class="number">32768</span>                                                       </span><br><span class="line">   #4 = Fieldref           #27.#28        <span class="comment">// java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">   #5 = Methodref          #29.#30        <span class="comment">// java/io/PrintStream.println:(I)V</span></span><br><span class="line">   #6 = Class              #31            <span class="comment">// com/demo/Demo_20</span></span><br><span class="line">   #7 = Class              #32            <span class="comment">// java/lang/Object</span></span><br><span class="line">   #8 = Utf8               &lt;init&gt;</span><br><span class="line">   #9 = Utf8               ()V</span><br><span class="line">  #10 = Utf8               Code</span><br><span class="line">  #11 = Utf8               LineNumberTable</span><br><span class="line">  #12 = Utf8               LocalVariableTable</span><br><span class="line">  #13 = Utf8               this</span><br><span class="line">  #14 = Utf8               Lcom/demo/Demo_20;</span><br><span class="line">  #15 = Utf8               main</span><br><span class="line">  #16 = Utf8               (<span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;)V</span><br><span class="line">  #17 = Utf8               args</span><br><span class="line">  #18 = Utf8               <span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;</span><br><span class="line">  #19 = Utf8               a</span><br><span class="line">  #20 = Utf8               I</span><br><span class="line">  #21 = Utf8               b</span><br><span class="line">  #22 = Utf8               c</span><br><span class="line">  #23 = Utf8               SourceFile</span><br><span class="line">  #24 = Utf8               Demo_20.java</span><br><span class="line">  #25 = NameAndType        #8:#9          <span class="comment">// &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">  #26 = Utf8               java/lang/Short</span><br><span class="line">  #27 = Class              #33            <span class="comment">// java/lang/System</span></span><br><span class="line">  #28 = NameAndType        #34:#35        <span class="comment">// out:Ljava/io/PrintStream;</span></span><br><span class="line">  #29 = Class              #36            <span class="comment">// java/io/PrintStream</span></span><br><span class="line">  #30 = NameAndType        #37:#38        <span class="comment">// println:(I)V</span></span><br><span class="line">  #31 = Utf8               com/demo/Demo_20</span><br><span class="line">  #32 = Utf8               java/lang/Object</span><br><span class="line">  #33 = Utf8               java/lang/System</span><br><span class="line">  #34 = Utf8               out</span><br><span class="line">  #35 = Utf8               Ljava/io/PrintStream;</span><br><span class="line">  #36 = Utf8               java/io/PrintStream</span><br><span class="line">  #37 = Utf8               println</span><br><span class="line">  #38 = Utf8               (I)V</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> com.demo.Demo_20();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      <span class="built_in">stack</span>=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #1                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">6</span>: <span class="number">0</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  this   Lcom/demo/Demo_20;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> static <span class="literal">void</span> main(java.lang.<span class="built_in">String</span><span class="meta">[</span><span class="meta">]</span>);</span><br><span class="line">    descriptor: (<span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      <span class="built_in">stack</span>=<span class="number">2</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: bipush        <span class="number">10</span></span><br><span class="line">         <span class="number">2</span>: istore_1</span><br><span class="line">         <span class="number">3</span>: ldc           #3                  <span class="comment">// int 32768</span></span><br><span class="line">         <span class="number">5</span>: istore_2</span><br><span class="line">         <span class="number">6</span>: iload_1</span><br><span class="line">         <span class="number">7</span>: iload_2</span><br><span class="line">         <span class="number">8</span>: iadd</span><br><span class="line">         <span class="number">9</span>: istore_3</span><br><span class="line">        <span class="number">10</span>: getstatic     #4                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">        <span class="number">13</span>: iload_3</span><br><span class="line">        <span class="number">14</span>: invokevirtual #5                  <span class="comment">// Method java/io/PrintStream.println:(I)V</span></span><br><span class="line">        <span class="number">17</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">8</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">9</span>: <span class="number">3</span></span><br><span class="line">        line <span class="number">10</span>: <span class="number">6</span></span><br><span class="line">        line <span class="number">11</span>: <span class="number">10</span></span><br><span class="line">        line <span class="number">12</span>: <span class="number">17</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>      <span class="number">18</span>     <span class="number">0</span>  args   <span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;</span><br><span class="line">            <span class="number">3</span>      <span class="number">15</span>     <span class="number">1</span>     a   I</span><br><span class="line">            <span class="number">6</span>      <span class="number">12</span>     <span class="number">2</span>     b   I</span><br><span class="line">           <span class="number">10</span>       <span class="number">8</span>     <span class="number">3</span>     c   I</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;Demo_20.java&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>常量池载入运行时常量池<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTr326.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTr326.png" alt="img"></a></p>
</li>
<li>
<p>方法字节码载入方法区<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTrdIA.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTrdIA.png" alt="img"></a></p>
</li>
<li>
<p>main线程开始运行、分配栈帧内存</p>
<ul>
<li>stack=2, locals=4
<ul>
<li>操作数栈的深度为2，也就是说，在执行该方法时，最多可以将两个值压入栈中进行操作。</li>
<li>包含四个局部变量<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTrDRP.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTrDRP.png" alt="img"></a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>执行引擎开始执行字节码</p>
<ul>
<li>bipush 10
<ul>
<li>将一个byte压入操作数栈（其长度会补齐为4个字节），类似的指令还有</li>
<li>sipush：将一个short压入操作数栈（其长度会补齐为4个字节）</li>
<li>ldc：将一个int压入操作数栈</li>
<li>ldc2_w：将一个long压入操作数栈（分两次压入，因为long占8个字节）<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTr2ZQ.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTr2ZQ.png" alt="img"></a></li>
</ul>
</li>
<li>istore_1
<ul>
<li>将操作数栈顶数据弹出，存入局部变量表slot 1<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppT6Rde.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppT6Rde.png" alt="img"></a></li>
</ul>
</li>
<li>ldc #3
<ul>
<li>从常量池加载#3数据到操作数栈<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppT6OoQ.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppT6OoQ.png" alt="img"></a></li>
</ul>
</li>
<li>istore_2
<ul>
<li>将操作数栈顶数据弹出，存入局部变量表slot 2<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTc9yV.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTc9yV.png" alt="img"></a></li>
</ul>
</li>
<li>iload_1
<ul>
<li>将局部变量表slot 1的值加载到操作数栈中</li>
</ul>
</li>
<li>iload_2
<ul>
<li>将局部变量表slot 2的值加载到操作数栈中<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTcsYj.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTcsYj.png" alt="img"></a></li>
</ul>
</li>
<li>iadd
<ul>
<li>从操作数栈顶部弹出两个int类型的数值，将这两个数值相加，并将其结果压入操作数栈顶部；<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTcTh9.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTcTh9.png" alt="img"></a></li>
</ul>
</li>
<li>istore_3
<ul>
<li>将操作数栈顶部数据弹出，存入局部变量表slot 3<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTcXnK.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTcXnK.png" alt="img"></a></li>
</ul>
</li>
<li>getstatic #4
<ul>
<li>从常量池加载#4静态字段到操作数栈<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTgEB8.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTgEB8.png" alt="img"></a></li>
</ul>
</li>
<li>iload_3
<ul>
<li>将局部变量表slot 3的值加载到操作数栈中<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTgnhj.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTgnhj.png" alt="img"></a></li>
</ul>
</li>
<li>invokevirtual #5
<ul>
<li>找到常量池#5项</li>
<li>定位到方法区</li>
<li>生成新的栈帧（分配locals、stack等）</li>
<li>传递参数、执行新栈帧中的字节码<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTgM3n.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTgM3n.png" alt="img"></a></li>
<li>执行完毕，弹出栈帧</li>
<li>清除main操作数栈内容<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/07/ppTglj0.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/07/ppTglj0.png" alt="img"></a></li>
</ul>
</li>
<li>return
<ul>
<li>完成main方法调用，弹出main栈帧</li>
<li>程序结束</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="分析-i">分析 i++</h2>
<ul>
<li>
<p>目的：从字节码角度分析a++相关题目</p>
</li>
<li>
<p>原始Java代码</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Demo_21 &#123;</span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) &#123;</span><br><span class="line">        <span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> b = a++ + ++a + a<span class="comment">--;</span></span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println(a);</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println(b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">$ javap <span class="params">-v</span> Demo_21.class</span><br><span class="line">Classfile /D:/Workspace/JVM/demo/target/classes/com/demo/Demo_21.class</span><br><span class="line">  Last modified <span class="number">2023</span><span class="number">-4</span><span class="number">-7</span>; size <span class="number">576</span> <span class="built_in">bytes</span></span><br><span class="line">  MD5 checksum <span class="number">5</span>bc962752b10ca4b57350ca9814ec5b0</span><br><span class="line">  Compiled from <span class="string">&quot;Demo_21.java&quot;</span></span><br><span class="line"><span class="keyword">public</span> class com.demo.Demo_21</span><br><span class="line">  minor version: <span class="number">0</span></span><br><span class="line">  major version: <span class="number">52</span></span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   #1 = Methodref          #5.#22         <span class="comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #2 = Fieldref           #23.#24        <span class="comment">// java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">   #3 = Methodref          #25.#26        <span class="comment">// java/io/PrintStream.println:(I)V</span></span><br><span class="line">   #4 = Class              #27            <span class="comment">// com/demo/Demo_21</span></span><br><span class="line">   #5 = Class              #28            <span class="comment">// java/lang/Object</span></span><br><span class="line">   #6 = Utf8               &lt;init&gt;</span><br><span class="line">   #7 = Utf8               ()V</span><br><span class="line">   #8 = Utf8               Code</span><br><span class="line">   #9 = Utf8               LineNumberTable</span><br><span class="line">  #10 = Utf8               LocalVariableTable</span><br><span class="line">  #11 = Utf8               this</span><br><span class="line">  #12 = Utf8               Lcom/demo/Demo_21;</span><br><span class="line">  #13 = Utf8               main</span><br><span class="line">  #14 = Utf8               (<span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;)V</span><br><span class="line">  #15 = Utf8               args</span><br><span class="line">  #16 = Utf8               <span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;</span><br><span class="line">  #17 = Utf8               a</span><br><span class="line">  #18 = Utf8               I</span><br><span class="line">  #19 = Utf8               b</span><br><span class="line">  #20 = Utf8               SourceFile</span><br><span class="line">  #21 = Utf8               Demo_21.java</span><br><span class="line">  #22 = NameAndType        #6:#7          <span class="comment">// &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">  #23 = Class              #29            <span class="comment">// java/lang/System</span></span><br><span class="line">  #24 = NameAndType        #30:#31        <span class="comment">// out:Ljava/io/PrintStream;</span></span><br><span class="line">  #25 = Class              #32            <span class="comment">// java/io/PrintStream</span></span><br><span class="line">  #26 = NameAndType        #33:#34        <span class="comment">// println:(I)V</span></span><br><span class="line">  #27 = Utf8               com/demo/Demo_21</span><br><span class="line">  #28 = Utf8               java/lang/Object</span><br><span class="line">  #29 = Utf8               java/lang/System</span><br><span class="line">  #30 = Utf8               out</span><br><span class="line">  #31 = Utf8               Ljava/io/PrintStream;</span><br><span class="line">  #32 = Utf8               java/io/PrintStream</span><br><span class="line">  #33 = Utf8               println</span><br><span class="line">  #34 = Utf8               (I)V</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> com.demo.Demo_21();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      <span class="built_in">stack</span>=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #1                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">3</span>: <span class="number">0</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  this   Lcom/demo/Demo_21;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> static <span class="literal">void</span> main(java.lang.<span class="built_in">String</span><span class="meta">[</span><span class="meta">]</span>);</span><br><span class="line">    descriptor: (<span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      <span class="built_in">stack</span>=<span class="number">2</span>, locals=<span class="number">3</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: bipush        <span class="number">10</span></span><br><span class="line">         <span class="number">2</span>: istore_1</span><br><span class="line">         <span class="number">3</span>: iload_1</span><br><span class="line">         <span class="number">4</span>: iinc          <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">         <span class="number">7</span>: iinc          <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">        <span class="number">10</span>: iload_1</span><br><span class="line">        <span class="number">11</span>: iadd</span><br><span class="line">        <span class="number">12</span>: iload_1</span><br><span class="line">        <span class="number">13</span>: iinc          <span class="number">1</span>, <span class="number">-1</span></span><br><span class="line">        <span class="number">16</span>: iadd</span><br><span class="line">        <span class="number">17</span>: istore_2</span><br><span class="line">        <span class="number">18</span>: getstatic     #2                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">        <span class="number">21</span>: iload_1</span><br><span class="line">        <span class="number">22</span>: invokevirtual #3                  <span class="comment">// Method java/io/PrintStream.println:(I)V</span></span><br><span class="line">        <span class="number">25</span>: getstatic     #2                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">        <span class="number">28</span>: iload_2</span><br><span class="line">        <span class="number">29</span>: invokevirtual #3                  <span class="comment">// Method java/io/PrintStream.println:(I)V</span></span><br><span class="line">        <span class="number">32</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">5</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">6</span>: <span class="number">3</span></span><br><span class="line">        line <span class="number">7</span>: <span class="number">18</span></span><br><span class="line">        line <span class="number">8</span>: <span class="number">25</span></span><br><span class="line">        line <span class="number">9</span>: <span class="number">32</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>      <span class="number">33</span>     <span class="number">0</span>  args   <span class="meta">[</span>Ljava/lang/<span class="built_in">String</span>;</span><br><span class="line">            <span class="number">3</span>      <span class="number">30</span>     <span class="number">1</span>     a   I</span><br><span class="line">           <span class="number">18</span>      <span class="number">15</span>     <span class="number">2</span>     b   I</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;Demo_21.java&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>提示：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">iinc</span></span><br></pre></td></tr></table></figure>
<p>指令是直接在局部变量slot上进行运算，下面逐行分析字节码指令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"> <span class="attribute">0</span>: bipush        <span class="number">10</span>        // 将一个byte压入操作数栈，此时就是将<span class="number">10</span>压入操作数栈</span><br><span class="line"> <span class="attribute">2</span>: istore_1                // 将操作数栈顶部数据弹出，存入局部变量表 slot <span class="number">1</span></span><br><span class="line"> <span class="attribute">3</span>: iload_1                 // 将局部变量表slot <span class="number">1</span>的值加载到操作数栈中，也就是将<span class="number">10</span>加载到栈中</span><br><span class="line"> <span class="attribute">4</span>: iinc          <span class="number">1</span>, <span class="number">1</span>      // 在当前局部变量上进行运算，自增<span class="number">1</span>，此时局部变量 a = <span class="number">11</span>   至此 a++ 执行完毕</span><br><span class="line"> <span class="attribute">7</span>: iinc          <span class="number">1</span>, <span class="number">1</span>      // 在当前局部变量上进行运算，自增<span class="number">1</span>，此时局部变量 a = <span class="number">12</span></span><br><span class="line"><span class="attribute">10</span>: iload_1                 // 将局部变量表slot <span class="number">1</span>的值加载到操作数栈中，也就是将<span class="number">12</span>加载到栈中</span><br><span class="line"><span class="attribute">11</span>: iadd                    // 将栈内两个元素相加，<span class="number">10</span> + <span class="number">12</span> = <span class="number">22</span>，将结果<span class="number">22</span>加载到栈中</span><br><span class="line"><span class="attribute">12</span>: iload_1                 // 将局部变量表slot <span class="number">1</span>的值加载到操作数栈中，也就是将<span class="number">12</span>加载到栈中</span><br><span class="line"><span class="attribute">13</span>: iinc          <span class="number">1</span>, -<span class="number">1</span>     // 在当前局部变量上进行运算，自减<span class="number">1</span>，此时局部变量 a = <span class="number">11</span></span><br><span class="line"><span class="attribute">16</span>: iadd                    // 将栈内两个元素相加，<span class="number">22</span> + <span class="number">12</span> = <span class="number">34</span>，结果为<span class="number">34</span></span><br><span class="line"><span class="attribute">17</span>: istore_2                // 将操作数栈顶部数据弹出，存入局部变量表slot <span class="number">2</span></span><br><span class="line"><span class="attribute">18</span>: getstatic     #<span class="number">2</span>        // 下面就不分析了，就是输出a和b的值</span><br><span class="line"><span class="attribute">21</span>: iload_1</span><br><span class="line"><span class="attribute">22</span>: invokevirtual #<span class="number">3</span>                  </span><br><span class="line"><span class="attribute">25</span>: getstatic     #<span class="number">2</span>                  </span><br><span class="line"><span class="attribute">28</span>: iload_2</span><br><span class="line"><span class="attribute">29</span>: invokevirtual #<span class="number">3</span>                  </span><br><span class="line"><span class="attribute">32</span>: return</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>那么最终的结果<code>a = 11</code>，<code>b = 34</code></p>
</li>
<li>
<p>从字节码指令中，我们可以看出，</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">a</span><span class="literal">++</span></span><br></pre></td></tr></table></figure>
<p>和</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">++</span><span class="comment">a</span></span><br></pre></td></tr></table></figure>
<p>的区别为</p>
<ul>
<li><code>a++</code>是先执行<code>iload</code>，再执行<code>iinc</code></li>
<li><code>++a</code>是先执行<code>iinc</code>，再执行<code>iload</code></li>
</ul>
</li>
</ul>
<h2 id="条件判断指令">条件判断指令</h2>
<table>
<thead>
<tr>
<th style="text-align:center">指令</th>
<th style="text-align:center">助记符</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x99</td>
<td style="text-align:center">ifeq</td>
<td style="text-align:center">判断是否 == 0</td>
</tr>
<tr>
<td style="text-align:center">0x9a</td>
<td style="text-align:center">ifne</td>
<td style="text-align:center">判断是否 != 0</td>
</tr>
<tr>
<td style="text-align:center">0x9b</td>
<td style="text-align:center">iflt</td>
<td style="text-align:center">判断是否 &lt; 0</td>
</tr>
<tr>
<td style="text-align:center">0x9c</td>
<td style="text-align:center">ifge</td>
<td style="text-align:center">判断是否 &gt;= 0</td>
</tr>
<tr>
<td style="text-align:center">0x9d</td>
<td style="text-align:center">ifgt</td>
<td style="text-align:center">判断是否 &gt; 0</td>
</tr>
<tr>
<td style="text-align:center">0x9e</td>
<td style="text-align:center">ifle</td>
<td style="text-align:center">判断是否 &lt;= 0</td>
</tr>
<tr>
<td style="text-align:center">0x9f</td>
<td style="text-align:center">if_icmpeq</td>
<td style="text-align:center">两个int是否 ==</td>
</tr>
<tr>
<td style="text-align:center">0xa0</td>
<td style="text-align:center">if_icmpne</td>
<td style="text-align:center">两个int是否 !=</td>
</tr>
<tr>
<td style="text-align:center">0xa1</td>
<td style="text-align:center">if_icmplt</td>
<td style="text-align:center">两个int是否 &lt;</td>
</tr>
<tr>
<td style="text-align:center">0xa2</td>
<td style="text-align:center">if_icmpge</td>
<td style="text-align:center">两个int是否 &gt;=</td>
</tr>
<tr>
<td style="text-align:center">0xa3</td>
<td style="text-align:center">if_icmpgt</td>
<td style="text-align:center">两个int是否 &gt;</td>
</tr>
<tr>
<td style="text-align:center">0xa4</td>
<td style="text-align:center">if_icmple</td>
<td style="text-align:center">两个int是否 &lt;=</td>
</tr>
<tr>
<td style="text-align:center">0xa5</td>
<td style="text-align:center">if_acmpeq</td>
<td style="text-align:center">两个引用是否 ==</td>
</tr>
<tr>
<td style="text-align:center">0xa6</td>
<td style="text-align:center">if_acmpne</td>
<td style="text-align:center">两个引用是否 !=</td>
</tr>
<tr>
<td style="text-align:center">0xc6</td>
<td style="text-align:center">ifnull</td>
<td style="text-align:center">判断是否 == null</td>
</tr>
<tr>
<td style="text-align:center">0xc7</td>
<td style="text-align:center">ifnonnull</td>
<td style="text-align:center">判断是否 != null</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_22</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (a == <span class="number">0</span>) &#123;</span><br><span class="line">            a = <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            a = <span class="number">20</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line"> <span class="number">0</span>: iconst_0             <span class="regexp">//</span> 将整数常量值<span class="number">0</span>（int类型）压入操作数栈中。</span><br><span class="line"> <span class="number">1</span>: istore_1             <span class="regexp">//</span> 将栈顶数据存入局部变量表 slot <span class="number">1</span></span><br><span class="line"> <span class="number">2</span>: iload_1              <span class="regexp">//</span> 将局部变量表slot <span class="number">1</span>的值压入操作数栈</span><br><span class="line"> <span class="number">3</span>: ifne           <span class="number">12</span>    <span class="regexp">//</span> 判断不等于<span class="number">0</span>，成立跳转至<span class="number">12</span>行，不成立则执行下一行</span><br><span class="line"> <span class="number">6</span>: bipush         <span class="number">10</span>    <span class="regexp">//</span> 将<span class="number">10</span>压入操作数栈</span><br><span class="line"> <span class="number">8</span>: istore_1             <span class="regexp">//</span> 将栈顶数据存入局部变量表 slot <span class="number">1</span></span><br><span class="line"> <span class="number">9</span>: goto           <span class="number">15</span>    <span class="regexp">//</span> 跳转至第<span class="number">15</span>行</span><br><span class="line"><span class="number">12</span>: bipush        <span class="number">20</span>     <span class="regexp">//</span> 将<span class="number">20</span>压入操作数栈，对应 a = <span class="number">20</span></span><br><span class="line"><span class="number">14</span>: istore_1             <span class="regexp">//</span> 将栈顶数据存入局部变量表 slot <span class="number">1</span></span><br><span class="line"><span class="number">15</span>: return</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="循环控制指令">循环控制指令</h2>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_23</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (a &lt; <span class="number">10</span>) &#123;</span><br><span class="line">            a++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line"> <span class="number">0</span>: iconst_0                <span class="regexp">//</span> 将整数常量值<span class="number">0</span>（int类型）压入操作数栈中。</span><br><span class="line"> <span class="number">1</span>: istore_1                <span class="regexp">//</span> 将栈顶数据存入局部变量表 slot <span class="number">1</span></span><br><span class="line"> <span class="number">2</span>: iload_1                 <span class="regexp">//</span> 将局部变量表slot <span class="number">1</span>的值压入操作数栈</span><br><span class="line"> <span class="number">3</span>: bipush        <span class="number">10</span>        <span class="regexp">//</span> 将<span class="number">10</span>压入操作数栈</span><br><span class="line"> <span class="number">5</span>: if_icmpge     <span class="number">14</span>        <span class="regexp">//</span> 判断 i &gt;= <span class="number">10</span> ，成立则跳转到<span class="number">14</span>行，不成立则执行下一行</span><br><span class="line"> <span class="number">8</span>: iinc          <span class="number">1</span>, <span class="number">1</span>      <span class="regexp">//</span> i自增</span><br><span class="line"><span class="number">11</span>: goto          <span class="number">2</span>         <span class="regexp">//</span> 跳转到第<span class="number">2</span>行</span><br><span class="line"><span class="number">14</span>: return</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>再比如</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> <span class="keyword">while</span></span><br></pre></td></tr></table></figure>
<p>循环</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_24</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125; <span class="keyword">while</span> (i &lt; <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line"> <span class="number">0</span>: iconst_0                <span class="regexp">//</span> 将整数常量值<span class="number">0</span>（int类型）压入操作数栈中。</span><br><span class="line"> <span class="number">1</span>: istore_1                <span class="regexp">//</span> 将栈顶数据存入局部变量表 slot <span class="number">1</span></span><br><span class="line"> <span class="number">2</span>: iinc          <span class="number">1</span>, <span class="number">1</span>      <span class="regexp">//</span> i自增</span><br><span class="line"> <span class="number">5</span>: iload_1                 <span class="regexp">//</span> 将局部变量表slot <span class="number">1</span>加载到操作数栈</span><br><span class="line"> <span class="number">6</span>: bipush        <span class="number">10</span>        <span class="regexp">//</span> 将<span class="number">10</span>加载到操作数栈</span><br><span class="line"> <span class="number">8</span>: if_icmplt     <span class="number">2</span>         <span class="regexp">//</span> 判断 i &lt; <span class="number">10</span>，成立则跳转到第<span class="number">2</span>行，不成立执行下一行</span><br><span class="line"><span class="number">11</span>: return</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>最后再来看看for循环</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_25</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute"> 0</span><span class="punctuation">:</span> <span class="string">iconst_0</span></span><br><span class="line"> <span class="attribute">1</span><span class="punctuation">:</span> <span class="string">istore_1</span></span><br><span class="line"> <span class="attribute">2</span><span class="punctuation">:</span> <span class="string">iload_1</span></span><br><span class="line"> <span class="attribute">3</span><span class="punctuation">:</span> <span class="string">bipush        10</span></span><br><span class="line"> <span class="attribute">5</span><span class="punctuation">:</span> <span class="string">if_icmpge     14</span></span><br><span class="line"> <span class="attribute">8</span><span class="punctuation">:</span> <span class="string">iinc          1, 1</span></span><br><span class="line"><span class="attribute">11</span><span class="punctuation">:</span> <span class="string">goto          2</span></span><br><span class="line"><span class="attribute">14</span><span class="punctuation">:</span> <span class="string">return</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>注意到while和for的字节码，它们是一模一样的，这就是所谓的<code>殊途同归</code>吧</p>
<h2 id="判断结果">判断结果</h2>
<ul>
<li>
<p>从字节码的角度来分析下面程序的运行结果</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_26</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; <span class="number">10</span>) &#123;</span><br><span class="line">            x = x++;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.<span class="built_in">println</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>最终x的结果是0</p>
<ul>
<li>执行<code>x++</code>时，先执行<code>iload_x</code>，将0加载到操作数栈中</li>
<li>然后执行iinc，将局部变量表中的x自增，此时局部变量表中的<code>x = 1</code></li>
<li>此时又执行了一个赋值操作，<code>istore_x</code>，将操作数栈中的0，重新赋给了局部变量表中的x，导致x为0</li>
</ul>
</li>
<li>
<p>下面是对应的字节码</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line"><span class="attribute">10</span>: iload_2</span><br><span class="line"><span class="attribute">11</span>: iinc          2, 1</span><br><span class="line"><span class="attribute">14</span>: istore_2</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="构造方法">构造方法</h2>
<ol>
<li>
<pre><code>&lt;cinit&gt;()V
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
public class Demo_27 &#123;
    static int i = 10;

    static &#123;
        i = 20;
    &#125;

    static &#123;
        i = 30;
    &#125;

    public static void main(String[] args) &#123;

    &#125;
&#125;
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>编译后的字节码文件</span><br><span class="line"></span><br></pre></td></tr></table></figure>
  PLAINTEXT
   0: bipush        10
   2: putstatic     #2                  // Field i:I
   5: bipush        20
   7: putstatic     #2                  // Field i:I
  10: bipush        30
  12: putstatic     #2                  // Field i:I
  15: return
  <figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   - 编译器会按照从上至下的顺序，收集所有的static静态代码块和静态成员赋值的代码，合并成一个特殊的方法`&lt;cinit&gt;()V`</span><br><span class="line"></span><br><span class="line">   - `&lt;cinit&gt;()V`方法会在类加载的初始化阶段被调用</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>. ```</span><br><span class="line">   &lt;init&gt;()V</span><br></pre></td></tr></table></figure>

<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_28</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> a = <span class="string">&quot;s1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        b = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> b = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        a = <span class="string">&quot;s2&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Demo_28</span><span class="params">(<span class="type">String</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.a = a;</span><br><span class="line">        <span class="keyword">this</span>.b = b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        Demo_28 demo = <span class="keyword">new</span> <span class="built_in">Demo_28</span>(<span class="string">&quot;s3&quot;</span>, <span class="number">30</span>);</span><br><span class="line">        System.out.<span class="built_in">println</span>(demo.a);</span><br><span class="line">        System.out.<span class="built_in">println</span>(demo.b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

- 编译后的字节码文件

  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">PLAINTEXT</span></span><br><span class="line"> <span class="attr">0:</span> <span class="string">aload_0</span></span><br><span class="line"> <span class="attr">1:</span> <span class="string">invokespecial</span> <span class="comment">#1      // super.&lt;init&gt;()V</span></span><br><span class="line"> <span class="attr">4:</span> <span class="string">aload_0</span></span><br><span class="line"> <span class="attr">5:</span> <span class="string">ldc</span> <span class="comment">#2                // &lt;- &quot;s1&quot;</span></span><br><span class="line"> <span class="attr">7:</span> <span class="string">putfield</span> <span class="comment">#3           // -&gt; this.a</span></span><br><span class="line"><span class="attr">10:</span> <span class="string">aload_0</span></span><br><span class="line"><span class="attr">11:</span> <span class="string">bipush</span> <span class="number">20</span>             <span class="string">//</span> <span class="string">&lt;-</span> <span class="number">20</span></span><br><span class="line"><span class="attr">13:</span> <span class="string">putfield</span> <span class="comment">#4           // -&gt; this.b</span></span><br><span class="line"><span class="attr">16:</span> <span class="string">aload_0</span></span><br><span class="line"><span class="attr">17:</span> <span class="string">bipush</span> <span class="number">10</span>             <span class="string">//</span> <span class="string">&lt;-</span> <span class="number">10</span></span><br><span class="line"><span class="attr">19:</span> <span class="string">putfield</span> <span class="comment">#4           // -&gt; this.b</span></span><br><span class="line"><span class="attr">22:</span> <span class="string">aload_0</span></span><br><span class="line"><span class="attr">23:</span> <span class="string">ldc</span> <span class="comment">#5                // &lt;- &quot;s2&quot;</span></span><br><span class="line"><span class="attr">25:</span> <span class="string">putfield</span> <span class="comment">#3           // -&gt; this.a</span></span><br><span class="line"><span class="attr">28:</span> <span class="string">aload_0</span>               <span class="string">//</span> <span class="string">------------------------------</span></span><br><span class="line"><span class="attr">29:</span> <span class="string">aload_1</span>               <span class="string">//</span> <span class="string">&lt;-</span> <span class="string">slot</span> <span class="number">1</span><span class="string">(a)</span> <span class="string">&quot;s3&quot;</span>            <span class="string">|</span></span><br><span class="line"><span class="attr">30:</span> <span class="string">putfield</span> <span class="comment">#3           // -&gt; this.a                    |</span></span><br><span class="line"><span class="attr">33:</span> <span class="string">aload_0</span>                                               <span class="string">|</span></span><br><span class="line"><span class="attr">34:</span> <span class="string">iload_2</span>               <span class="string">//</span> <span class="string">&lt;-</span> <span class="string">slot</span> <span class="number">2</span><span class="string">(b)</span> <span class="number">30</span>              <span class="string">|</span></span><br><span class="line"><span class="attr">35:</span> <span class="string">putfield</span> <span class="comment">#4           // -&gt; this.b --------------------</span></span><br><span class="line"><span class="attr">38:</span> <span class="string">return</span></span><br></pre></td></tr></table></figure>

- 编译器会按照从上至下的顺序，收集所有代码块和所有成员变量赋值的代码，形成新的构造方法，但原始构造方法内的代码总是会在最后

</code></pre>
</li>
</ol>
<h2 id="方法调用">方法调用</h2>
<ul>
<li>
<p>看一下几种不同方法调用对应的字节码指令，私有方法，final方法，公共方法，静态方法</p>
<ul>
<li>
<p>其中静态方法包括对象调静态方法和类直接调静态方法</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Demo_29</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Demo_29</span>()</span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">test1</span>()</span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> final <span class="keyword">void</span> <span class="title">test2</span>()</span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span>()</span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test4</span>()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span> &#123;</span><br><span class="line">        Demo_29 demo = <span class="keyword">new</span> Demo_29();</span><br><span class="line">        demo.test1();</span><br><span class="line">        demo.test2();</span><br><span class="line">        demo.test3();</span><br><span class="line">        demo.test4();</span><br><span class="line">        Demo_29.test4();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">PLAINTEXT</span></span><br><span class="line"> <span class="attr">0:</span> <span class="string">new</span>           <span class="comment">#2                  // class com/demo/Demo_29</span></span><br><span class="line"> <span class="attr">3:</span> <span class="string">dup</span></span><br><span class="line"> <span class="attr">4:</span> <span class="string">invokespecial</span> <span class="comment">#3                  // Method &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line"> <span class="attr">7:</span> <span class="string">astore_1</span></span><br><span class="line"> <span class="attr">8:</span> <span class="string">aload_1</span></span><br><span class="line"> <span class="attr">9:</span> <span class="string">invokespecial</span> <span class="comment">#4                  // Method test1:()V</span></span><br><span class="line"><span class="attr">12:</span> <span class="string">aload_1</span></span><br><span class="line"><span class="attr">13:</span> <span class="string">invokespecial</span> <span class="comment">#5                  // Method test2:()V</span></span><br><span class="line"><span class="attr">16:</span> <span class="string">aload_1</span></span><br><span class="line"><span class="attr">17:</span> <span class="string">invokevirtual</span> <span class="comment">#6                  // Method test3:()V</span></span><br><span class="line"><span class="attr">20:</span> <span class="string">aload_1</span></span><br><span class="line"><span class="attr">21:</span> <span class="string">pop</span></span><br><span class="line"><span class="attr">22:</span> <span class="string">invokestatic</span>  <span class="comment">#7                  // Method test4:()V</span></span><br><span class="line"><span class="attr">25:</span> <span class="string">invokestatic</span>  <span class="comment">#7                  // Method test4:()V</span></span><br><span class="line"><span class="attr">28:</span> <span class="string">return</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>new #2是创建Demo_29对象，给对象分配内存，执行成功会将<code>对象引用</code>压入操作数栈</p>
</li>
<li>
<p>dup是赋值操作数栈顶的内容，本例为</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对象引用</span><br></pre></td></tr></table></figure>
<p>。那为什么需要两份引用呢？</p>
<ul>
<li>一个是要配合<code>invokespecial</code>调用该对象的构造方法<code>&quot;&lt;init&gt;:()V&quot;</code>，会消耗掉栈顶一个引用</li>
<li>另一个要配合<code>astore_1</code>赋值给局部变量</li>
</ul>
</li>
<li>
<p>final方法、私有方法、构造方法，都是由invokespecial指令来调用，属于静态绑定</p>
</li>
<li>
<p>普通成员方法是由invokevirtual调用，属于动态绑定，即支持多态</p>
</li>
<li>
<p>成员方法与静态方法调用的另一个区别是，执行方法前是否需要<code>对象引用</code></p>
</li>
<li>
<p>比较有意思的是，执行demo.test4()时，是通过</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对象引用</span><br></pre></td></tr></table></figure>
<p>调用的静态方法，可以看到在调用前执行了pop指令，把对象引用从操作数栈弹掉了，因为静态方法不需要对象引用来掉，通过这种方式，反而会增加两步无用的字节码指令</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line"><span class="attribute">20</span>: aload_1</span><br><span class="line"><span class="attribute">21</span>: pop</span><br><span class="line"><span class="attribute">22</span>: invokestatic  <span class="comment">#7                  // Method test4:()V</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="多态的原理">多态的原理</h2>
<ul>
<li>
<p>原始Java代码</p>
<ul>
<li>
<p>定义了一个抽象类Animal，还有其两个子类Cat和Dog</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加VM参数：-XX:-UseCompressedOops -XX:-UseCompressedClassPointers</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_30</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(Animal animal)</span> &#123;</span><br><span class="line">        animal.eat();</span><br><span class="line">        System.out.println(animal);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        test(<span class="keyword">new</span> <span class="title class_">Cat</span>());</span><br><span class="line">        test(<span class="keyword">new</span> <span class="title class_">Dog</span>());</span><br><span class="line">        System.in.read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;我是&quot;</span> + <span class="built_in">this</span>.getClass().getSimpleName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;想啃大骨头&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;想吃小鱼干&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ol>
<li>
<p>运行代码</p>
<ul>
<li>会停在System.in.read()方法上（当然你也可以直接打断点），运行jps命令获取进程id</li>
</ul>
</li>
<li>
<p>运行HSDB工具</p>
<ul>
<li>
<p>进入JDK安装目录，执行</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">java -cp ./lib/sa-jdi<span class="selector-class">.jar</span> sun<span class="selector-class">.jvm</span><span class="selector-class">.hotspot</span>.HSDB</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>进入图形界面attach进程id</p>
</li>
</ul>
</li>
<li>
<p>查找某个对象</p>
<ul>
<li>
<p>打开Tools -&gt; Find Object By Query，输入命令，点击Execute执行</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line"><span class="keyword">select</span> d <span class="keyword">from</span> com.demo.Dog d</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/08/pp7s72q.png" alt="img"></p>
</li>
</ul>
</li>
<li>
<p>查看对象内存结构</p>
<ul>
<li>点击超链接可以看到对象的内存结构，此对象没有任何属性，因此只有对象头的16字节，前8字节是MarkWord，后8字节就是对象的Class指针，但现在看不到它的实际地址</li>
</ul>
</li>
<li>
<p>查看对象Class的内存地址</p>
<ul>
<li>
<p>可以通过Windows -&gt; Console进入命令行模式，执行如下命令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">BASH</span></span><br><span class="line"><span class="attribute">mem</span> <span class="number">0</span>x000001f1676e77c8 <span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>mem指令有两个参数，参数1是对象地址，参数2是查看2行（即16字节）</p>
</li>
<li>
<p>结果中第二行<code>0x000001f1f48841a0</code>即为Class的内存地址<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/08/pp7yJoQ.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/08/pp7yJoQ.png" alt="img"></a></p>
</li>
</ul>
</li>
<li>
<p>查看类的vtable</p>
<ul>
<li>
<p>方法1：ALT + R进入Inspector工具输入刚才的Class内存地址</p>
</li>
<li>
<p>方法2：或者Tools -&gt; Class Browser 输入Dog查找，可以得到相同的结果<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/08/pp7ycFJ.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/08/pp7ycFJ.png" alt="img"></a></p>
</li>
<li>
<p>无论通过哪种方法，都可以找到Dog Class的vtable长度为6，意思就是Dog类会有6个虚方法（多台相关的，final、static不会列入）</p>
</li>
<li>
<p>那么这6个虚方法都是谁呢？从Class的起始地址开始算，偏移</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x1b8</span></span><br></pre></td></tr></table></figure>
<p>就是vtable的其实地址，进行计算得到</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">0x000001f1f48841a0</span><br><span class="line"><span class="section">               1b8 +</span></span><br><span class="line"><span class="section">--------------------</span></span><br><span class="line">0x000001f1f4884358</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>通过Windows -&gt; Console进入命令行模式，执行如下命令，就得到了6个虚方法的入口地址</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">mem <span class="number">0</span>x000001f<span class="number">1f4884358</span> <span class="number">6</span></span><br><span class="line"><span class="number">0</span>x000001f<span class="number">1f4884358</span>: <span class="number">0</span>x000001f<span class="number">1f4481b10</span> </span><br><span class="line"><span class="number">0</span>x000001f<span class="number">1f4884360</span>: <span class="number">0</span>x000001f<span class="number">1f44815e8</span> </span><br><span class="line"><span class="number">0</span>x000001f<span class="number">1f4884368</span>: <span class="number">0</span>x000001f<span class="number">1f4883750</span> </span><br><span class="line"><span class="number">0</span>x000001f<span class="number">1f4884370</span>: <span class="number">0</span>x000001f<span class="number">1f4481540</span> </span><br><span class="line"><span class="number">0</span>x000001f<span class="number">1f4884378</span>: <span class="number">0</span>x000001f<span class="number">1f4481678</span> </span><br><span class="line"><span class="number">0</span>x000001f<span class="number">1f4884380</span>: <span class="number">0</span>x000001f<span class="number">1f4884148</span> </span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>验证方法地址</p>
<ul>
<li>
<p>通过Tools -&gt; Class Browser 查看每个类的方法定义，比较可知</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line"><span class="number">0x000001f1f4481b10</span> -&gt; Object -- <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span>() @0x000001f1f4481b10</span>;</span><br><span class="line"><span class="number">0x000001f1f44815e8</span> -&gt; Object -- <span class="function"><span class="keyword">public</span> boolean <span class="title">equals</span>(<span class="params">java.lang.Object</span>) @0x000001f1f44815e8</span>;</span><br><span class="line"><span class="number">0x000001f1f4883750</span> -&gt; Animal -- <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">toString</span>() @0x000001f1f4883750</span>;</span><br><span class="line"><span class="number">0x000001f1f4481540</span> -&gt; Object -- <span class="function"><span class="keyword">public</span> native <span class="built_in">int</span> <span class="title">hashCode</span>() @0x000001f1f4481540</span>;</span><br><span class="line"><span class="number">0x000001f1f4481678</span> -&gt; Object -- <span class="keyword">protected</span> native java.lang.<span class="function">Object <span class="title">clone</span>() @0x000001f1f4481678</span>;</span><br><span class="line"><span class="number">0x000001f1f4884148</span> -&gt; Dog -- <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span>() @0x000001f1f4884148</span>;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>对号入座，发现</p>
<ul>
<li>eat()方法是Dog类自己的</li>
<li>toString()方法是继承String类的</li>
<li>finalize() ，equals()，hashCode()，clone() 都是继承 Object 类的</li>
</ul>
</li>
</ul>
</li>
<li>
<p>小结</p>
<ul>
<li>当执行invokevirtual指令时
<ol>
<li>先通过栈帧中的对象引用找到对象</li>
<li>分析对象头，找到对象的实际Class</li>
<li>Class结构中有vtable，它在类加载的链接阶段就已经根据方法的重写规则生成号了</li>
<li>查表得到方法的具体地址</li>
<li>执行方法的字节码</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="异常处理">异常处理</h2>
<ol>
<li>
<p>try-catch</p>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_31</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        int i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            i = <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="title class_">Exception</span> e) &#123;</span><br><span class="line">            i = <span class="number">20</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JAVA</span></span><br><span class="line"><span class="attribute">public static void main(java.lang.String[]);</span></span><br><span class="line"><span class="attribute">descriptor</span><span class="punctuation">:</span> <span class="string">([Ljava/lang/String;)V</span></span><br><span class="line"><span class="attribute">flags</span><span class="punctuation">:</span> <span class="string">ACC_PUBLIC, ACC_STATIC</span></span><br><span class="line"><span class="attribute">Code</span><span class="punctuation">:</span></span><br><span class="line">    <span class="attribute">stack=1, locals=3, args_size=1</span></span><br><span class="line"><span class="attribute">    0</span><span class="punctuation">:</span> <span class="string">iconst_0</span></span><br><span class="line">    <span class="attribute">1</span><span class="punctuation">:</span> <span class="string">istore_1</span></span><br><span class="line">    <span class="attribute">2</span><span class="punctuation">:</span> <span class="string">bipush        10</span></span><br><span class="line">    <span class="attribute">4</span><span class="punctuation">:</span> <span class="string">istore_1</span></span><br><span class="line">    <span class="attribute">5</span><span class="punctuation">:</span> <span class="string">goto          12</span></span><br><span class="line">    <span class="attribute">8</span><span class="punctuation">:</span> <span class="string">astore_2</span></span><br><span class="line">    <span class="attribute">9</span><span class="punctuation">:</span> <span class="string">bipush        20</span></span><br><span class="line">    <span class="attribute">11</span><span class="punctuation">:</span> <span class="string">istore_1</span></span><br><span class="line">    <span class="attribute">12</span><span class="punctuation">:</span> <span class="string">return</span></span><br><span class="line">    <span class="attribute">Exception table</span><span class="punctuation">:</span></span><br><span class="line">    from    to  target type</span><br><span class="line">        2     5     8   Class java/lang/Exception</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>可以看到多出来一个<code>Exception table</code>的结构，<code>[from to)</code>是左闭右开的检测范围，一旦这个范围内的字节码执行出现异常，则通过<code>type</code>匹配异常类型，如果一致，进入<code>target</code>所指示的行号，该例中是第8行，也就是执行catch代码块</p>
</li>
<li>
<p>第8行的字节码指令<code>astore_2</code>是将异常对象存入局部变量表的<code>slot 2</code>的位置</p>
</li>
</ul>
</li>
<li>
<p>多个catch块的情况</p>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_32</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        int i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            i = <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="title class_">ArithmeticException</span> e) &#123;</span><br><span class="line">            i = <span class="number">20</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="title class_">NullPointerException</span> e) &#123;</span><br><span class="line">            i = <span class="number">30</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="title class_">Exception</span> e) &#123;</span><br><span class="line">            i = <span class="number">40</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JAVA</span></span><br><span class="line"><span class="attribute">public</span> static void main(java.lang.String[]);</span><br><span class="line">  <span class="attribute">descriptor</span>: ([Ljava/lang/String;)V</span><br><span class="line">  <span class="attribute">flags</span>: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">  <span class="attribute">Code</span>:</span><br><span class="line">    <span class="attribute">stack</span>=<span class="number">1</span>, locals=<span class="number">3</span>, args_size=<span class="number">1</span></span><br><span class="line">       <span class="attribute">0</span>: iconst_0</span><br><span class="line">       <span class="attribute">1</span>: istore_1</span><br><span class="line">       <span class="attribute">2</span>: bipush        <span class="number">10</span></span><br><span class="line">       <span class="attribute">4</span>: istore_1</span><br><span class="line">       <span class="attribute">5</span>: goto          <span class="number">26</span></span><br><span class="line">       <span class="attribute">8</span>: astore_2</span><br><span class="line">       <span class="attribute">9</span>: bipush        <span class="number">20</span></span><br><span class="line">      <span class="attribute">11</span>: istore_1</span><br><span class="line">      <span class="attribute">12</span>: goto          <span class="number">26</span></span><br><span class="line">      <span class="attribute">15</span>: astore_2</span><br><span class="line">      <span class="attribute">16</span>: bipush        <span class="number">30</span></span><br><span class="line">      <span class="attribute">18</span>: istore_1</span><br><span class="line">      <span class="attribute">19</span>: goto          <span class="number">26</span></span><br><span class="line">      <span class="attribute">22</span>: astore_2</span><br><span class="line">      <span class="attribute">23</span>: bipush        <span class="number">40</span></span><br><span class="line">      <span class="attribute">25</span>: istore_1</span><br><span class="line">      <span class="attribute">26</span>: return</span><br><span class="line">    <span class="attribute">Exception</span> table:</span><br><span class="line">       <span class="attribute">from</span>    to  target type</span><br><span class="line">           <span class="attribute">2</span>     <span class="number">5</span>     <span class="number">8</span>   Class java/lang/ArithmeticException</span><br><span class="line">           <span class="attribute">2</span>     <span class="number">5</span>    <span class="number">15</span>   Class java/lang/NullPointerException</span><br><span class="line">           <span class="attribute">2</span>     <span class="number">5</span>    <span class="number">22</span>   Class java/lang/Exception</span><br><span class="line">    <span class="attribute">LineNumberTable</span>:</span><br><span class="line">      <span class="attribute">line</span> <span class="number">5</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">7</span>: <span class="number">2</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">14</span>: <span class="number">5</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">8</span>: <span class="number">8</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">9</span>: <span class="number">9</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">14</span>: <span class="number">12</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">10</span>: <span class="number">15</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">11</span>: <span class="number">16</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">14</span>: <span class="number">19</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">12</span>: <span class="number">22</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">13</span>: <span class="number">23</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">15</span>: <span class="number">26</span></span><br><span class="line">    <span class="attribute">LocalVariableTable</span>:</span><br><span class="line">      <span class="attribute">Start</span>  Length  Slot  Name   Signature</span><br><span class="line">          <span class="attribute">9</span>       <span class="number">3</span>     <span class="number">2</span>     e   Ljava/lang/ArithmeticException;</span><br><span class="line">         <span class="attribute">16</span>       <span class="number">3</span>     <span class="number">2</span>     e   Ljava/lang/NullPointerException;</span><br><span class="line">         <span class="attribute">23</span>       <span class="number">3</span>     <span class="number">2</span>     e   Ljava/lang/Exception;</span><br><span class="line">          <span class="attribute">0</span>      <span class="number">27</span>     <span class="number">0</span>  args  <span class="meta"> [Ljava/lang/String;</span></span><br><span class="line"><span class="meta">          2      25     1     i   I</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>因为异常出现时，只能进入一个<code>Exception table</code>的分支，所以局部变量表<code>slot 2</code>位置被共用</p>
</li>
<li>
<p><code>[from, to)</code>的检测范围都相同，只不过<code>target</code>的行号不同，对应三个catch块</p>
</li>
</ul>
</li>
<li>
<p>multi-catch的情况</p>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_33</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        int i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            i = <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="title class_">NoSuchMethodError</span> | <span class="title class_">IllegalAccessError</span> | <span class="title class_">Exception</span> e) &#123;</span><br><span class="line">            e.<span class="title function_">printStackTrace</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JAVA</span></span><br><span class="line"><span class="attribute">public</span> static void main(java.lang.String[]);</span><br><span class="line">    <span class="attribute">descriptor</span>: ([Ljava/lang/String;)V</span><br><span class="line">    <span class="attribute">flags</span>: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    <span class="attribute">Code</span>:</span><br><span class="line">    <span class="attribute">stack</span>=<span class="number">1</span>, locals=<span class="number">3</span>, args_size=<span class="number">1</span></span><br><span class="line">        <span class="attribute">0</span>: iconst_0</span><br><span class="line">        <span class="attribute">1</span>: istore_1</span><br><span class="line">        <span class="attribute">2</span>: bipush        <span class="number">10</span></span><br><span class="line">        <span class="attribute">4</span>: istore_1</span><br><span class="line">        <span class="attribute">5</span>: goto          <span class="number">13</span></span><br><span class="line">        <span class="attribute">8</span>: astore_2</span><br><span class="line">        <span class="attribute">9</span>: aload_2</span><br><span class="line">        <span class="attribute">10</span>: invokevirtual #<span class="number">5</span>                  // Method java/lang/Throwable.printStackTrace:()V</span><br><span class="line">        <span class="attribute">13</span>: return</span><br><span class="line">    <span class="attribute">Exception</span> table:</span><br><span class="line">        <span class="attribute">from</span>    to  target type</span><br><span class="line">            <span class="attribute">2</span>     <span class="number">5</span>     <span class="number">8</span>   Class java/lang/NoSuchMethodError</span><br><span class="line">            <span class="attribute">2</span>     <span class="number">5</span>     <span class="number">8</span>   Class java/lang/IllegalAccessError</span><br><span class="line">            <span class="attribute">2</span>     <span class="number">5</span>     <span class="number">8</span>   Class java/lang/Exception</span><br><span class="line">    <span class="attribute">LineNumberTable</span>:</span><br><span class="line">        <span class="attribute">line</span> <span class="number">5</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">line</span> <span class="number">7</span>: <span class="number">2</span></span><br><span class="line">        <span class="attribute">line</span> <span class="number">10</span>: <span class="number">5</span></span><br><span class="line">        <span class="attribute">line</span> <span class="number">11</span>: <span class="number">13</span></span><br><span class="line">    <span class="attribute">LocalVariableTable</span>:</span><br><span class="line">        <span class="attribute">Start</span>  Length  Slot  Name   Signature</span><br><span class="line">            <span class="attribute">9</span>       <span class="number">4</span>     <span class="number">2</span>     e   Ljava/lang/Throwable;</span><br><span class="line">            <span class="attribute">0</span>      <span class="number">14</span>     <span class="number">0</span>  args  <span class="meta"> [Ljava/lang/String;</span></span><br><span class="line"><span class="meta">            2      12     1     i   I</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>[from, to)</code>的检测范围都相同，<code>target</code>的行号也相同</p>
</li>
</ul>
</li>
<li>
<p>finally</p>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo_34</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        int i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            i = <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="title class_">Exception</span> e) &#123;</span><br><span class="line">            i = <span class="number">20</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            i = <span class="number">30</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">public static void main(java.lang.String[]);</span><br><span class="line">    descriptor: ([Ljava<span class="regexp">/lang/</span>String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">        stack=<span class="number">1</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">            <span class="number">0</span>: iconst_0</span><br><span class="line">            <span class="number">1</span>: istore_1             <span class="regexp">//</span> <span class="number">0</span> -&gt; i</span><br><span class="line">            <span class="number">2</span>: bipush       <span class="number">10</span>      <span class="regexp">//</span> try ---------------------------</span><br><span class="line">            <span class="number">4</span>: istore_1             <span class="regexp">//</span> <span class="number">10</span> -&gt; i                       |</span><br><span class="line">            <span class="number">5</span>: bipush       <span class="number">30</span>      <span class="regexp">//</span>                               |</span><br><span class="line">            <span class="number">7</span>: istore_1             <span class="regexp">//</span> <span class="number">30</span> -&gt; i                       |</span><br><span class="line">            <span class="number">8</span>: goto         <span class="number">27</span>      <span class="regexp">//</span> return ------------------------</span><br><span class="line">            <span class="number">11</span>: astore_2            <span class="regexp">//</span> catch Exception -&gt; e ----------</span><br><span class="line">            <span class="number">12</span>: bipush <span class="number">20</span>           <span class="regexp">//</span>                               |</span><br><span class="line">            <span class="number">14</span>: istore_1            <span class="regexp">//</span> <span class="number">20</span> -&gt; i                       |</span><br><span class="line">            <span class="number">15</span>: bipush      <span class="number">30</span>      <span class="regexp">//</span>                               |</span><br><span class="line">            <span class="number">17</span>: istore_1            <span class="regexp">//</span> <span class="number">30</span> -&gt; i                       |</span><br><span class="line">            <span class="number">18</span>: goto        <span class="number">27</span>      <span class="regexp">//</span> return ------------------------</span><br><span class="line">            <span class="number">21</span>: astore_3            <span class="regexp">//</span> catch any -&gt; slot <span class="number">3</span> -----------</span><br><span class="line">            <span class="number">22</span>: bipush      <span class="number">30</span>      <span class="regexp">//</span>                               |</span><br><span class="line">            <span class="number">24</span>: istore_1            <span class="regexp">//</span> <span class="number">30</span> -&gt; i                       |</span><br><span class="line">            <span class="number">25</span>: aload_3             <span class="regexp">//</span> &lt;- slot <span class="number">3</span>                     |</span><br><span class="line">            <span class="number">26</span>: athrow              <span class="regexp">//</span> throw -------------------------</span><br><span class="line">            <span class="number">27</span>: return</span><br><span class="line">        Exception table:</span><br><span class="line">            from to target type</span><br><span class="line">            <span class="number">2</span> <span class="number">5</span> <span class="number">11</span> java<span class="regexp">/lang/</span>Exception</span><br><span class="line">            <span class="number">2</span> <span class="number">5</span> <span class="number">21</span> any</span><br><span class="line">            <span class="number">11</span> <span class="number">15</span> <span class="number">21</span> any</span><br><span class="line">        LineNumberTable: ...</span><br><span class="line">        LocalVariableTable:</span><br><span class="line">            Start Length Slot Name Signature</span><br><span class="line">            <span class="number">0</span> <span class="number">28</span> <span class="number">0</span> args [Ljava<span class="regexp">/lang/</span>String;</span><br><span class="line">            <span class="number">2</span> <span class="number">26</span> <span class="number">1</span> i I</span><br><span class="line">            <span class="number">12</span> <span class="number">3</span> <span class="number">2</span> e Ljava<span class="regexp">/lang/</span>Exception;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>可以看到有3个</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">from</span>, <span class="keyword">to</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>第一个<code>[2, 5)</code>是检测try块中是否有Exception异常，如果有则跳转至11行执行catch块</li>
<li>第二个<code>[2, 5)</code>是检测try块中是否有其他异常（非Exception异常），如果有则跳转至21行执行finally块</li>
<li>第三个<code>[11, 15)</code>是检测catch快中是否有其他异常，如果有则跳转至21行执行finally块</li>
</ul>
</li>
<li>
<p>结论：finally中的代码被复制了三分，分别放进try流程、catch流程以及catch剩余的异常类型流程</p>
</li>
</ul>
</li>
</ol>
<h2 id="关于finally的面试题">关于finally的面试题</h2>
<ol>
<li>
<p>finally中出现了return</p>
<ul>
<li>
<p>原始Java代码，先自己试着想一下最终的结果是啥：</p>
<p>20</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Demo_35</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">int</span> result = test();</span><br><span class="line">        System.<span class="keyword">out</span>.println(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">test</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<ul>
<li>
<p>注意这里要加上-p参数，才能显示私有方法的信息</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BASH</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">javap </span>-v -p Demo_35.class</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JAVA</span></span><br><span class="line"><span class="attribute">private</span> static int test();</span><br><span class="line">  <span class="attribute">descriptor</span>: ()I</span><br><span class="line">  <span class="attribute">flags</span>: ACC_PRIVATE, ACC_STATIC</span><br><span class="line">  <span class="attribute">Code</span>:</span><br><span class="line">    <span class="attribute">stack</span>=<span class="number">1</span>, locals=<span class="number">2</span>, args_size=<span class="number">0</span></span><br><span class="line">       <span class="attribute">0</span>: bipush        <span class="number">10</span>      // 将 int <span class="number">10</span> 压入栈顶</span><br><span class="line">       <span class="attribute">2</span>: istore_0              // 将栈顶的 int <span class="number">10</span> 存入到局部变量 slot <span class="number">0</span> 中，并从栈顶弹出</span><br><span class="line">       <span class="attribute">3</span>: bipush        <span class="number">20</span>      // 将 int <span class="number">20</span> 压入栈顶</span><br><span class="line">       <span class="attribute">5</span>: ireturn               // 返回栈顶的 int <span class="number">20</span></span><br><span class="line">       <span class="attribute">6</span>: astore_1              // 捕获任何异常</span><br><span class="line">       <span class="attribute">7</span>: bipush        <span class="number">20</span>      // 将 int <span class="number">20</span> 压入栈顶</span><br><span class="line">       <span class="attribute">9</span>: ireturn</span><br><span class="line">    <span class="attribute">Exception</span> table:</span><br><span class="line">       <span class="attribute">from</span>    to  target type</span><br><span class="line">           <span class="attribute">0</span>     <span class="number">3</span>     <span class="number">6</span>   any</span><br><span class="line">    <span class="attribute">LineNumberTable</span>:</span><br><span class="line">      <span class="attribute">line</span> <span class="number">11</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">13</span>: <span class="number">3</span></span><br><span class="line">    <span class="attribute">StackMapTable</span>: number_of_entries = <span class="number">1</span></span><br><span class="line">      <span class="attribute">frame_type</span> = <span class="number">70</span> /* same_locals_1_stack_item */</span><br><span class="line">        <span class="attribute">stack</span> =<span class="meta"> [ class java/lang/Throwable ]</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>由于finally中的ireturn被插入了所有可能的流程，因此返回结果肯定以finally为准</p>
</li>
<li>
<p>至于字节码中的第二行，目前看似没啥用，先留个伏笔，等下个例子来讲解</p>
</li>
<li>
<p>之前的finally例子中，最后都会有一个athrow，这告诉我们，如果在finally中出现了return，那么就会吞掉异常，具体来看下面这个例子</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Demo_36</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">int</span> result = test();</span><br><span class="line">        System.<span class="keyword">out</span>.println(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">test</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>运行上面的代码，不会出现任何异常，输出20，<code>i = 1 / 0</code>那个异常被吞掉了</p>
</li>
</ul>
</li>
<li>
<p>finally对返回值的影响</p>
<ul>
<li>
<p>原始Java代码，还是先试着想想结果会输出什么：</p>
<p>10</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Demo_37</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">int</span> result = test();</span><br><span class="line">        System.<span class="keyword">out</span>.println(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">test</span>()</span> &#123;</span><br><span class="line">        <span class="built_in">int</span> i = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            i = <span class="number">20</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JAVA</span></span><br><span class="line"><span class="attribute">private</span> static int test();</span><br><span class="line">  <span class="attribute">descriptor</span>: ()I</span><br><span class="line">  <span class="attribute">flags</span>: ACC_PRIVATE, ACC_STATIC</span><br><span class="line">  <span class="attribute">Code</span>:</span><br><span class="line">    <span class="attribute">stack</span>=<span class="number">1</span>, locals=<span class="number">3</span>, args_size=<span class="number">0</span></span><br><span class="line">       <span class="attribute">0</span>: bipush        <span class="number">10</span>      // 将 <span class="number">10</span> 放入栈顶</span><br><span class="line">       <span class="attribute">2</span>: istore_0              // <span class="number">10</span> -&gt; i</span><br><span class="line">       <span class="attribute">3</span>: iload_0               // &lt;- i(<span class="number">10</span>)</span><br><span class="line">       <span class="attribute">4</span>: istore_1              // 将 i(<span class="number">10</span>) 暂存至 slot <span class="number">1</span>，目的是为了固定返回值</span><br><span class="line">       <span class="attribute">5</span>: bipush        <span class="number">20</span>      // 将 <span class="number">20</span> 放入栈顶</span><br><span class="line">       <span class="attribute">7</span>: istore_0              // <span class="number">20</span> -&gt; i</span><br><span class="line">       <span class="attribute">8</span>: iload_1               // 载入 slot <span class="number">1</span> 暂存的值 (<span class="number">10</span>)</span><br><span class="line">       <span class="attribute">9</span>: ireturn               // 返回栈顶的值</span><br><span class="line">      <span class="attribute">10</span>: astore_2</span><br><span class="line">      <span class="attribute">11</span>: bipush        <span class="number">20</span></span><br><span class="line">      <span class="attribute">13</span>: istore_0</span><br><span class="line">      <span class="attribute">14</span>: aload_2</span><br><span class="line">      <span class="attribute">15</span>: athrow</span><br><span class="line">    <span class="attribute">Exception</span> table:</span><br><span class="line">       <span class="attribute">from</span>    to  target type</span><br><span class="line">           <span class="attribute">3</span>     <span class="number">5</span>    <span class="number">10</span>   any</span><br><span class="line">    <span class="attribute">LineNumberTable</span>:</span><br><span class="line">      <span class="attribute">line</span> <span class="number">10</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">12</span>: <span class="number">3</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">14</span>: <span class="number">5</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">12</span>: <span class="number">8</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">14</span>: <span class="number">10</span></span><br><span class="line">      <span class="attribute">line</span> <span class="number">15</span>: <span class="number">14</span></span><br><span class="line">    <span class="attribute">LocalVariableTable</span>:</span><br><span class="line">      <span class="attribute">Start</span>  Length  Slot  Name   Signature</span><br><span class="line">          <span class="attribute">3</span>      <span class="number">13</span>     <span class="number">0</span>     i   I</span><br><span class="line">    <span class="attribute">StackMapTable</span>: number_of_entries = <span class="number">1</span></span><br><span class="line">      <span class="attribute">frame_type</span> = <span class="number">255</span> /* full_frame */</span><br><span class="line">        <span class="attribute">offset_delta</span> = <span class="number">10</span></span><br><span class="line">        <span class="attribute">locals</span> =<span class="meta"> [ int ]</span></span><br><span class="line">        <span class="attribute">stack</span> =<span class="meta"> [ class java/lang/Throwable ]</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>虽然在 finally 块中将 i 的值修改为 20，但是这不会影响 return 语句的返回值，因为在返回之前，i 的值已经被暂存到了 slot 1 中。在 finally 块中对 i 进行的修改不会影响 slot 1 中的值，因此 ireturn 指令返回的是 slot 1 中的值，即 10。</p>
</li>
</ul>
</li>
</ol>
<h2 id="synchronized">synchronized</h2>
<ul>
<li>
<p>synchronized代码块是对一个对象进行加锁操作，那么它是如何保障当synchronized代码块中出现了异常，还能正确的执行解锁操作呢？下面就从字节码的角度来分析一下底层原理</p>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Demo_38 &#123;</span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) &#123;</span><br><span class="line">        <span class="keyword">Object</span> <span class="keyword">lock</span> = <span class="built_in">new</span> <span class="keyword">Object</span>();</span><br><span class="line">        synchronized (<span class="keyword">lock</span>) &#123;</span><br><span class="line">            <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;ok&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">JAVA</span></span><br><span class="line"><span class="string">public</span> <span class="string">static</span> <span class="string">void</span> <span class="string">main(java.lang.String[]);</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">([Ljava/lang/String;)V</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_PUBLIC,</span> <span class="string">ACC_STATIC</span></span><br><span class="line">  <span class="attr">Code:</span></span><br><span class="line">    <span class="string">stack=2,</span> <span class="string">locals=4,</span> <span class="string">args_size=1</span></span><br><span class="line">       <span class="attr">0:</span> <span class="string">new</span>           <span class="comment">#2                  // class java/lang/Object</span></span><br><span class="line">       <span class="attr">3:</span> <span class="string">dup</span></span><br><span class="line">       <span class="attr">4:</span> <span class="string">invokespecial</span> <span class="comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">       <span class="attr">7:</span> <span class="string">astore_1</span>                          <span class="string">//</span> <span class="string">lock引用</span> <span class="string">-&gt;</span> <span class="string">lock</span></span><br><span class="line">       <span class="attr">8:</span> <span class="string">aload_1</span>                           <span class="string">//</span> <span class="string">&lt;-</span> <span class="string">lock</span> <span class="string">（synchronized开始）</span></span><br><span class="line">       <span class="attr">9:</span> <span class="string">dup</span></span><br><span class="line">      <span class="attr">10:</span> <span class="string">astore_2</span>                          <span class="string">//</span> <span class="string">lock引用</span> <span class="string">-&gt;</span> <span class="string">slot</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">11:</span> <span class="string">monitorenter</span>                      <span class="string">//</span> <span class="string">monitorenter(lock引用)</span></span><br><span class="line">      <span class="attr">12:</span> <span class="string">getstatic</span>     <span class="comment">#3                  // Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">      <span class="attr">15:</span> <span class="string">ldc</span>           <span class="comment">#4                  // String ok</span></span><br><span class="line">      <span class="attr">17:</span> <span class="string">invokevirtual</span> <span class="comment">#5                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">      <span class="attr">20:</span> <span class="string">aload_2</span>                           <span class="string">//</span> <span class="string">&lt;-</span> <span class="string">slot</span> <span class="number">2</span><span class="string">(lock引用)</span></span><br><span class="line">      <span class="attr">21:</span> <span class="string">monitorexit</span>                       <span class="string">//</span> <span class="string">monitorexit(lock引用)</span></span><br><span class="line">      <span class="attr">22:</span> <span class="string">goto</span>          <span class="number">30</span></span><br><span class="line">      <span class="attr">25:</span> <span class="string">astore_3</span>                          <span class="string">//</span> <span class="string">any</span> <span class="string">-&gt;</span> <span class="string">slot</span> <span class="number">3</span></span><br><span class="line">      <span class="attr">26:</span> <span class="string">aload_2</span>                           <span class="string">//</span> <span class="string">&lt;-</span> <span class="string">slot</span> <span class="number">2</span><span class="string">(lock引用)</span></span><br><span class="line">      <span class="attr">27:</span> <span class="string">monitorexit</span>                       <span class="string">//</span> <span class="string">monitorexit(lock引用)</span></span><br><span class="line">      <span class="attr">28:</span> <span class="string">aload_3</span></span><br><span class="line">      <span class="attr">29:</span> <span class="string">athrow</span></span><br><span class="line">      <span class="attr">30:</span> <span class="string">return</span></span><br><span class="line">    <span class="attr">Exception table:</span></span><br><span class="line">       <span class="string">from</span>    <span class="string">to</span>  <span class="string">target</span> <span class="string">type</span></span><br><span class="line">          <span class="number">12</span>    <span class="number">22</span>    <span class="number">25</span>   <span class="string">any</span></span><br><span class="line">          <span class="number">25</span>    <span class="number">28</span>    <span class="number">25</span>   <span class="string">any</span></span><br><span class="line">    <span class="attr">LineNumberTable:</span></span><br><span class="line">      <span class="attr">line 5:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">line 6:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">line 7:</span> <span class="number">12</span></span><br><span class="line">      <span class="attr">line 8:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">line 9:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">LocalVariableTable:</span></span><br><span class="line">      <span class="string">Start</span>  <span class="string">Length</span>  <span class="string">Slot</span>  <span class="string">Name</span>   <span class="string">Signature</span></span><br><span class="line">          <span class="number">0</span>      <span class="number">31</span>     <span class="number">0</span>  <span class="string">args</span>   [<span class="string">Ljava/lang/String;</span></span><br><span class="line">          <span class="number">8</span>      <span class="number">23</span>     <span class="number">1</span>  <span class="string">lock</span>   <span class="string">Ljava/lang/Object;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>[12, 22)</code>是监测的释放锁的流程，如果出现了异常，则跳转到25行，将异常信息存储到slot 3，同时再次尝试释放锁</p>
</li>
<li>
<p><code>[25, 28)</code>也是监测异常，如果有异常，</p>
</li>
</ul>
</li>
</ul>
<h1>编译期处理</h1>
<ul>
<li>所谓<code>语法糖</code>，其实就是指Java编译器把*.java编译为*.class字节码的过程中，自动生成的和转换的一些代码，主要是为了减轻程序员的负担，算是Java编译器给我们的一个额外福利</li>
<li>下面的代码分析，借助了javap工具、idea的反编译功能、idea插件jclasslib等工具。另外，编译器转换的结果直接就是class字节码，只是为了便于阅读，给出了<code>几乎等价</code>的Java源码</li>
</ul>
<h2 id="默认构造器">默认构造器</h2>
<ul>
<li>
<p>如果一个类没有声明任何构造函数，Java 编译器会自动为该类生成一个无参构造函数。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">Candy01</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译成class后的代码</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy1</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="regexp">//</span> 这个无参构造是编译器帮助我们加上的</span><br><span class="line">    <span class="keyword">public</span> <span class="title class_">Candy1</span>() &#123;</span><br><span class="line">        <span class="variable language_">super</span>(); <span class="regexp">//</span> 即调用父类 <span class="title class_">Object</span> 的无参构造方法，即调用 java/lang/<span class="title class_">Object</span>.<span class="string">&quot;&lt;init&gt;&quot;</span><span class="symbol">:</span>()V</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="自动拆装箱">自动拆装箱</h2>
<ul>
<li>
<p>这个特性是</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JDK</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>开始加入的，</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">代码片段1：</span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy02</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        Integer x = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> y = x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>但是这段代码在</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JDK</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>之前是无法编译通过的，比如改写为如下形式，</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">代码片段2</span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy02</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        Integer x = Integer.<span class="built_in">valueOf</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> y = x.<span class="built_in">intValue</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>显然之前版本的代码太麻烦了，需要在基本类型和包装类型之间相互转换（尤其是集合类中的操作都是包装类型），因此这些转换的事情在<code>JDK 5</code>以后都由编译器在编译阶段完成。即<code>代码片段1</code>都会在编译阶段转换成<code>代码片段2</code></p>
</li>
</ul>
<h2 id="泛型集合取值">泛型集合取值</h2>
<ul>
<li>
<p>泛型也是</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JDK</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>开始加入的特性，但Java在编译泛型后会执行</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">泛型擦除</span><br></pre></td></tr></table></figure>
<p>的动作，即泛型信息在编译为字节码后就丢失了，实际的类型都当做Object类型来处理</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Candy03 &#123;</span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) &#123;</span><br><span class="line">        List&lt;<span class="type">Integer</span>&gt; list = <span class="built_in">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.<span class="keyword">add</span>(<span class="number">10</span>);               // 实际调用的是 List.<span class="keyword">add</span>(<span class="keyword">Object</span> e)</span><br><span class="line">        <span class="type">Integer</span> x = list.<span class="keyword">get</span>(<span class="number">0</span>);    // 实际调用的是 <span class="keyword">Object</span> obj = List.<span class="keyword">get</span>(<span class="type">int</span> <span class="keyword">index</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>所以在取值时，编译器真正生成的字节码中，还需要额外做一个类型转换的操作</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">// 需要将 <span class="keyword">Object</span> 转为 <span class="type">Integer</span></span><br><span class="line"><span class="type">Integer</span> x = (<span class="type">Integer</span>)list.<span class="keyword">get</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>如果前面的x遍历修改为int基本类型，那么最终生成的字节码为</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="type">int</span> x = (<span class="type">Integer</span>)list.<span class="keyword">get</span>(<span class="number">0</span>).intValue();</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>还好这些麻烦事都不用自己做，要么叫语法糖呢</p>
</li>
<li>
<p>擦除的是字节码上的泛型信息，可以看到LocalVariableTypeTable仍然保留了方法参数泛型的信息</p>
<ul>
<li>
<p>从下面字节码的第26行，我们可以清楚的看到add方法其实添加的是Object类型对象</p>
</li>
<li>
<p>从下面字节码的第30行，我们可以清楚的看到get方法的返回值也是Object类型对象</p>
</li>
<li>
<p>同时第31行是将类型强制转换为Integer</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">JAVA</span></span><br><span class="line"><span class="string">public</span> <span class="string">com.demo.Candy03();</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">()V</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_PUBLIC</span></span><br><span class="line">  <span class="attr">Code:</span></span><br><span class="line">    <span class="string">stack=1,</span> <span class="string">locals=1,</span> <span class="string">args_size=1</span></span><br><span class="line">       <span class="attr">0:</span> <span class="string">aload_0</span></span><br><span class="line">       <span class="attr">1:</span> <span class="string">invokespecial</span> <span class="comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">       <span class="attr">4:</span> <span class="string">return</span></span><br><span class="line">    <span class="attr">LineNumberTable:</span></span><br><span class="line">      <span class="attr">line 6:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">LocalVariableTable:</span></span><br><span class="line">      <span class="string">Start</span>  <span class="string">Length</span>  <span class="string">Slot</span>  <span class="string">Name</span>   <span class="string">Signature</span></span><br><span class="line">          <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="string">this</span>   <span class="string">Lcom/demo/Candy03;</span></span><br><span class="line"><span class="string">public</span> <span class="string">static</span> <span class="string">void</span> <span class="string">main(java.lang.String[]);</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">([Ljava/lang/String;)V</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_PUBLIC,</span> <span class="string">ACC_STATIC</span></span><br><span class="line">  <span class="attr">Code:</span></span><br><span class="line">    <span class="string">stack=2,</span> <span class="string">locals=3,</span> <span class="string">args_size=1</span></span><br><span class="line">       <span class="attr">0:</span> <span class="string">new</span>           <span class="comment">#2                  // class java/util/ArrayList</span></span><br><span class="line">       <span class="attr">3:</span> <span class="string">dup</span></span><br><span class="line">       <span class="attr">4:</span> <span class="string">invokespecial</span> <span class="comment">#3                  // Method java/util/ArrayList.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">       <span class="attr">7:</span> <span class="string">astore_1</span></span><br><span class="line">       <span class="attr">8:</span> <span class="string">aload_1</span></span><br><span class="line">       <span class="attr">9:</span> <span class="string">bipush</span>        <span class="number">10</span></span><br><span class="line">      <span class="attr">11:</span> <span class="string">invokestatic</span>  <span class="comment">#4                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">      <span class="attr">14:</span> <span class="string">invokeinterface</span> <span class="comment">#5,  2            // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z</span></span><br><span class="line">      <span class="attr">19:</span> <span class="string">pop</span></span><br><span class="line">      <span class="attr">20:</span> <span class="string">aload_1</span></span><br><span class="line">      <span class="attr">21:</span> <span class="string">iconst_0</span></span><br><span class="line">      <span class="attr">22:</span> <span class="string">invokeinterface</span> <span class="comment">#6,  2            // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;</span></span><br><span class="line">      <span class="attr">27:</span> <span class="string">checkcast</span>     <span class="comment">#7                  // class java/lang/Integer</span></span><br><span class="line">      <span class="attr">30:</span> <span class="string">astore_2</span></span><br><span class="line">      <span class="attr">31:</span> <span class="string">return</span></span><br><span class="line">    <span class="attr">LineNumberTable:</span></span><br><span class="line">      <span class="attr">line 8:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">line 9:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">line 10:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">line 11:</span> <span class="number">31</span></span><br><span class="line">    <span class="attr">LocalVariableTable:</span></span><br><span class="line">      <span class="string">Start</span>  <span class="string">Length</span>  <span class="string">Slot</span>  <span class="string">Name</span>   <span class="string">Signature</span></span><br><span class="line">          <span class="number">0</span>      <span class="number">32</span>     <span class="number">0</span>  <span class="string">args</span>   [<span class="string">Ljava/lang/String;</span></span><br><span class="line">          <span class="number">8</span>      <span class="number">24</span>     <span class="number">1</span>  <span class="string">list</span>   <span class="string">Ljava/util/List;</span></span><br><span class="line">         <span class="number">31</span>       <span class="number">1</span>     <span class="number">2</span>     <span class="string">x</span>   <span class="string">Ljava/lang/Integer;</span></span><br><span class="line">    <span class="attr">LocalVariableTypeTable:</span></span><br><span class="line">      <span class="string">Start</span>  <span class="string">Length</span>  <span class="string">Slot</span>  <span class="string">Name</span>   <span class="string">Signature</span></span><br><span class="line">          <span class="number">8</span>      <span class="number">24</span>     <span class="number">1</span>  <span class="string">list</span>   <span class="string">Ljava/util/List&lt;Ljava/lang/Integer;&gt;;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>使用反射，能够获取到方法类型参数的泛型和方法返回值泛型的信息</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Candy03 &#123;</span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="keyword">Method</span> test = Candy03.<span class="keyword">class</span>.getMethod(&quot;test&quot;, List.<span class="keyword">class</span>, Map.<span class="keyword">class</span>);</span><br><span class="line">        <span class="keyword">Type</span>[] <span class="keyword">types</span> = test.getGenericParameterTypes();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">Type</span> <span class="keyword">type</span> : <span class="keyword">types</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">type</span> instanceof ParameterizedType) &#123;</span><br><span class="line">                ParameterizedType parameterizedType = (ParameterizedType) <span class="keyword">type</span>;</span><br><span class="line">                <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;原始类型 - &quot; + parameterizedType.getRawType());</span><br><span class="line">                <span class="keyword">Type</span>[] arguments = parameterizedType.getActualTypeArguments();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arguments.length; i++) &#123;</span><br><span class="line">                    <span class="keyword">System</span>.<span class="keyword">out</span>.printf(&quot;泛型参数[%d] - %s\n&quot;, i, arguments[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;返回类型 - &quot; + test.getGenericReturnType());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> <span class="keyword">Set</span>&lt;<span class="type">Integer</span>&gt; test(List&lt;String&gt; list, Map&lt;<span class="type">Integer</span>, <span class="keyword">Object</span>&gt; map) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">原始类型 - interface java<span class="selector-class">.util</span><span class="selector-class">.List</span></span><br><span class="line">泛型参数<span class="selector-attr">[0]</span> - class java<span class="selector-class">.lang</span><span class="selector-class">.String</span></span><br><span class="line">原始类型 - interface java<span class="selector-class">.util</span><span class="selector-class">.Map</span></span><br><span class="line">泛型参数<span class="selector-attr">[0]</span> - class java<span class="selector-class">.lang</span><span class="selector-class">.Integer</span></span><br><span class="line">泛型参数<span class="selector-attr">[1]</span> - class java<span class="selector-class">.lang</span><span class="selector-class">.Object</span></span><br><span class="line">返回类型 - java<span class="selector-class">.util</span>.Set&lt;java<span class="selector-class">.lang</span>.Integer&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="可变参数">可变参数</h2>
<ul>
<li>
<p>可变参数也是</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JDK</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>开始加入的新特性，示例代码如下</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy04</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        <span class="title function_">foo</span>(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">foo</span>(<span class="params"><span class="built_in">String</span>... args</span>) &#123;</span><br><span class="line">        <span class="title class_">String</span>[] array = args;</span><br><span class="line">        <span class="title class_">System</span>.<span class="property">out</span>.<span class="title function_">println</span>(array);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>可变参数String… args 其实是一个String[] args，同样Java编译器会在编译期间将上述代码转换为</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy04</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        <span class="title function_">foo</span>(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">foo</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        <span class="title class_">String</span>[] array = args;          <span class="comment">// 直接赋值</span></span><br><span class="line">        <span class="title class_">System</span>.<span class="property">out</span>.<span class="title function_">println</span>(array);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>注意：如果调用foo()时没有提供任何参数，那么则等价为foo(new String)，创建了一个空的数组，而不是传一个null进去</li>
</ul>
</li>
</ul>
<h2 id="foreach循环">foreach循环</h2>
<ul>
<li>
<p>仍然是JDK 5开始引入的语法糖，数组的循环</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JAVA<span class="keyword"></span></span><br><span class="line"><span class="keyword">public</span> class Candy05 &#123;</span><br><span class="line">   <span class="keyword"> public</span><span class="keyword"> static</span> void main(String[] args) &#123;</span><br><span class="line">        int[]<span class="built_in"> array </span>= &#123;1, 2, 3, 4, 5&#125;;      // 数组的赋初值的简化，也是语法糖<span class="built_in"> new </span>int[]&#123;1, 2, 3, 4, 5&#125;</span><br><span class="line">        for (int a<span class="keyword"> :</span> array) &#123;</span><br><span class="line">            System.out.println(a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>会被编译器转换为</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">JAVA<span class="keyword"></span></span><br><span class="line"><span class="keyword">public</span> class Candy05 &#123;</span><br><span class="line">   <span class="keyword"> public</span> Candy05() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword"> public</span><span class="keyword"> static</span> void main(String[] args) &#123;</span><br><span class="line">        int[]<span class="built_in"> array </span>=<span class="built_in"> new </span>int[]&#123;1, 2, 3, 4, 5&#125;;</span><br><span class="line">        for(int i = 0; i &lt; array.length; ++i) &#123;</span><br><span class="line">           <span class="built_in"> int </span>e = array[i];</span><br><span class="line">            System.out.println(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>而集合的循环</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Candy06 &#123;</span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) &#123;</span><br><span class="line">        List&lt;<span class="type">Integer</span>&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">Integer</span> <span class="type">integer</span> : list) &#123;</span><br><span class="line">            <span class="keyword">System</span>.<span class="keyword">out</span>.println(<span class="type">integer</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>实际上会被编译器转换为对迭代器的调用</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Candy06 &#123;</span><br><span class="line">    <span class="keyword">public</span> Candy06() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) &#123;</span><br><span class="line">        List&lt;Integer&gt; list = Arrays.<span class="keyword">asList</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        Iterator iterator = list.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">            Integer <span class="keyword">next</span> = (Integer) iterator.<span class="keyword">next</span>();</span><br><span class="line">            System.out.<span class="keyword">println</span>(<span class="keyword">next</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>foreach循环写法，能够配合数组，以及所有实现了Iterable接口的集合类一起使用，其中Iterable用来获取集合的迭代器Iterator</li>
</ul>
</li>
</ul>
<h2 id="switch字符串">switch字符串</h2>
<ul>
<li>
<p>从</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JDK</span> <span class="number">7</span></span><br></pre></td></tr></table></figure>
<p>开始，switch可以作用于字符串和枚举类，这个功能其实也是语法糖，例如</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy07</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> choose(String <span class="built_in">str</span>) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">str</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;hello&quot;</span>: &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;h&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;world&quot;</span>: &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;w&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>注意：swtich配合Spring和枚举使用时，变量不能为null，原因分析完语法糖转换后的代码，自然就清楚了</li>
</ul>
</li>
<li>
<p>会被编译器转换为</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Candy07</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Candy07</span>()</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">choose</span>(<span class="params">String str</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">byte</span> x = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">switch</span> (str.hashCode()) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">99162322</span>:                  <span class="comment">// hello 的 hashCode</span></span><br><span class="line">                <span class="keyword">if</span> (str.<span class="keyword">equals</span>(<span class="string">&quot;hello&quot;</span>)) &#123;</span><br><span class="line">                    x = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">113318802</span>:                 <span class="comment">// world 的 hashCode</span></span><br><span class="line">                <span class="keyword">if</span> (str.<span class="keyword">equals</span>(<span class="string">&quot;world&quot;</span>)) &#123;</span><br><span class="line">                    x = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> (x) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                System.<span class="keyword">out</span>.println(<span class="string">&quot;h&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                System.<span class="keyword">out</span>.println(<span class="string">&quot;w&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>可以看到，执行了两边switch，第一遍是根据字符串的hashCode和queals将字符串转换为相应byte类型，第二遍才是利用byte进行比较</p>
</li>
<li>
<p>那为什么第一遍既要比较hashCode又利用equals比较呢？</p>
<ul>
<li>
<p>hashCode是为了提高效率，减少可能的比较</p>
</li>
<li>
<p>而equals是为了防止哈希冲突，例如</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">BM</span></span><br></pre></td></tr></table></figure>
<p>和</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C.</span><br></pre></td></tr></table></figure>
<p>这两个字符串的hashCode值都是2123，例如下面的代码</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">JAVA</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">choose</span>(<span class="params">String str</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (str) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;BM&quot;</span>: &#123;</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">&quot;h&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;C.&quot;</span>: &#123;</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">&quot;w&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>会被编译器转换为</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">JAVA</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">choose</span>(<span class="params">String str</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">byte</span> x = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">switch</span> (str.hashCode()) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2123</span>:                  <span class="comment">// hashCode 值可能相同，需要进一步用 equals 比较</span></span><br><span class="line">            <span class="keyword">if</span> (str.<span class="keyword">equals</span>(<span class="string">&quot;C.&quot;</span>)) &#123;</span><br><span class="line">                x = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str.<span class="keyword">equals</span>(<span class="string">&quot;BM&quot;</span>)) &#123;</span><br><span class="line">                x = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="literal">default</span>:</span><br><span class="line">            <span class="keyword">switch</span> (x) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                    System.<span class="keyword">out</span>.println(<span class="string">&quot;h&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    System.<span class="keyword">out</span>.println(<span class="string">&quot;w&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="switch枚举">switch枚举</h2>
<ul>
<li>
<p>switch枚举的例子，原始代码</p>
<figure class="highlight thrift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Sex</span> </span>&#123;</span><br><span class="line">    MALE, FEMALE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">JAVA</span></span><br><span class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">foo</span>(<span class="params">Sex sex</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (sex)&#123;</span><br><span class="line">        <span class="keyword">case</span> MALE:</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> FEMALE:</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">&quot;女&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>转换后的代码</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy08</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 定义一个合成类（仅 jvm 使用，对我们不可见）</span></span><br><span class="line"><span class="comment">     * 用来映射枚举的 ordinal 与数组元素的关系</span></span><br><span class="line"><span class="comment">     * 枚举的 ordinal 表示枚举对象的序号，从 0 开始</span></span><br><span class="line"><span class="comment">     * 即 MALE 的 ordinal()=0，FEMALE 的 ordinal()=1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">static</span> <span class="keyword">class</span> $MAP &#123;</span><br><span class="line">        <span class="comment">// 数组大小即为枚举元素个数，里面存储case用来对比的数字</span></span><br><span class="line">        <span class="type">static</span> <span class="type">int</span>[] map = <span class="keyword">new</span> <span class="type">int</span>[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        <span class="type">static</span> &#123;</span><br><span class="line">            map[Sex.MALE.<span class="built_in">ordinal</span>()] = <span class="number">1</span>;</span><br><span class="line">            map[Sex.FEMALE.<span class="built_in">ordinal</span>()] = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">foo</span><span class="params">(Sex sex)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> x = $MAP.map[sex.<span class="built_in">ordinal</span>()];</span><br><span class="line">        <span class="keyword">switch</span> (x) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                System.out.<span class="built_in">println</span>(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                System.out.<span class="built_in">println</span>(<span class="string">&quot;女&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="枚举类">枚举类</h2>
<ul>
<li>
<p>JDK 7 新增了枚举类，以前面的性别枚举为例</p>
<figure class="highlight thrift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Sex</span> </span>&#123;</span><br><span class="line">    MALE, FEMALE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>转换后的代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Sex</span> <span class="keyword">extends</span> <span class="title">Enum</span>&lt;<span class="title">Sex</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="keyword">final</span> Sex MALE;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="keyword">final</span> Sex FEMALE;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="keyword">final</span> Sex[] <span class="variable">$VALUES</span>;</span><br><span class="line">    <span class="built_in">static</span> &#123;</span><br><span class="line">        MALE = <span class="keyword">new</span> <span class="title class_">Sex</span>(<span class="string">&quot;MALE&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        FEMALE = <span class="keyword">new</span> <span class="title class_">Sex</span>(<span class="string">&quot;FEMALE&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$VALUES</span> = <span class="keyword">new</span> <span class="title class_">Sex</span>[]&#123;MALE, FEMALE&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sole constructor. Programmers cannot invoke this constructor.</span></span><br><span class="line"><span class="comment">     * It is for use by code emitted by the compiler in response to</span></span><br><span class="line"><span class="comment">     * enum type declarations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name    - The name of this enum constant, which is the identifier</span></span><br><span class="line"><span class="comment">     *                used to declare it.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordinal - The ordinal of this enumeration constant (its position</span></span><br><span class="line"><span class="comment">     *                in the enum declaration, where the initial constant is</span></span><br><span class="line"><span class="comment">     *                assigned</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_ invoke__">Sex</span>(String name, <span class="keyword">int</span> ordinal) &#123;</span><br><span class="line">        <span class="title function_ invoke__">super</span>(name, ordinal);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> Sex[] <span class="title function_ invoke__">values</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$VALUES</span>.<span class="keyword">clone</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> Sex <span class="title function_ invoke__">valueOf</span>(String name) &#123;</span><br><span class="line">        <span class="keyword">return</span> Enum.<span class="title function_ invoke__">valueOf</span>(Sex.<span class="keyword">class</span>, name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>Sex</code>被声明为一个<code>final</code>类，它继承了<code>Enum&lt;Sex&gt;</code>类，Enum是Java中定义枚举的抽象类。MALE和FEMALE是Sex类的两个枚举值，它们被定义为静态常量。</p>
</li>
<li>
<p>除此之外，还有一个私有的、<code>final</code>的<code>Sex</code>类型数组<code>$VALUES</code>，它用于存储Sex类的所有枚举值。在类的静态块中，<code>$VALUES</code>数组被初始化为一个包含<code>MALE</code>和<code>FEMALE</code>的数组。</p>
</li>
<li>
<p>构造函数<code>Sex(String name, int ordinal)</code>是私有的，这意味着无法在类的外部使用这个构造函数来创建<code>Sex</code>的实例。只有Java编译器生成的代码才能调用这个构造函数来创建Sex的实例。</p>
</li>
<li>
<p><code>values()</code>和<code>valueOf(String name)</code>是从Enum类继承的两个静态方法。<code>values()</code>方法返回一个包含Sex类所有枚举值的数组，<code>valueOf(String name)</code>方法返回指定名称的枚举值。</p>
</li>
<li>
<p>当我们使用MALE或者FEMALE时，其实底层调用的是<code>Enum.valueOf(Sex.class, &quot;MALE&quot;)</code>和<code>Enum.valueOf(Sex.class, &quot;FEMALE&quot;)</code></p>
</li>
</ul>
<h2 id="try-with-resources">try-with-resources</h2>
<ul>
<li>
<p>JDK 7 开始新增了对需要关闭的自愿处理的特殊语法 try-with-resources</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">try (资源变量 = 创建资源对象) &#123;</span><br><span class="line"></span><br><span class="line">&#125; <span class="built_in">catch</span>() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>其中资源对象需要实现AutoCloseable接口，例如InputStream、OutputStream、Connection、Statement、ResultSet等接口都实现了AuthCloseable接口，使用try-with-resources 可以不用写finally语句块，编译器会帮助我们生成关闭资源代码，例如</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Candy09</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (InputStream <span class="keyword">is</span> = <span class="keyword">new</span> FileInputStream(<span class="string">&quot;d:\\tmp.test&quot;</span>)) &#123;</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="keyword">is</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>会被编译器转换为</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Candy09</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Candy09</span>()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream <span class="keyword">is</span> = <span class="keyword">new</span> FileInputStream(<span class="string">&quot;d:\\tmp.txt&quot;</span>);</span><br><span class="line">            Throwable t = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.<span class="keyword">out</span>.println(<span class="keyword">is</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable e1) &#123;</span><br><span class="line">                <span class="comment">// t 是我们代码出现的异常</span></span><br><span class="line">                t = e1;</span><br><span class="line">                <span class="keyword">throw</span> e1;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="comment">// 判断了资源不为空</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">is</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// 如果我们代码有异常</span></span><br><span class="line">                    <span class="keyword">if</span> (t != <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="keyword">is</span>.close();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Throwable e2) &#123;</span><br><span class="line">                            <span class="comment">// 如果 close 出现异常，作为被压制异常添加</span></span><br><span class="line">                            t.addSuppressed(e2);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// 如果我们代码没有异常，close 出现的异常就是最后 catch 块中的 e</span></span><br><span class="line">                        <span class="keyword">is</span>.close();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>为什么要设计一个addSuppressed(Throwable e)（添加被压制异常）的方法呢？</p>
<ul>
<li>
<p>这是为了防止异常信息的丢失</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">MyResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyResource</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyResource</span> <span class="keyword">implements</span> <span class="title class_">AutoCloseable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;close 异常&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>输出如下，两个异常信息都不会丢失</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">java<span class="selector-class">.lang</span><span class="selector-class">.ArithmeticException</span>: / by zero</span><br><span class="line">    at com<span class="selector-class">.demo</span><span class="selector-class">.Test</span><span class="selector-class">.main</span>(Test<span class="selector-class">.java</span>:<span class="number">6</span>)</span><br><span class="line">    Suppressed: java<span class="selector-class">.lang</span><span class="selector-class">.Exception</span>: close 异常</span><br><span class="line">        at com<span class="selector-class">.demo</span><span class="selector-class">.MyResource</span><span class="selector-class">.close</span>(Test<span class="selector-class">.java</span>:<span class="number">14</span>)</span><br><span class="line">        at com<span class="selector-class">.demo</span><span class="selector-class">.Test</span><span class="selector-class">.main</span>(Test<span class="selector-class">.java</span>:<span class="number">7</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="方法重写时的桥接方法">方法重写时的桥接方法</h2>
<ul>
<li>
<p>方法重写时，对返回值分两种情况</p>
<ol>
<li>
<p>父类与子类的返回值完全一致</p>
</li>
<li>
<p>子类返回值可以是父类返回值的子类（比较绕口，直接看下面的例子来理解）</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JAVA</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    public <span class="type">Number</span> m() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">// 父类A方法的返回值是Number类型，子类B方法的返回值是Integer类型，Integer是Number的子类</span></span><br><span class="line">    public <span class="type">Integer</span> m() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>那么对于子类，编译器会做如下处理</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JAVA</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    public <span class="type">Integer</span> m() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此方法才是真正重写了父类 public Number m() 方法</span></span><br><span class="line">    public synthetic bridge <span class="type">Number</span> m() &#123;</span><br><span class="line">        <span class="comment">// 调用 public Integer m()</span></span><br><span class="line">        <span class="keyword">return</span> m();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>其中的桥接方法比较特殊，仅对Java虚拟机课件，并且与原来的public Integer m()没有命名冲突</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="匿名内部类">匿名内部类</h2>
<ul>
<li>
<p>原始Java代码</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy10</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        <span class="title class_">Runnable</span> runnable = <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">run</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title class_">System</span>.<span class="property">out</span>.<span class="title function_">println</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>转换后代码</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">JAVA</span></span><br><span class="line"><span class="comment">// 额外生成的类</span></span><br><span class="line">final <span class="keyword">class</span> <span class="title class_">Candy10$1</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="title class_">Candy10</span>$1() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">run</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">System</span>.<span class="property">out</span>.<span class="title function_">println</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy10</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">String</span>[] args</span>) &#123;</span><br><span class="line">        <span class="title class_">Runnable</span> runnable = <span class="keyword">new</span> <span class="title class_">Candy10</span>$1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>对于匿名内部类，它的底层实现是类似于普通内部类的，只不过没有命名而已。在生成匿名内部类的class文件时，Java编译器会自动为该类生成一个类名，在原始类名上加后缀<code>$1</code>，如果有多个匿名内部类，则<code>$2</code>、<code>$3</code>以此类推</p>
</li>
<li>
<p>引用局部变量的匿名内部类，原始Java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy11</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(<span class="keyword">final</span>  <span class="type">int</span> x)</span>&#123;</span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">runnable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ok&quot;</span> + x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>转换后代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="comment">// 额外生成的类</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Candy11$1</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="type">int</span> val$x;</span><br><span class="line">    Candy11$<span class="number">1</span>(<span class="type">int</span> x) &#123;</span><br><span class="line">        <span class="built_in">this</span>.val$x = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ok:&quot;</span> + <span class="built_in">this</span>.val$x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Candy11</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(<span class="keyword">final</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">runnable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Candy11$1</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>注意：这也解释了为什么匿名内部类引用局部变量时，局部变量必须为final的
<ul>
<li>因为在创建Candy$11对象时，将x的值赋给了val$x属性，所以x不应该再发生变化了</li>
<li>如果变化，那么$val$x属性没有机会再跟着一起变化</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1>类加载阶段</h1>
<h2 id="加载">加载</h2>
<ul>
<li>将类的字节码载入方法区中，内部采用C++的instanceKlass描述Java类，它的重要field有
<ol>
<li>_java_mirror：Java的类镜像，例如对String来说，就是String.class，作用是把klass暴露给Java使用</li>
<li>_super：父类</li>
<li>_fields：成员变量</li>
<li>_methods：方法</li>
<li>_constants：常量池</li>
<li>_class_loader：类加载器</li>
<li>_vtable：需方发表</li>
<li>_itable：接口方法表</li>
</ol>
</li>
<li>如果这个类还有父类没有加载，先加载父类</li>
<li>加载和链接可能是交替运行的
<ul>
<li>instanceKlass这样的<code>元数据</code>是存储在方法区（1.8后是在元空间内），但_java_mirror是存储在堆中</li>
<li>可以通过HSDB工具查看</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/09/ppHhCmn.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/09/ppHhCmn.png" alt="img"></a></p>
<h2 id="链接">链接</h2>
<ol>
<li>
<p>验证</p>
<ul>
<li>
<p>验证类是否符合JVM规范，安全性检查</p>
</li>
<li>
<p>使用支持二进制的编辑器修改HelloWorld.class的魔数</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ca</span> fe <span class="keyword">ba</span> <span class="keyword">be</span></span><br></pre></td></tr></table></figure>
<p>，在控制台运行后悔报错</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">Error: A JNI error has occurred, please check your installation and try again</span><br><span class="line">Exception <span class="keyword">in</span> thread <span class="string">&quot;main&quot;</span> java<span class="selector-class">.lang</span><span class="selector-class">.ClassFormatError</span>: Incompatible magic value <span class="number">3405691578</span> <span class="keyword">in</span> class file cn/itcast/jvm/t5/HelloWorld</span><br><span class="line">    at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.defineClass1</span>(Native Method)</span><br><span class="line">    at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.defineClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">763</span>)</span><br><span class="line">    at java<span class="selector-class">.security</span><span class="selector-class">.SecureClassLoader</span><span class="selector-class">.defineClass</span>(SecureClassLoader<span class="selector-class">.java</span>:<span class="number">142</span>)</span><br><span class="line">    at java<span class="selector-class">.net</span><span class="selector-class">.URLClassLoader</span><span class="selector-class">.defineClass</span>(URLClassLoader<span class="selector-class">.java</span>:<span class="number">467</span>)</span><br><span class="line">    at java<span class="selector-class">.net</span><span class="selector-class">.URLClassLoader</span>.access$<span class="number">100</span>(URLClassLoader<span class="selector-class">.java</span>:<span class="number">73</span>)</span><br><span class="line">    at java<span class="selector-class">.net</span>.URLClassLoader$<span class="number">1</span><span class="selector-class">.run</span>(URLClassLoader<span class="selector-class">.java</span>:<span class="number">368</span>)</span><br><span class="line">    at java<span class="selector-class">.net</span>.URLClassLoader$<span class="number">1</span><span class="selector-class">.run</span>(URLClassLoader<span class="selector-class">.java</span>:<span class="number">362</span>)</span><br><span class="line">    at java<span class="selector-class">.security</span><span class="selector-class">.AccessController</span><span class="selector-class">.doPrivileged</span>(Native Method)</span><br><span class="line">    at java<span class="selector-class">.net</span><span class="selector-class">.URLClassLoader</span><span class="selector-class">.findClass</span>(URLClassLoader<span class="selector-class">.java</span>:<span class="number">361</span>)</span><br><span class="line">    at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.loadClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">424</span>)</span><br><span class="line">    at sun<span class="selector-class">.misc</span>.Launcher<span class="variable">$AppClassLoader</span><span class="selector-class">.loadClass</span>(Launcher<span class="selector-class">.java</span>:<span class="number">331</span>)</span><br><span class="line">    at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.loadClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">357</span>)</span><br><span class="line">    at sun<span class="selector-class">.launcher</span><span class="selector-class">.LauncherHelper</span><span class="selector-class">.checkAndLoadMain</span>(LauncherHelper<span class="selector-class">.java</span>:<span class="number">495</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>准备</p>
<ul>
<li>
<p>为static变量分配空间，设置默认值</p>
<ul>
<li>static变量在<code>JDK 7</code>之前存储于instanceKlass末尾，从<code>JDK 7</code>开始，存储于_java_mirror末尾</li>
<li>static变量分配空间和赋值是两个步骤，分配空间在准备阶段完成，赋值在初始化阶段完成</li>
<li>如果static遍历是final的基本类型以及字符串常量，那么编译阶段值就确定了，赋值在准备阶段完成</li>
<li>如果static遍历是final的，但属于引用类型，那么赋值也会在初始化阶段完成</li>
</ul>
</li>
<li>
<p>原始Java代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Load01</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">int</span> a;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">int</span> b = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> c = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">String</span> d = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">Object</span> e = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编译后的字节码文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">JAVA</span></span><br><span class="line"><span class="string">static</span> <span class="string">int</span> <span class="string">a;</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">I</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_STATIC</span></span><br><span class="line">  </span><br><span class="line"><span class="string">static</span> <span class="string">int</span> <span class="string">b;</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">I</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_STATIC</span></span><br><span class="line">  </span><br><span class="line"><span class="string">static</span> <span class="string">final</span> <span class="string">int</span> <span class="string">c;</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">I</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_STATIC,</span> <span class="string">ACC_FINAL</span></span><br><span class="line">  <span class="attr">ConstantValue:</span> <span class="string">int</span> <span class="number">20</span></span><br><span class="line">  </span><br><span class="line"><span class="string">static</span> <span class="string">final</span> <span class="string">java.lang.String</span> <span class="string">d;</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">Ljava/lang/String;</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_STATIC,</span> <span class="string">ACC_FINAL</span></span><br><span class="line">  <span class="attr">ConstantValue:</span> <span class="string">String</span> <span class="string">Hello</span></span><br><span class="line">  </span><br><span class="line"><span class="string">static</span> <span class="string">final</span> <span class="string">java.lang.Object</span> <span class="string">e;</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">Ljava/lang/Object;</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_STATIC,</span> <span class="string">ACC_FINAL</span></span><br><span class="line">  </span><br><span class="line"><span class="string">public</span> <span class="string">com.demo.Load01();</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">()V</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_PUBLIC</span></span><br><span class="line">  <span class="attr">Code:</span></span><br><span class="line">    <span class="string">stack=1,</span> <span class="string">locals=1,</span> <span class="string">args_size=1</span></span><br><span class="line">       <span class="attr">0:</span> <span class="string">aload_0</span></span><br><span class="line">       <span class="attr">1:</span> <span class="string">invokespecial</span> <span class="comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">       <span class="attr">4:</span> <span class="string">return</span></span><br><span class="line">    <span class="attr">LineNumberTable:</span></span><br><span class="line">      <span class="attr">line 5:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">LocalVariableTable:</span></span><br><span class="line">      <span class="string">Start</span>  <span class="string">Length</span>  <span class="string">Slot</span>  <span class="string">Name</span>   <span class="string">Signature</span></span><br><span class="line">          <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="string">this</span>   <span class="string">Lcom/demo/Load01;</span></span><br><span class="line">  </span><br><span class="line"><span class="string">static</span> &#123;&#125;<span class="string">;</span></span><br><span class="line">  <span class="attr">descriptor:</span> <span class="string">()V</span></span><br><span class="line">  <span class="attr">flags:</span> <span class="string">ACC_STATIC</span></span><br><span class="line">  <span class="attr">Code:</span></span><br><span class="line">    <span class="string">stack=2,</span> <span class="string">locals=0,</span> <span class="string">args_size=0</span></span><br><span class="line">       <span class="attr">0:</span> <span class="string">bipush</span>        <span class="number">10</span></span><br><span class="line">       <span class="attr">2:</span> <span class="string">putstatic</span>     <span class="comment">#2                  // Field b:I</span></span><br><span class="line">       <span class="attr">5:</span> <span class="string">new</span>           <span class="comment">#3                  // class java/lang/Object</span></span><br><span class="line">       <span class="attr">8:</span> <span class="string">dup</span></span><br><span class="line">       <span class="attr">9:</span> <span class="string">invokespecial</span> <span class="comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">      <span class="attr">12:</span> <span class="string">putstatic</span>     <span class="comment">#4                  // Field e:Ljava/lang/Object;</span></span><br><span class="line">      <span class="attr">15:</span> <span class="string">return</span></span><br><span class="line">    <span class="attr">LineNumberTable:</span></span><br><span class="line">      <span class="attr">line 7:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">line 10:</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>变量a和b都是静态变量，但是只有变量b被赋予了初始值10，赋值操作在初始化阶段体现，也就是在 static 块中实现</p>
</li>
<li>
<p>变量c和d都被声明为静态final变量，它们的值在编译时就已经确定了，分别是20和”Hello”，并且在字节码中使用了 ConstantValue 指令来指定这些常量的值。</p>
</li>
<li>
<p>变量e也是静态final变量，但它是一个引用类型变量，因此在初始化阶段才会被赋值，也就是在 static 块中实现。</p>
</li>
</ul>
</li>
<li>
<p>解析</p>
<ul>
<li>
<p>将常量池中的符号引用解析为直接引用</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Load02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) throws ClassNotFoundException, IOException &#123;</span><br><span class="line">        ClassLoader classloader = Load02.<span class="keyword">class</span>.getClassLoader();</span><br><span class="line">        <span class="comment">// loadClass 方法不会导致类的解析和初始化</span></span><br><span class="line">        Class&lt;?&gt; c = classloader.loadClass(<span class="string">&quot;com.demo.C&quot;</span>);</span><br><span class="line">        <span class="comment">// new C();</span></span><br><span class="line">        System.<span class="keyword">in</span>.read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">    D d = <span class="keyword">new</span> D();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>默认情况下，类的加载都是懒惰式的，如果用到了类C，没有用到类D的话，那么类D是不会主动加载的</p>
</li>
<li>
<p>使用loadClass方法不会导致类的解析和初始化</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/09/ppHo4r4.png" alt="img"></p>
<ul>
<li>可以看到类D现在是<code>UnresolvedClass</code>，也就是未经解析的类，在常量池中仅仅是一个符号</li>
</ul>
</li>
<li>
<p>使用new C()的方式会导致类的解析和初始化</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/09/ppHoqG6.png" alt="img"></p>
<ul>
<li>可以看到此时类D已经加载成功了，同时在类C的常量池中也可以解析类D的地址</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="初始化">初始化</h2>
<ul>
<li>
<p>初始化即调用<code>&lt;cinit&gt;()V</code> 方法，虚拟机ui保证这个类的<code>构造方法</code>的线程安全</p>
</li>
<li>
<p>发生的时机：总的来说，类的初始化是懒惰的</p>
<ol>
<li>
<p>main方法所在的类，总会被首先初始化</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Load03</span> &#123;</span><br><span class="line">    <span class="type">static</span> &#123;</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(<span class="type">String</span>[] args)</span> throws ClassNotFoundException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台会输出</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">main <span class="keyword">init</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>首次访问这个类的静态变量或静态方法时，会进行初始化</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Load03</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) throws ClassNotFoundException</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(A.a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">A</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">main <span class="keyword">init</span></span><br><span class="line">a <span class="keyword">init</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>子类初始化，如果父类还没未初始化，则父类也会进行初始化</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Load03 &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(B.c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> A &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> B <span class="keyword">extends</span> A &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">double</span> b = <span class="number">5.0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">boolean</span> c = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;b init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">main <span class="keyword">init</span></span><br><span class="line">a <span class="keyword">init</span></span><br><span class="line">b <span class="keyword">init</span></span><br><span class="line"><span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>默认的Class.forName会导致初始化</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Load03 &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="keyword">Class</span>.forName(<span class="string">&quot;com.demo.A&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> A &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">main <span class="keyword">init</span></span><br><span class="line">a <span class="keyword">init</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>new对象会导致初始化</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Load03</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) throws ClassNotFoundException</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> A();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">A</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">main <span class="keyword">init</span></span><br><span class="line">a <span class="keyword">init</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>不会导致类初始化的情况</p>
<ol>
<li>
<p>访问类的 static final 静态常量（基本类型和字符串） 不会触发初始化</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Load03 &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(B.b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> A &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> B <span class="keyword">extends</span> A &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">double</span> b = <span class="number">5.0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">boolean</span> c = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;b init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute">main</span> init</span><br><span class="line"><span class="attribute">5</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>调用类对象.class不会触发初始化</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Load03 &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(B.<span class="keyword">class</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> A &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> B <span class="keyword">extends</span> A &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">double</span> b = <span class="number">5.0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">boolean</span> c = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;b init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">main <span class="keyword">init</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">com</span>.<span class="title">demo</span>.<span class="title">B</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>类加载器的loadClass方法不会触发初始化</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Load03 &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();</span><br><span class="line">        classLoader.loadClass(<span class="string">&quot;com.demo.B&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> A &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> B <span class="keyword">extends</span> A &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">double</span> b = <span class="number">5.0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">boolean</span> c = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;b init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">main <span class="keyword">init</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>Class.forName的参数2为false时(initalize = false)，不会触发初始化</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Load03 &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;main init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();</span><br><span class="line">        <span class="keyword">Class</span>.forName(<span class="string">&quot;com.demo.A&quot;</span>, <span class="keyword">false</span>, classLoader);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> A &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">&quot;a init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>控制台输出</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line">main <span class="keyword">init</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="练习">练习</h2>
<ul>
<li>
<p>从字节码分析，使用a、b、c这三个常量，是否会导致E初始化</p>
<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Load04 &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(E.a);</span><br><span class="line">        System.<span class="keyword">out</span>.println(E.b);</span><br><span class="line">        System.<span class="keyword">out</span>.println(E.c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> E &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String b = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer c = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">&quot;init E&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>结论：a和b不会导致E的初始化，c会导致E的初始化</p>
</li>
<li>
<p>a和b是基本类型和字符串常量，而c是包装类型，其底层还需要调用Integer.valueOf()方法来装箱，只能推迟到初始化阶段运行，字节码如下</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">JAVA</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">public</span> <span class="string">static</span> <span class="string">final</span> <span class="string">int</span> <span class="string">a;</span></span><br><span class="line">    <span class="attr">descriptor:</span> <span class="string">I</span></span><br><span class="line">    <span class="attr">flags:</span> <span class="string">ACC_PUBLIC</span>, <span class="string">ACC_STATIC</span>, <span class="string">ACC_FINAL</span></span><br><span class="line">    <span class="attr">ConstantValue:</span> <span class="string">int</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="string">public</span> <span class="string">static</span> <span class="string">final</span> <span class="string">java.lang.String</span> <span class="string">b;</span></span><br><span class="line">    <span class="attr">descriptor:</span> <span class="string">Ljava/lang/String;</span></span><br><span class="line">    <span class="attr">flags:</span> <span class="string">ACC_PUBLIC</span>, <span class="string">ACC_STATIC</span>, <span class="string">ACC_FINAL</span></span><br><span class="line">    <span class="attr">ConstantValue:</span> <span class="string">String</span> <span class="string">hello</span></span><br><span class="line"></span><br><span class="line">  <span class="string">public</span> <span class="string">static</span> <span class="string">final</span> <span class="string">java.lang.Integer</span> <span class="string">c;</span></span><br><span class="line">    <span class="attr">descriptor:</span> <span class="string">Ljava/lang/Integer;</span></span><br><span class="line">    <span class="attr">flags:</span> <span class="string">ACC_PUBLIC</span>, <span class="string">ACC_STATIC</span>, <span class="string">ACC_FINAL</span></span><br><span class="line"></span><br><span class="line">  <span class="string">com.demo.E();</span></span><br><span class="line">    <span class="attr">descriptor:</span> <span class="string">()V</span></span><br><span class="line">    <span class="attr">flags:</span></span><br><span class="line">    <span class="attr">Code:</span></span><br><span class="line">      <span class="string">stack=1</span>, <span class="string">locals=1</span>, <span class="string">args_size=1</span></span><br><span class="line">         <span class="attr">0:</span> <span class="string">aload_0</span></span><br><span class="line">         <span class="attr">1:</span> <span class="string">invokespecial</span> <span class="comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="attr">4:</span> <span class="string">return</span></span><br><span class="line">      <span class="attr">LineNumberTable:</span></span><br><span class="line">        <span class="attr">line 10:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">LocalVariableTable:</span></span><br><span class="line">        <span class="string">Start</span>  <span class="string">Length</span>  <span class="string">Slot</span>  <span class="string">Name</span>   <span class="string">Signature</span></span><br><span class="line">            <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="string">this</span>   <span class="string">Lcom/demo/E;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">static</span> &#123;&#125;<span class="string">;</span></span><br><span class="line">    <span class="attr">descriptor:</span> <span class="string">()V</span></span><br><span class="line">    <span class="attr">flags:</span> <span class="string">ACC_STATIC</span></span><br><span class="line">    <span class="attr">Code:</span></span><br><span class="line">      <span class="string">stack=2</span>, <span class="string">locals=0</span>, <span class="string">args_size=0</span></span><br><span class="line">         <span class="attr">0:</span> <span class="string">bipush</span>        <span class="number">20</span></span><br><span class="line">         <span class="attr">2:</span> <span class="string">invokestatic</span>  <span class="comment">#2                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">         <span class="attr">5:</span> <span class="string">putstatic</span>     <span class="comment">#3                  // Field c:Ljava/lang/Integer;</span></span><br><span class="line">         <span class="attr">8:</span> <span class="string">getstatic</span>     <span class="comment">#4                  // Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">        <span class="attr">11:</span> <span class="string">ldc</span>           <span class="comment">#5                  // String init E</span></span><br><span class="line">        <span class="attr">13:</span> <span class="string">invokevirtual</span> <span class="comment">#6                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">        <span class="attr">16:</span> <span class="string">return</span></span><br><span class="line">      <span class="attr">LineNumberTable:</span></span><br><span class="line">        <span class="attr">line 13:</span> <span class="number">0</span></span><br><span class="line">        <span class="attr">line 15:</span> <span class="number">8</span></span><br><span class="line">        <span class="attr">line 16:</span> <span class="number">16</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>典型应用 -&gt; 完成懒惰初始化的单例模式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 内部类中保存单例</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LazyHolder</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 第一次调用 getInstance 方法，才会导致内部类加载和初始化其静态成员</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> LazyHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>以上的实现特点是：</p>
<ol>
<li>懒惰实例化</li>
<li>初始化时的线程安全是有保障的</li>
</ol>
</li>
</ul>
<h1>类加载器</h1>
<ul>
<li>以<code>JDK 8</code>为例</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">名称</th>
<th style="text-align:center">加载哪的类</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Bootstrap ClassLoader</td>
<td style="text-align:center">JAVA_HOME/jre/lib</td>
<td style="text-align:center">无法直接访问</td>
</tr>
<tr>
<td style="text-align:center">Extension ClassLoader</td>
<td style="text-align:center">JAVA_HOME/jre/lib/ext</td>
<td style="text-align:center">上级为 Bootstrap，显示为 null</td>
</tr>
<tr>
<td style="text-align:center">Application ClassLoader</td>
<td style="text-align:center">classpath</td>
<td style="text-align:center">上级为 Extension</td>
</tr>
<tr>
<td style="text-align:center">自定义类加载器</td>
<td style="text-align:center">自定义 上级为</td>
<td style="text-align:center">Application</td>
</tr>
</tbody>
</table>
<ul>
<li>当JVM需要加载一个类时，它会首先委托父类加载器去加载这个类，如果父类加载器无法加载这个类，就会由当前类加载器来加载。如果所有的父类加载器都无法加载这个类，那么就会抛出ClassNotFoundException异常。</li>
</ul>
<h2 id="引导类加载器">引导类加载器</h2>
<ul>
<li>
<pre><code>Bootstrap ClassLoader
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">是所有类加载器中最早的一个，负责加载JRE/<span class="keyword">lib</span>下的核心类库，如java.lang.<span class="type">Object</span>、java.lang.<span class="type">String</span>等。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
public class Load05 &#123;
    public static void main(String[] args) throws ClassNotFoundException &#123;
        Class&lt;?&gt; aClass = Class.forName(&quot;java.lang.Object&quot;);
        System.out.println(aClass.getClassLoader());
    &#125;
&#125;
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 输出的结果是<span class="literal">null</span>，因为引导类加载器是由JVM的实现者用C/C++等语言编写的，而不是由Java编写的。在Java虚拟机的实现中，引导类加载器不是Java对象，也没有对应的Java类，因此它的ClassLoader属性为<span class="literal">null</span>。</span><br><span class="line"></span><br><span class="line"><span class="meta">## 扩展类加载器</span></span><br><span class="line"></span><br><span class="line">- 编写一个Tmp类</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
public class Tmp &#123;
    static &#123;
        System.out.println(&quot;classpath Tmp init&quot;);
    &#125;
&#125;
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>加载Tmp类，并获取classLoader</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
public class Load06 &#123;
    public static void main(String[] args) throws ClassNotFoundException &#123;
        Class&lt;?&gt; aClass = Class.forName(&quot;com.demo.load.Tmp&quot;);
        System.out.println(aClass.getClassLoader());
    &#125;
&#125;
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>输出如下，可以看到此时是由应用类加载器加载的</span><br><span class="line"></span><br></pre></td></tr></table></figure>
PLAINTEXT
classpath Tmp init
sun.misc.Launcher$AppClassLoader@18b4aac2
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>那我们现在写一个同名的Tmp类，将输出内容改为</span><br><span class="line"></span><br></pre></td></tr></table></figure>
ext Tmp init
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
public class Tmp &#123;
    static &#123;
        System.out.println(&quot;ext Tmp init&quot;);
    &#125;
&#125;
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 将其打成一个jar包，放到JAVA_HOME<span class="regexp">/jre/</span>ext目录下</span><br><span class="line"></span><br></pre></td></tr></table></figure>
BASH
$ jar -cvf tmp.jar com/demo/load/Tmp.class
已添加清单
正在添加: Tmp.class(输入 = 479) (输出 = 321)(压缩了 32%)
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>重新执行Load06，输出结果如下</span><br><span class="line"></span><br></pre></td></tr></table></figure>
PLAINTEXT
ext Tmp init
sun.misc.Launcher$ExtClassLoader@29453f44
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">-</span> 此时就是从扩展类加载器加载的Tmp类了，因为当JVM需要加载一个类时，它会首先委托父类加载器去加载这个类</span><br><span class="line"></span><br><span class="line"><span class="section">## 双亲委派机制</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 所谓双亲委派机制，就是指调用类加载器的loadClass方法时，查找类的规则</span><br><span class="line"></span><br><span class="line">  感觉这个<span class="code">`双亲`</span>翻译成<span class="code">`上级`</span>更合适，因为它们之间并没有继承关系</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 我们来看看ClassLoader中的loadClass()方法的源码</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
protected Class&lt;?&gt; loadClass(String name, boolean resolve)
    throws ClassNotFoundException
&#123;
    synchronized (getClassLoadingLock(name)) &#123;
        // First, check if the class has already been loaded
        Class&lt;?&gt; c = findLoadedClass(name);
        if (c == null) &#123;
            long t0 = System.nanoTime();
            try &#123;
                if (parent != null) &#123;
                    c = parent.loadClass(name, false);
                &#125; else &#123;
                    c = findBootstrapClassOrNull(name);
                &#125;
            &#125; catch (ClassNotFoundException e) &#123;
                // ClassNotFoundException thrown if class not found
                // from the non-null parent class loader
            &#125;

            if (c == null) &#123;
                // If still not found, then invoke findClass in order
                // to find the class.
                long t1 = System.nanoTime();
                c = findClass(name);

                // this is the defining class loader; record the stats
                sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);
                sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);
                sun.misc.PerfCounter.getFindClasses().increment();
            &#125;
        &#125;
        if (resolve) &#123;
            resolveClass(c);
        &#125;
        return c;
    &#125;
&#125;
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>精简一下逻辑，双亲委派的核心思路如下</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
protected Class&lt;?&gt; loadClass(String name, boolean resolve) throws ClassNotFoundException &#123;
    synchronized (getClassLoadingLock(name)) &#123;
        // 检查类是否已经被加载
        Class&lt;?&gt; c = findLoadedClass(name);
        if (c == null) &#123;
            try &#123;
                // 如果类没有被加载，则委托给父ClassLoader加载
                if (parent != null) &#123;
                    c = parent.loadClass(name, false);
                &#125; else &#123;
                    c = findBootstrapClassOrNull(name);
                &#125;
            &#125; catch (ClassNotFoundException e) &#123;
                // 如果父ClassLoader加载失败，则在自身查找类
                c = findClass(name);
            &#125;
        &#125;
        if (resolve) &#123;
            resolveClass(c);
        &#125;
        return c;
    &#125;
&#125;
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 线程上下文类加载器</span><br><span class="line"></span><br><span class="line">- 我们在使用JDBC时，都需要加载Driver驱动，但是我们好像并没有显示的调用Class.forName来加载Driver类</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
Class.forName(&quot;com.mysql.jdbc.Driver&quot;);
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>那么实际上是如何加载这个驱动的呢？让我们来追踪一下源码，这里只看最核心的部分</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
public class DriverManager &#123;

    private final static CopyOnWriteArrayList&lt;DriverInfo&gt; registeredDrivers = new CopyOnWriteArrayList&lt;&gt;();

    ···

    static &#123;
        loadInitialDrivers();
        println(&quot;JDBC DriverManager initialized&quot;);
    &#125;

    ···

&#125;
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>我们试着输出一下DirverManager的类加载器是谁</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
System.out.println(DriverManager.class.getClassLoader());
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 输出的结果是`null`，那么说明它是由`Bootstrap ClassLoader`加载的，那么按理说应该是去`JAV<span class="built_in">A_HOMT</span>/jre/lib`下搜索驱动类。</span><br><span class="line"></span><br><span class="line">- 但`JAV<span class="built_in">A_HOMT</span>/jre/lib`显然没有mysql-connector-java-<span class="number">5.7</span>.<span class="number">31</span>.jar包，在DriverManager的静态代码块中，是如何正确加载`com.mysql.jdbc.Driver`的呢？</span><br><span class="line"></span><br><span class="line">- 继续来看看loadInitialDrivers()方法的源码</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
private static void loadInitialDrivers() &#123;
    String drivers;
    try &#123;
        drivers = AccessController.doPrivileged(new PrivilegedAction&lt;String&gt;() &#123;
            public String run() &#123;
                return System.getProperty(&quot;jdbc.drivers&quot;);
            &#125;
        &#125;);
    &#125; catch (Exception ex) &#123;
        drivers = null;
    &#125;
    // If the driver is packaged as a Service Provider, load it.
    // Get all the drivers through the classloader
    // exposed as a java.sql.Driver.class service.
    // ServiceLoader.load() replaces the sun.misc.Providers()

    // 1. 使用 ServiceLoader 机制加载驱动，即 SPI
    AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() &#123;
        public Void run() &#123;

            ServiceLoader&lt;Driver&gt; loadedDrivers = ServiceLoader.load(Driver.class);
            Iterator&lt;Driver&gt; driversIterator = loadedDrivers.iterator();

            /* Load these drivers, so that they can be instantiated.
             * It may be the case that the driver class may not be there
             * i.e. there may be a packaged driver with the service class
             * as implementation of java.sql.Driver but the actual class
             * may be missing. In that case a java.util.ServiceConfigurationError
             * will be thrown at runtime by the VM trying to locate
             * and load the service.
             *
             * Adding a try catch block to catch those runtime errors
             * if driver not available in classpath but it's
             * packaged as service and that service is there in classpath.
             */
            try&#123;
                while(driversIterator.hasNext()) &#123;
                    driversIterator.next();
                &#125;
            &#125; catch(Throwable t) &#123;
            // Do nothing
            &#125;
            return null;
        &#125;
    &#125;);

    println(&quot;DriverManager.initialize: jdbc.drivers = &quot; + drivers);

    // 2. 使用 jdbc.drivers 定义的驱动名加载驱动
    if (drivers == null || drivers.equals(&quot;&quot;)) &#123;
        return;
    &#125;
    String[] driversList = drivers.split(&quot;:&quot;);
    println(&quot;number of Drivers:&quot; + driversList.length);
    for (String aDriver : driversList) &#123;
        try &#123;
            println(&quot;DriverManager.Initialize: loading &quot; + aDriver);
            Class.forName(aDriver, true,
                    ClassLoader.getSystemClassLoader());
        &#125; catch (Exception ex) &#123;
            println(&quot;DriverManager.Initialize: load failed: &quot; + ex);
        &#125;
    &#125;
&#125;
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 先看<span class="number">2</span>，它最后是使用的Class.forName完成类的加载和初始化，关联的是应用类加载器，因此可以顺利完成驱动类的加载</span><br><span class="line"></span><br><span class="line">- 在看<span class="number">1</span>，它就是大名鼎鼎的Service Provider Interface（SPI）</span><br><span class="line"></span><br><span class="line">  - 约定如下，在jar包的META-INF/services包下，以接口全限定名名为文件，文件内容是实现类名称</span><br><span class="line">    [![img](https:<span class="regexp">//img</span>se.com<span class="regexp">/i/</span>ppqEGM8)](https:<span class="regexp">//img</span>se.com<span class="regexp">/i/</span>ppqEGM8)</span><br><span class="line"></span><br><span class="line">  - 这样就可以使用如下代码遍历来得到实现类</span><br><span class="line"></span><br></pre></td></tr></table></figure>
  JAVA
  ServiceLoader&lt;接口类型&gt; allImpls = ServiceLoader.load(接口类型.class);
  Iterator&lt;接口类型&gt; iter = allImpls.iterator();
  while(iter.hasNext())&#123;
      iter.next();
  &#125;
  <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>体现的是</span><br><span class="line"></span><br></pre></td></tr></table></figure>
  面向接口编程 + 解耦
  <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  的思想，在下面的一些框架中都运用了此思想</span><br><span class="line"></span><br><span class="line"><span class="bullet">  -</span> JDBC</span><br><span class="line"><span class="bullet">  -</span> Servlet初始化器</span><br><span class="line"><span class="bullet">  -</span> Spring容器</span><br><span class="line"><span class="bullet">  -</span> Dubbo（对SPI进行了扩展）</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 接着看ServiceLoader.load方法</span><br><span class="line"></span><br></pre></td></tr></table></figure>
  JAVA
  public static &lt;S&gt; ServiceLoader&lt;S&gt; load(Class&lt;S&gt; service) &#123;
      ClassLoader cl = Thread.currentThread().getContextClassLoader();
      return ServiceLoader.load(service, cl);
  &#125;
  <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>线程上下文类加载器是当前线程使用的类加载器，默认就是应用类加载器，它内部又是由Class.forName调用了线程上下文类加载器完成类加载，具体代码在ServiceLoader的内部类LazyIterator中</span><br><span class="line"></span><br></pre></td></tr></table></figure>
  JAVA
  private class LazyIterator
      implements Iterator&lt;S&gt;
  &#123;
  
      Class&lt;S&gt; service;
      ClassLoader loader;
      Enumeration&lt;URL&gt; configs = null;
      Iterator&lt;String&gt; pending = null;
      String nextName = null;
  
      private LazyIterator(Class&lt;S&gt; service, ClassLoader loader) &#123;
          this.service = service;
          this.loader = loader;
      &#125;
  
      private boolean hasNextService() &#123;
          if (nextName != null) &#123;
              return true;
          &#125;
          if (configs == null) &#123;
              try &#123;
                  String fullName = PREFIX + service.getName();
                  if (loader == null)
                      configs = ClassLoader.getSystemResources(fullName);
                  else
                      configs = loader.getResources(fullName);
              &#125; catch (IOException x) &#123;
                  fail(service, &quot;Error locating configuration files&quot;, x);
              &#125;
          &#125;
          while ((pending == null) || !pending.hasNext()) &#123;
              if (!configs.hasMoreElements()) &#123;
                  return false;
              &#125;
              pending = parse(service, configs.nextElement());
          &#125;
          nextName = pending.next();
          return true;
      &#125;
  
      private S nextService() &#123;
          if (!hasNextService())
              throw new NoSuchElementException();
          String cn = nextName;
          nextName = null;
          Class&lt;?&gt; c = null;
          try &#123;
              c = Class.forName(cn, false, loader);
          &#125; catch (ClassNotFoundException x) &#123;
              fail(service,
                   &quot;Provider &quot; + cn + &quot; not found&quot;);
          &#125;
          if (!service.isAssignableFrom(c)) &#123;
              fail(service,
                   &quot;Provider &quot; + cn  + &quot; not a subtype&quot;);
          &#125;
          try &#123;
              S p = service.cast(c.newInstance());
              providers.put(cn, p);
              return p;
          &#125; catch (Throwable x) &#123;
              fail(service,
                   &quot;Provider &quot; + cn + &quot; could not be instantiated&quot;,
                   x);
          &#125;
          throw new Error();          // This cannot happen
      &#125;
  
      public boolean hasNext() &#123;
          if (acc == null) &#123;
              return hasNextService();
          &#125; else &#123;
              PrivilegedAction&lt;Boolean&gt; action = new PrivilegedAction&lt;Boolean&gt;() &#123;
                  public Boolean run() &#123; return hasNextService(); &#125;
              &#125;;
              return AccessController.doPrivileged(action, acc);
          &#125;
      &#125;
  
      public S next() &#123;
          if (acc == null) &#123;
              return nextService();
          &#125; else &#123;
              PrivilegedAction&lt;S&gt; action = new PrivilegedAction&lt;S&gt;() &#123;
                  public S run() &#123; return nextService(); &#125;
              &#125;;
              return AccessController.doPrivileged(action, acc);
          &#125;
      &#125;
  
      public void remove() &#123;
          throw new UnsupportedOperationException();
      &#125;
  
  &#125;
  <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section">## 自定义类加载器</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 先来思考一下：什么时候需要自定义类加载器</span><br><span class="line"></span><br><span class="line"><span class="bullet">  1.</span> 自定义类加载器可用于加载非 Classpath 路径中的类文件，例如外部配置文件夹、网络资源或其他自定义路径。这种需求在一些动态扩展或插件化的场景中比较常见。</span><br><span class="line"><span class="bullet">  2.</span> 在应用程序中使用的类可以通过接口来使用，而不是直接引用类。这种做法可以减少应用程序之间的依赖，从而提高代码的灵活性和可维护性。同时，这种做法也使得框架的设计更加清晰和可扩展。</span><br><span class="line"><span class="bullet">  3.</span> 在Tomcat容器中，每个Web应用程序都使用自己的类加载器，从而避免了不同Web应用程序之间的类冲突问题。</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 步骤</span><br><span class="line"></span><br><span class="line"><span class="bullet">  1.</span> 继承ClassLoader类</span><br><span class="line"><span class="bullet">  2.</span> 遵从双亲委派机制，重写findClass方法</span><br><span class="line"><span class="bullet">     -</span> 注意不要重写loadClass方法，否则不会走双亲委派机制</span><br><span class="line"><span class="bullet">  3.</span> 读取类文件的字节码</span><br><span class="line"><span class="bullet">  4.</span> 调用父类的defineClass方法来加载类</span><br><span class="line"><span class="bullet">  5.</span> 使用者调用类加载器的loadClass方法</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 示例</span><br><span class="line"></span><br><span class="line"><span class="bullet">  1.</span> 准备一个Tmp类，编译后将其.class文件放至D盘根目录下</span><br><span class="line"></span><br></pre></td></tr></table></figure>
   JAVA
   package myclasspath;
   
   public class Tmp &#123;
       static &#123;
           System.out.println(&quot;init myclasspath.Tmp&quot;);
       &#125;
   
       public static void main(String[] args) &#123;
           System.out.println();
       &#125;
   &#125;
   <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">2.</span> 自定义MyClassLoader类</span><br><span class="line"></span><br></pre></td></tr></table></figure>
   JAVA
   class MyClassLoader extends ClassLoader &#123;
       @Override
       protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException &#123;
           String path = &quot;D:\\myclasspath\\&quot; + name + &quot;.class&quot;;
           try &#123;
               ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
               Files.copy(Paths.get(path), outputStream);
               byte[] bytes = outputStream.toByteArray();
               return defineClass(name, bytes, 0, bytes.length);
           &#125; catch (IOException e) &#123;
               e.printStackTrace();
               throw new ClassNotFoundException(&quot;类文件未找到:&quot; + e);
           &#125;
       &#125;
   &#125;
   <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">3.</span> 调用自定义的类加载器loadClass方法来加载Tmp类</span><br><span class="line"></span><br></pre></td></tr></table></figure>
   JAVA
   public class Load07 &#123;
       public static void main(String[] args) throws Exception &#123;
           MyClassLoader classLoader = new MyClassLoader();
           Class&lt;?&gt; aClass = classLoader.loadClass(&quot;myclasspath.Tmp&quot;);
           aClass.newInstance();
       &#125;
   &#125;
   <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>控制台输出如下，成功加载Tmp类</span><br><span class="line"></span><br></pre></td></tr></table></figure>
  PLAINTEXT
  init myclasspath.Tmp
  <figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 运行期优化</span><br><span class="line"></span><br><span class="line">## 即时编译</span><br><span class="line"></span><br><span class="line">### 分层编译（TieredComlilation）</span><br><span class="line"></span><br><span class="line">- 先来举个例子</span><br><span class="line"></span><br></pre></td></tr></table></figure>
JAVA
public class JIT1 &#123;
    public static void main(String[] args) &#123;
        for (int i = 0; i &lt; 200; i++) &#123;
            long start = System.nanoTime();
            for (int j = 0; j &lt; 1000; j++) &#123;
                new Object();
            &#125;
            long end = System.nanoTime();
            System.out.printf(&quot;%d\t%d\n&quot;, i, (end - start));
        &#125;
    &#125;
&#125;
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">- </span>输出结果如下</span><br><span class="line"></span><br></pre></td></tr></table></figure>
PLAINTEXT
0	28300
1	27700
2	28500
3	26400
4	26400
5	26700
6	27200
7	27800
8	26200
9	26000
10	26200
11	28500
12	42900
13	26900
14	26900
15	26000
16	28300
17	25500
18	28500
19	26500
20	26100
21	27300
22	26600
23	26100
24	28300
25	25000
26	26400
27	26000
28	26500
29	26700
30	26400
31	26400
32	26100
33	26600
34	26300
35	26300
36	37600
37	26400
38	26000
39	28500
40	31700
41	43700
42	27000
43	26200
44	25600
45	30400
46	26400
47	26200
48	33800
49	26700
50	27700
51	26300
52	34100
53	26300
54	37400
55	33700
56	25100
57	28200
58	26000
59	41300
60	33500
61	26500
62	26300
63	26200
64	26500
65	26100
66	26300
67	26500
68	28800
69	26400
70	27100
71	27700
72	26500
73	16300
74	7000
75	8900
76	8800
77	13500
78	8300
79	9000
80	11900
81	9300
82	11700
83	9400
84	7700
85	10200
86	8800
87	6100
88	7300
89	7000
90	7200
91	5800
92	7100
93	7800
94	6800
95	5900
96	7300
97	6800
98	6900
99	5900
100	6800
101	8100
102	6700
103	6100
104	6700
105	6900
106	6700
107	5700
108	7100
109	13000
110	7000
111	6000
112	6700
113	7300
114	6700
115	6000
116	6700
117	6700
118	11400
119	5900
120	7000
121	6900
122	8400
123	6700
124	10100
125	9900
126	11500
127	8300
128	6700
129	7000
130	7000
131	6900
132	7500
133	6800
134	7800
135	7400
136	7000
137	7000
138	7000
139	7000
140	7100
141	7100
142	11400
143	10100
144	6800
145	7100
146	6800
147	6700
148	7000
149	6600
150	6600
151	6800
152	6700
153	9400
154	5700
155	7100
156	6600
157	7100
158	6000
159	7800
160	11800
161	6800
162	5800
163	6700
164	6600
165	7100
166	6800
167	7900
168	7000
169	10100
170	6900
171	6600
172	7200
173	10000
174	6700
175	51100
176	14900
177	300
178	300
179	300
180	300
181	300
182	300
183	300
184	200
185	300
186	200
187	200
188	300
189	300
190	300
191	300
192	300
193	300
194	300
195	300
196	300
197	200
198	300
199	300
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">-</span> 可以看到循环到73次附近时，速度明显加快了，循环到178次时，速度又明显加快了，这是为什么呢？</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> JVM将执行状态分为5个层次</span><br><span class="line"></span><br><span class="line"><span class="bullet">  1.</span> <span class="code">```</span></span><br><span class="line"><span class="code">     0层</span></span><br></pre></td></tr></table></figure>

   ：解释执行（Interpreter）

   - 在0层，JVM使用解释器来直接解释Java字节码，并执行程序。这种方式简单但效率较低，因为解释器需要逐条解释字节码指令，并执行它们，每次执行时都需要对字节码进行解析

2. ```
   1层
   <figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   ：使用<span class="built_in">C1</span>即时编译器编译执行（不带profilling）</span><br><span class="line"></span><br><span class="line">   - 在<span class="number">1</span>层，JVM会使用即时编译器（JIT）将Java字节码编译成本地机器码，然后直接执行机器码。这种方式相比于解释器，可以提供更高的执行速度。<span class="built_in">C1</span>即时编译器适合编译执行热点代码，即被频繁执行的代码</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>. ```</span><br><span class="line">   <span class="number">2</span>层</span><br></pre></td></tr></table></figure>

   ：使用C1即时编译器编译执行（带基本的profilling）

   - 在2层，JVM会收集一些基本的执行状态数据，即profilling。例如方法的调用次数、循环的回边次数等，然后根据这些数据来决定哪些代码块需要被编译执行。这种方式可以更加精确地编译热点代码，从而提高程序的执行速度

4. ```
   3层
   <figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   ：使用C1即时编译器编译执行（带完全的profilling）</span><br><span class="line"></span><br><span class="line">   - 在<span class="number">3</span>层，JVM会收集更加详细的执行状态数据，例如内联调用的次数、方法的参数类型等，以便更好地优化代码。这种方式可以进一步提高程序的执行速度，但同时也会增加编译的开销</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>. ```</span><br><span class="line">   <span class="number">4</span>层</span><br></pre></td></tr></table></figure>

   ：使用C2即时编译器编译执行

   - 在4层，JVM会使用更高级别的即时编译器（C2）来对代码进行优化，包括对循环、分支和递归等结构的优化。C2编译器的编译时间比C1场，但编译出来的代码执行速度更快。

     profilling是指在运行过程中手机一些程序执行的状态数据，例如`方法的调用次数`、`循环的回边次数`

</code></pre>
</li>
<li>
<p>即时编译器（JIT）和解释器的区别</p>
<ul>
<li>解释器是将字节码解释为机器码，下次即使遇到相同的字节码，仍会执行重复的解释</li>
<li>JIT是将一些字节码编译为机器码，并存入<code>Code Cache</code>，下次遇到相同的代码，<code>直接执行</code>，无需再次编译</li>
<li>解释器是将字节码解释为针对所有平台都通用的机器码</li>
<li>JIT会根据平台类型，生成平台特定的机器码</li>
</ul>
</li>
<li>
<p>对于占据大部分的不常用的代码，我们无需耗费时间将其编译成<code>机器码</code>，而是采用<code>解释器执行</code>的方法运行；</p>
</li>
<li>
<p>另一方面，对于仅占据小部分的热点代码，我们则可以将其编译成<code>机器码</code>，以达到理想的运行<code>速度</code>。</p>
</li>
<li>
<p>执行效率上简单比较一下：<code>Interceptor &lt; C1 &lt; C2</code></p>
</li>
<li>
<p>上面代码中最后的耗时都在</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">300</span><br></pre></td></tr></table></figure>
<p>附近，这是C2即时编译器做了逃逸分析，因为上面的代码中，我们仅仅是</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">创建</span><br></pre></td></tr></table></figure>
<p>了Object对象，而并没有</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用</span><br></pre></td></tr></table></figure>
<p>它，也就是没有</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">逃逸</span><br></pre></td></tr></table></figure>
<p>出当前作用域</p>
<ul>
<li>在进行逃逸分析时，JVM会分析对象是否可能被线程外的代码引用，如果对象不会逃逸出当前方法的作用域，那么JVM会将对象的分配<code>优化为栈上分配</code>，从而避免了堆内存的分配和垃圾回收的压力。</li>
</ul>
</li>
<li>
<p>将对象分配在栈上的</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">优点</span><br></pre></td></tr></table></figure>
<p>是：</p>
<ol>
<li><code>快速分配和回收</code>：栈内存的分配和回收都非常快，比堆内存要快得多。如果对象可以在栈上分配，那么它的分配和回收都可以更快，从而提高程序的性能。</li>
<li><code>减少垃圾回收</code>：在Java中，对象的分配和回收是由垃圾回收器来完成的。如果对象可以在栈上分配，那么它就不会对堆内存的使用和垃圾回收产生影响，从而可以减少垃圾回收的频率和时间，提高程序的性能。</li>
</ol>
</li>
<li>
<p>我们可以添加VM参数</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-<span class="variable constant_">XX</span><span class="symbol">:-DoEscapeAnalysis</span></span><br></pre></td></tr></table></figure>
<p>关闭逃逸分析，然后再次执行代码，观察耗时情况</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute">0</span>	<span class="number">28100</span></span><br><span class="line"><span class="attribute">1</span>	<span class="number">28100</span></span><br><span class="line"><span class="attribute">2</span>	<span class="number">26400</span></span><br><span class="line"><span class="attribute">3</span>	<span class="number">26700</span></span><br><span class="line"><span class="attribute">4</span>	<span class="number">26700</span></span><br><span class="line"><span class="attribute">5</span>	<span class="number">26600</span></span><br><span class="line"><span class="attribute">6</span>	<span class="number">26600</span></span><br><span class="line"><span class="attribute">7</span>	<span class="number">26300</span></span><br><span class="line"><span class="attribute">8</span>	<span class="number">26400</span></span><br><span class="line"><span class="attribute">9</span>	<span class="number">26400</span></span><br><span class="line"><span class="attribute">10</span>	<span class="number">26500</span></span><br><span class="line"><span class="attribute">11</span>	<span class="number">26700</span></span><br><span class="line"><span class="attribute">12</span>	<span class="number">25900</span></span><br><span class="line"><span class="attribute">13</span>	<span class="number">39200</span></span><br><span class="line"><span class="attribute">14</span>	<span class="number">26700</span></span><br><span class="line"><span class="attribute">15</span>	<span class="number">26400</span></span><br><span class="line"><span class="attribute">16</span>	<span class="number">26600</span></span><br><span class="line"><span class="attribute">17</span>	<span class="number">35300</span></span><br><span class="line"><span class="attribute">18</span>	<span class="number">26400</span></span><br><span class="line"><span class="attribute">19</span>	<span class="number">26800</span></span><br><span class="line"><span class="attribute">20</span>	<span class="number">28600</span></span><br><span class="line"><span class="attribute">21</span>	<span class="number">28100</span></span><br><span class="line"><span class="attribute">22</span>	<span class="number">28700</span></span><br><span class="line"><span class="attribute">23</span>	<span class="number">28100</span></span><br><span class="line"><span class="attribute">24</span>	<span class="number">29900</span></span><br><span class="line"><span class="attribute">25</span>	<span class="number">33800</span></span><br><span class="line"><span class="attribute">26</span>	<span class="number">31300</span></span><br><span class="line"><span class="attribute">27</span>	<span class="number">29700</span></span><br><span class="line"><span class="attribute">28</span>	<span class="number">28500</span></span><br><span class="line"><span class="attribute">29</span>	<span class="number">26700</span></span><br><span class="line"><span class="attribute">30</span>	<span class="number">30900</span></span><br><span class="line"><span class="attribute">31</span>	<span class="number">30100</span></span><br><span class="line"><span class="attribute">32</span>	<span class="number">26700</span></span><br><span class="line"><span class="attribute">33</span>	<span class="number">30300</span></span><br><span class="line"><span class="attribute">34</span>	<span class="number">29700</span></span><br><span class="line"><span class="attribute">35</span>	<span class="number">26200</span></span><br><span class="line"><span class="attribute">36</span>	<span class="number">26200</span></span><br><span class="line"><span class="attribute">37</span>	<span class="number">28700</span></span><br><span class="line"><span class="attribute">38</span>	<span class="number">26800</span></span><br><span class="line"><span class="attribute">39</span>	<span class="number">29700</span></span><br><span class="line"><span class="attribute">40</span>	<span class="number">28600</span></span><br><span class="line"><span class="attribute">41</span>	<span class="number">30100</span></span><br><span class="line"><span class="attribute">42</span>	<span class="number">30700</span></span><br><span class="line"><span class="attribute">43</span>	<span class="number">28300</span></span><br><span class="line"><span class="attribute">44</span>	<span class="number">34000</span></span><br><span class="line"><span class="attribute">45</span>	<span class="number">26400</span></span><br><span class="line"><span class="attribute">46</span>	<span class="number">26100</span></span><br><span class="line"><span class="attribute">47</span>	<span class="number">28800</span></span><br><span class="line"><span class="attribute">48</span>	<span class="number">26800</span></span><br><span class="line"><span class="attribute">49</span>	<span class="number">28000</span></span><br><span class="line"><span class="attribute">50</span>	<span class="number">37800</span></span><br><span class="line"><span class="attribute">51</span>	<span class="number">27600</span></span><br><span class="line"><span class="attribute">52</span>	<span class="number">33700</span></span><br><span class="line"><span class="attribute">53</span>	<span class="number">36600</span></span><br><span class="line"><span class="attribute">54</span>	<span class="number">26900</span></span><br><span class="line"><span class="attribute">55</span>	<span class="number">25900</span></span><br><span class="line"><span class="attribute">56</span>	<span class="number">35500</span></span><br><span class="line"><span class="attribute">57</span>	<span class="number">26100</span></span><br><span class="line"><span class="attribute">58</span>	<span class="number">26100</span></span><br><span class="line"><span class="attribute">59</span>	<span class="number">26300</span></span><br><span class="line"><span class="attribute">60</span>	<span class="number">26000</span></span><br><span class="line"><span class="attribute">61</span>	<span class="number">29800</span></span><br><span class="line"><span class="attribute">62</span>	<span class="number">27600</span></span><br><span class="line"><span class="attribute">63</span>	<span class="number">30800</span></span><br><span class="line"><span class="attribute">64</span>	<span class="number">26900</span></span><br><span class="line"><span class="attribute">65</span>	<span class="number">26800</span></span><br><span class="line"><span class="attribute">66</span>	<span class="number">27100</span></span><br><span class="line"><span class="attribute">67</span>	<span class="number">11800</span></span><br><span class="line"><span class="attribute">68</span>	<span class="number">6800</span></span><br><span class="line"><span class="attribute">69</span>	<span class="number">7500</span></span><br><span class="line"><span class="attribute">70</span>	<span class="number">8500</span></span><br><span class="line"><span class="attribute">71</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">72</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">73</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">74</span>	<span class="number">6800</span></span><br><span class="line"><span class="attribute">75</span>	<span class="number">6800</span></span><br><span class="line"><span class="attribute">76</span>	<span class="number">11300</span></span><br><span class="line"><span class="attribute">77</span>	<span class="number">8800</span></span><br><span class="line"><span class="attribute">78</span>	<span class="number">10200</span></span><br><span class="line"><span class="attribute">79</span>	<span class="number">10500</span></span><br><span class="line"><span class="attribute">80</span>	<span class="number">8400</span></span><br><span class="line"><span class="attribute">81</span>	<span class="number">6800</span></span><br><span class="line"><span class="attribute">82</span>	<span class="number">8400</span></span><br><span class="line"><span class="attribute">83</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">84</span>	<span class="number">6700</span></span><br><span class="line"><span class="attribute">85</span>	<span class="number">7000</span></span><br><span class="line"><span class="attribute">86</span>	<span class="number">8100</span></span><br><span class="line"><span class="attribute">87</span>	<span class="number">6700</span></span><br><span class="line"><span class="attribute">88</span>	<span class="number">6700</span></span><br><span class="line"><span class="attribute">89</span>	<span class="number">7000</span></span><br><span class="line"><span class="attribute">90</span>	<span class="number">9100</span></span><br><span class="line"><span class="attribute">91</span>	<span class="number">12700</span></span><br><span class="line"><span class="attribute">92</span>	<span class="number">13000</span></span><br><span class="line"><span class="attribute">93</span>	<span class="number">11100</span></span><br><span class="line"><span class="attribute">94</span>	<span class="number">7700</span></span><br><span class="line"><span class="attribute">95</span>	<span class="number">5700</span></span><br><span class="line"><span class="attribute">96</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">97</span>	<span class="number">8600</span></span><br><span class="line"><span class="attribute">98</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">99</span>	<span class="number">7400</span></span><br><span class="line"><span class="attribute">100</span>	<span class="number">6700</span></span><br><span class="line"><span class="attribute">101</span>	<span class="number">13100</span></span><br><span class="line"><span class="attribute">102</span>	<span class="number">20000</span></span><br><span class="line"><span class="attribute">103</span>	<span class="number">9600</span></span><br><span class="line"><span class="attribute">104</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">105</span>	<span class="number">7200</span></span><br><span class="line"><span class="attribute">106</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">107</span>	<span class="number">6000</span></span><br><span class="line"><span class="attribute">108</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">109</span>	<span class="number">6700</span></span><br><span class="line"><span class="attribute">110</span>	<span class="number">6800</span></span><br><span class="line"><span class="attribute">111</span>	<span class="number">7000</span></span><br><span class="line"><span class="attribute">112</span>	<span class="number">6700</span></span><br><span class="line"><span class="attribute">113</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">114</span>	<span class="number">9500</span></span><br><span class="line"><span class="attribute">115</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">116</span>	<span class="number">7200</span></span><br><span class="line"><span class="attribute">117</span>	<span class="number">7000</span></span><br><span class="line"><span class="attribute">118</span>	<span class="number">7000</span></span><br><span class="line"><span class="attribute">119</span>	<span class="number">7000</span></span><br><span class="line"><span class="attribute">120</span>	<span class="number">6600</span></span><br><span class="line"><span class="attribute">121</span>	<span class="number">6800</span></span><br><span class="line"><span class="attribute">122</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">123</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">124</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">125</span>	<span class="number">6800</span></span><br><span class="line"><span class="attribute">126</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">127</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">128</span>	<span class="number">11700</span></span><br><span class="line"><span class="attribute">129</span>	<span class="number">11400</span></span><br><span class="line"><span class="attribute">130</span>	<span class="number">10300</span></span><br><span class="line"><span class="attribute">131</span>	<span class="number">10500</span></span><br><span class="line"><span class="attribute">132</span>	<span class="number">27200</span></span><br><span class="line"><span class="attribute">133</span>	<span class="number">11800</span></span><br><span class="line"><span class="attribute">134</span>	<span class="number">13200</span></span><br><span class="line"><span class="attribute">135</span>	<span class="number">73400</span></span><br><span class="line"><span class="attribute">136</span>	<span class="number">33800</span></span><br><span class="line"><span class="attribute">137</span>	<span class="number">8200</span></span><br><span class="line"><span class="attribute">138</span>	<span class="number">7500</span></span><br><span class="line"><span class="attribute">139</span>	<span class="number">6400</span></span><br><span class="line"><span class="attribute">140</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">141</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">142</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">143</span>	<span class="number">13100</span></span><br><span class="line"><span class="attribute">144</span>	<span class="number">7400</span></span><br><span class="line"><span class="attribute">145</span>	<span class="number">6600</span></span><br><span class="line"><span class="attribute">146</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">147</span>	<span class="number">6000</span></span><br><span class="line"><span class="attribute">148</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">149</span>	<span class="number">6000</span></span><br><span class="line"><span class="attribute">150</span>	<span class="number">5200</span></span><br><span class="line"><span class="attribute">151</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">152</span>	<span class="number">6000</span></span><br><span class="line"><span class="attribute">153</span>	<span class="number">6000</span></span><br><span class="line"><span class="attribute">154</span>	<span class="number">5200</span></span><br><span class="line"><span class="attribute">155</span>	<span class="number">9600</span></span><br><span class="line"><span class="attribute">156</span>	<span class="number">8800</span></span><br><span class="line"><span class="attribute">157</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">158</span>	<span class="number">5600</span></span><br><span class="line"><span class="attribute">159</span>	<span class="number">6700</span></span><br><span class="line"><span class="attribute">160</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">161</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">162</span>	<span class="number">5800</span></span><br><span class="line"><span class="attribute">163</span>	<span class="number">6500</span></span><br><span class="line"><span class="attribute">164</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">165</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">166</span>	<span class="number">6000</span></span><br><span class="line"><span class="attribute">167</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">168</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">169</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">170</span>	<span class="number">5900</span></span><br><span class="line"><span class="attribute">171</span>	<span class="number">7100</span></span><br><span class="line"><span class="attribute">172</span>	<span class="number">7900</span></span><br><span class="line"><span class="attribute">173</span>	<span class="number">6400</span></span><br><span class="line"><span class="attribute">174</span>	<span class="number">6400</span></span><br><span class="line"><span class="attribute">175</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">176</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">177</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">178</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">179</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">180</span>	<span class="number">6900</span></span><br><span class="line"><span class="attribute">181</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">182</span>	<span class="number">6500</span></span><br><span class="line"><span class="attribute">183</span>	<span class="number">5900</span></span><br><span class="line"><span class="attribute">184</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">185</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">186</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">187</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">188</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">189</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">190</span>	<span class="number">9100</span></span><br><span class="line"><span class="attribute">191</span>	<span class="number">8500</span></span><br><span class="line"><span class="attribute">192</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">193</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">194</span>	<span class="number">6000</span></span><br><span class="line"><span class="attribute">195</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">196</span>	<span class="number">6300</span></span><br><span class="line"><span class="attribute">197</span>	<span class="number">6100</span></span><br><span class="line"><span class="attribute">198</span>	<span class="number">6200</span></span><br><span class="line"><span class="attribute">199</span>	<span class="number">5900</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="方法内联-Inlining">方法内联(Inlining)</h3>
<ul>
<li>
<p>方法内联</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">JAVA</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">square</span>(<span class="params"><span class="built_in">int</span> i</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> i * i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.<span class="keyword">out</span>.println(square(<span class="number">9</span>));</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>如果发现square是热点方法，且长度不太长时，会进行内联，所谓的内联就是把方法内代码拷贝，病粘贴到调用者的位置</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">System.<span class="keyword">out</span>.printl<span class="meta">n</span>(9 <span class="comment">* 9);</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>还能够进行常量折叠(constant folding)的优化</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">System</span>.<span class="keyword">out</span>.println(<span class="number">81</span>);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>下面来验证一下，还是输出耗时</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="number">0	81	25200</span></span><br><span class="line"><span class="number">1	81	24100</span></span><br><span class="line"><span class="number">2	81	19800</span></span><br><span class="line"><span class="number">3	81	20000</span></span><br><span class="line"><span class="number">4	81	20200</span></span><br><span class="line"></span><br><span class="line">···</span><br><span class="line"></span><br><span class="line"><span class="number">73	81	19600</span></span><br><span class="line"><span class="number">74	81	20000</span></span><br><span class="line"><span class="number">75	81	9000</span></span><br><span class="line"><span class="number">76	81	2300</span></span><br><span class="line"><span class="number">77	81	2300</span></span><br><span class="line"><span class="number">78	81	3400</span></span><br><span class="line"></span><br><span class="line">···</span><br><span class="line"></span><br><span class="line"><span class="number">267</span>	<span class="number">81</span>	<span class="number">3900</span></span><br><span class="line"><span class="number">268</span>	<span class="number">81	51900</span></span><br><span class="line"><span class="number">269</span>	<span class="number">81	15900</span></span><br><span class="line"><span class="number">270	81	100</span></span><br><span class="line"><span class="number">271	81	0</span></span><br><span class="line"><span class="number">272	81	0</span></span><br><span class="line"><span class="number">273	81	100</span></span><br><span class="line"><span class="number">274	81	100</span></span><br><span class="line"><span class="number">275	81	0</span></span><br><span class="line"><span class="number">276	81	0</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>最后耗时为0，就是进行了常量折叠的优化</p>
</li>
<li>
<p>我们可以添加VM参数<code>-XX:+UnlockDiagnosticVMOptions -XX:+PrintInlining</code>打印内联信息，可以看到我们的square方法被标记为了热点代码<br>
<a target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/04/10/ppqMt5F.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/04/10/ppqMt5F.png" alt="img"></a></p>
</li>
<li>
<p>同时也可以禁止某个方法的内联</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-<span class="variable constant_">XX</span><span class="symbol">:CompileCommand=dontinline</span>,*<span class="variable constant_">JIT2</span>.square</span><br></pre></td></tr></table></figure>
<p>，不能进行常量折叠优化了，速度不会到达0</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">JAVA</span></span><br><span class="line"></span><br><span class="line"><span class="string">···</span></span><br><span class="line"></span><br><span class="line"><span class="number">495</span>	<span class="number">81</span>	<span class="number">3300</span></span><br><span class="line"><span class="number">496</span>	<span class="number">81</span>	<span class="number">3700</span></span><br><span class="line"><span class="number">497</span>	<span class="number">81</span>	<span class="number">3000</span></span><br><span class="line"><span class="number">498</span>	<span class="number">81</span>	<span class="number">2900</span></span><br><span class="line"><span class="number">499</span>	<span class="number">81</span>	<span class="number">2900</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="字段优化">字段优化</h3>
<ul>
<li>
<p>JMH基准测试参考：<a target="_blank" rel="noopener" href="https://openjdk.org/projects/code-tools/jmh/">https://openjdk.org/projects/code-tools/jmh/</a></p>
</li>
<li>
<p>添加如下依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">XML</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openjdk.jmh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jmh-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.32<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openjdk.jmh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jmh-generator-annprocess<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.32<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编写基准测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="meta">@Warmup(iterations = 2, time = 1)</span></span><br><span class="line"><span class="meta">@Measurement(iterations = 5, time = 1)</span></span><br><span class="line"><span class="meta">@State(Scope.Benchmark)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Benchmark1</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] elements = randomInts(<span class="number">1_000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] randomInts(<span class="type">int</span> size) &#123;</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> ThreadLocalRandom.current();</span><br><span class="line">        <span class="type">int</span>[] values = <span class="keyword">new</span> <span class="title class_">int</span>[size];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            values[i] = random.nextInt();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> values;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Benchmark</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; elements.length; i++) &#123;</span><br><span class="line">            doSum(elements[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Benchmark</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] local = <span class="built_in">this</span>.elements;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; local.length; i++) &#123;</span><br><span class="line">            doSum(local[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Benchmark</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> element : elements) &#123;</span><br><span class="line">            doSum(element);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CompilerControl(CompilerControl.Mode.INLINE)</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doSum</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        sum += x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RunnerException &#123;</span><br><span class="line">        <span class="type">Options</span> <span class="variable">opt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OptionsBuilder</span>()</span><br><span class="line">                .include(Benchmark1.class.getSimpleName())</span><br><span class="line">                .forks(<span class="number">1</span>)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Runner</span>(opt).run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>@Warmup</code>注解表示在基准测试运行之前需要进行预热，以使JVM达到最佳运行状态。在这个例子中，预热进行了2次，每次持续1秒钟。</p>
</li>
<li>
<p><code>@Measurement</code>注解表示运行5次基准测试，每次持续1秒钟。</p>
</li>
<li>
<p><code>@State</code>注解定义了Benchmark1类的实例作用域为Scope.Benchmark，表示这个类的实例可以在不同的测试方法之间共享，并保持在整个基准测试运行期间的状态。</p>
</li>
<li>
<p>这个类包含了三个测试方法：test1、test2和test3。这些测试方法执行相同的操作，即对数组elements中的所有元素进行求和操作，但使用不同的方法来访问数组中的元素。test1使用了数组索引，test2使用了本地数组变量，而test3使用了foreach循环。</p>
</li>
<li>
<p>启用doSum的方法内联</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CompilerControl(CompilerControl.Mode.INLINE)</span></span><br></pre></td></tr></table></figure>
<p>，测试结果如下</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute">Benchmark</span>          Mode  Cnt        Score       Error  Units</span><br><span class="line"><span class="attribute">Benchmark1</span>.test1  thrpt    <span class="number">5</span>  <span class="number">2830851</span>.<span class="number">513</span> ± <span class="number">68534</span>.<span class="number">850</span>  ops/s</span><br><span class="line"><span class="attribute">Benchmark1</span>.test2  thrpt    <span class="number">5</span>  <span class="number">2844317</span>.<span class="number">417</span> ±  <span class="number">8097</span>.<span class="number">137</span>  ops/s</span><br><span class="line"><span class="attribute">Benchmark1</span>.test3  thrpt    <span class="number">5</span>  <span class="number">2849940</span>.<span class="number">840</span> ±  <span class="number">7190</span>.<span class="number">091</span>  ops/s</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>我们这里重点关注的是Score，现在开启了doSum的内联，这三种遍历方式的性能没有显著差异</p>
</li>
<li>
<p>那现在禁用doSum方法的内联<code>@CompilerControl(CompilerControl.Mode.DONT_INLINE)</code>，测试结果如下</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PLAINTEXT</span></span><br><span class="line"><span class="attribute">Benchmark</span>          Mode  Cnt       Score       Error  Units</span><br><span class="line"><span class="attribute">Benchmark1</span>.test1  thrpt    <span class="number">5</span>  <span class="number">313751</span>.<span class="number">710</span> ± <span class="number">34874</span>.<span class="number">348</span>  ops/s</span><br><span class="line"><span class="attribute">Benchmark1</span>.test2  thrpt    <span class="number">5</span>  <span class="number">388759</span>.<span class="number">125</span> ± <span class="number">90456</span>.<span class="number">387</span>  ops/s</span><br><span class="line"><span class="attribute">Benchmark1</span>.test3  thrpt    <span class="number">5</span>  <span class="number">394614</span>.<span class="number">041</span> ± <span class="number">50721</span>.<span class="number">161</span>  ops/s</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>这三种遍历方式的性能与之前相比，都下降了一个数量级，test2和test3的性能差异不大，test1的性能明显要差一点，这是为什么呢？</p>
</li>
<li>
<p>因为doSum方法是否内联，会影响elements成员变量的读取的优化</p>
<ul>
<li>
<p>如果doSum方法内联了，那么刚刚的test1方法会被优化成下面的样子（伪代码）</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line">@Benchmark</span><br><span class="line">public void test1() &#123;</span><br><span class="line">    <span class="regexp">//</span> elements.length 首次读取会缓存起来 -&gt; <span class="keyword">int</span>[] <span class="keyword">local</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; elements.length; i++) &#123;     <span class="regexp">//</span> 后续 <span class="number">999</span> 次 求长度 &lt;- <span class="keyword">local</span></span><br><span class="line">        sum += elements[i];                         <span class="regexp">//</span> <span class="number">1000</span> 次取下标 i 的元素 &lt;- <span class="keyword">local</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>如果doSum方法被内联，则循环中的每次对elements数组的访问都可以被优化，编译器可以将数组长度的读取操作提到循环外部，将elements数组的引用保存在本地变量中，从而避免了循环中每次访问数组引用的开销。这样，循环中只需要进行一次数组长度的读取，以及1000次对数组元素的访问操作，可以节省1999次对数组引用的访问。</p>
</li>
<li>
<p>如果doSum方法没有被内联，则循环中的每次对elements数组的访问都需要通过方法调用来完成，这会导致每次循环中都需要进行一次对数组引用的读取操作，因此不能进行上述优化。</p>
</li>
</ul>
</li>
</ul>
<h2 id="反射优化">反射优化</h2>
<ul>
<li>
<p>示例代码</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.<span class="keyword">Method</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Reflect1 &#123;</span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> foo() &#123;</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;foo...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) throws <span class="keyword">Exception</span> &#123;</span><br><span class="line">        <span class="keyword">Method</span> foo = Reflect1.<span class="keyword">class</span>.getMethod(&quot;foo&quot;);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">16</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">System</span>.<span class="keyword">out</span>.printf(&quot;%d\t&quot;, i);</span><br><span class="line">            foo.invoke(<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">in</span>.<span class="keyword">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>首先定义了一个名为<code>foo</code>的静态方法，该方法只是简单地输出一条字符串。</p>
</li>
<li>
<p>然后在main方法中，使用<code>Reflect1</code>类的<code>getMethod</code>方法获取名为<code>foo</code>的<code>Method</code>对象，以便之后进行反射调用。</p>
</li>
<li>
<p>接着使用循环调用反射方法，循环次数从0到16，每次循环都调用反射获取的Method对象的<code>invoke</code>方法，传入<code>null</code>作为静态方法的调用者。因为<code>foo</code>方法是静态方法，所以调用者可以为null。</p>
</li>
<li>
<p>最后使用<code>System.in.read()</code>方法暂停程序的运行，以便我们可以观察程序的输出结果。</p>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">package</span> sun.reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> sun.reflect.misc.ReflectUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NativeMethodAccessorImpl</span> <span class="title">extends</span> <span class="title">MethodAccessorImpl</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Method method;</span><br><span class="line">    <span class="keyword">private</span> DelegatingMethodAccessorImpl parent;</span><br><span class="line">    <span class="keyword">private</span> int numInvocations;</span><br><span class="line"></span><br><span class="line">    NativeMethodAccessorImpl(Method var1) &#123;</span><br><span class="line">        <span class="keyword">this</span>.method = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object invoke(Object var1, Object[] var2) throws IllegalArgumentException, InvocationTargetException &#123;</span><br><span class="line">        <span class="keyword">if</span> (++<span class="keyword">this</span>.numInvocations &gt; ReflectionFactory.inflationThreshold() &amp;&amp; !ReflectUtil.isVMAnonymousClass(<span class="keyword">this</span>.method.getDeclaringClass())) &#123;</span><br><span class="line">            MethodAccessorImpl var3 = (MethodAccessorImpl)(new MethodAccessorGenerator()).generateMethod(<span class="keyword">this</span>.method.getDeclaringClass(), <span class="keyword">this</span>.method.getName(), <span class="keyword">this</span>.method.getParameterTypes(), <span class="keyword">this</span>.method.getReturnType(), <span class="keyword">this</span>.method.getExceptionTypes(), <span class="keyword">this</span>.method.getModifiers());</span><br><span class="line">            <span class="keyword">this</span>.parent.setDelegate(var3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> invoke0(<span class="keyword">this</span>.method, var1, var2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void setParent(DelegatingMethodAccessorImpl var1) &#123;</span><br><span class="line">        <span class="keyword">this</span>.parent = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> static native Object invoke0(Method var0, Object var1, Object[] var2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>前15次调用使用的是NativeMethodAccessorImpl实现的MethodAccessor，该实现类使用JNI调用底层的C/C++代码实现方法调用。由于NativeMethodAccessorImpl的实现开销较大，因此前15次的反射调用的性能相对较差。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JAVA</span><br><span class="line"><span class="keyword">private</span> <span class="type">static</span> <span class="type">int</span> inflationThreshold = <span class="number">15</span>;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>而第16次调用则采用了GeneratedMethodAccessor1实现的MethodAccessor，这个实现类通常是使用Java字节码动态生成的，因此方法调用的性能比NativeMethodAccessorImpl更好。这是因为在第15次调用时，生成了一个新的MethodAccessorImpl实现类（MethodAccessorGenerator），并在下一次方法调用时使用该实现类，即第16次调用。</p>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>JVM类加载</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://w-zx.cc/posts/JVM04.html">https://w-zx.cc/posts/JVM04.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>爱学技术的小吴🏵</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2023-05-07</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2023-05-17</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JVM/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>JVM</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">投喂作者</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://i.postimg.cc/1tmk8v0k/QQ-20230520160616.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.postimg.cc/1tmk8v0k/QQ-20230520160616.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://i.postimg.cc/3JkHjbM7/QQ-20230520160610.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.postimg.cc/3JkHjbM7/QQ-20230520160610.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/SpringMVC01.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27062" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">SpringMVC</div></div></a></div><div class="next-post pull-right"><a href="/posts/SpringBootds.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27059" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SpringBoot电商项目</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/JVM02.html" title="JVM内存结构"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27059" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-05-17</div><div class="title">JVM内存结构</div></div></a></div><div><a href="/posts/JVM01.html" title="JVM导学"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27053" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-05-17</div><div class="title">JVM导学</div></div></a></div><div><a href="/posts/JVM03.html" title="JVM垃圾回收"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27057" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-05-17</div><div class="title">JVM垃圾回收</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">类文件结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AD%94%E6%95%B0"><span class="toc-text">魔数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC"><span class="toc-text">版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F%E6%B1%A0"><span class="toc-text">常量池</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%A0%87%E8%AF%86%E4%B8%8E%E7%BB%A7%E6%89%BF%E4%BF%A1%E6%81%AF"><span class="toc-text">访问标识与继承信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Field%E4%BF%A1%E6%81%AF"><span class="toc-text">Field信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Method%E4%BF%A1%E6%81%AF"><span class="toc-text">Method信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%8A%A0%E5%B1%9E%E6%80%A7"><span class="toc-text">附加属性</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">字节码指令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A5%E9%97%A8"><span class="toc-text">入门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#javap%E5%B7%A5%E5%85%B7"><span class="toc-text">javap工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E8%A7%A3%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-text">图解方法执行流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90-i"><span class="toc-text">分析 i++</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E6%8C%87%E4%BB%A4"><span class="toc-text">条件判断指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6%E6%8C%87%E4%BB%A4"><span class="toc-text">循环控制指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E7%BB%93%E6%9E%9C"><span class="toc-text">判断结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="toc-text">构造方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8"><span class="toc-text">方法调用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E6%80%81%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">多态的原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-text">异常处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8Efinally%E7%9A%84%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-text">关于finally的面试题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#synchronized"><span class="toc-text">synchronized</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">编译期处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-text">默认构造器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%8B%86%E8%A3%85%E7%AE%B1"><span class="toc-text">自动拆装箱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E9%9B%86%E5%90%88%E5%8F%96%E5%80%BC"><span class="toc-text">泛型集合取值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0"><span class="toc-text">可变参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#foreach%E5%BE%AA%E7%8E%AF"><span class="toc-text">foreach循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#switch%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">switch字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#switch%E6%9E%9A%E4%B8%BE"><span class="toc-text">switch枚举</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E7%B1%BB"><span class="toc-text">枚举类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#try-with-resources"><span class="toc-text">try-with-resources</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E9%87%8D%E5%86%99%E6%97%B6%E7%9A%84%E6%A1%A5%E6%8E%A5%E6%96%B9%E6%B3%95"><span class="toc-text">方法重写时的桥接方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E5%86%85%E9%83%A8%E7%B1%BB"><span class="toc-text">匿名内部类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">类加载阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD"><span class="toc-text">加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%93%BE%E6%8E%A5"><span class="toc-text">链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">类加载器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E5%AF%BC%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="toc-text">引导类加载器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%86%85%E8%81%94-Inlining"><span class="toc-text">方法内联(Inlining)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E4%BC%98%E5%8C%96"><span class="toc-text">字段优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E4%BC%98%E5%8C%96"><span class="toc-text">反射优化</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">格言🧬</p><div class="bg-ad"><div>再看看那个光点，它就在这里，这是家园，这是我们 —— 你所爱的每一个人，你认识的一个人，你听说过的每一个人，曾经有过的每一个人，都在它上面度过他们的一生✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启星辰之旅</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">猜你想看💡</p><ul class="ft-links"><li><a href="/posts/eec9786.html">魔改指南</a><a href="/box/nav/">网址导航</a></li><li><a href="/social/link/">我的朋友</a><a href="/comments/">留点什么</a></li><li><a href="/personal/about/">关于作者</a><a href="/archives/">文章归档</a></li><li><a href="/categories/">文章分类</a><a href="/tags/">文章标签</a></li><li><a href="/box/Gallery/">我的画廊</a><a href="/personal/bb/">我的唠叨</a></li><li><a href="/site/time/">建设进程</a><a href="/site/census/">网站统计</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">推荐友链⌛</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.fomal.cc/" title="Fomalhaut🥝"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/60e5d4e39da7c077.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2023</b></span><span><b>&nbsp;&nbsp;By 爱学技术的小吴🏵</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用多线部署，主线路托管于Vercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="本站数据分析得益于51la技术支持"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="本站已加入萌ICP豪华套餐，萌ICP备20226665号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/萌ICP备-20226665-fe1384.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="本网站经Service Worker分流至缤纷云对象存储"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-缤纷云-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="本站使用网盾星球提供CDN加速与防护"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-网盾星球-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本网站源码由Github提供存储仓库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="右键模式" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>关于博客</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>美化设置</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>切换全屏</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>打印页面</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'qRHraBhVfBon4UW97vUo6c6k-gzGzoHsz',
      appKey: 'KcuRFd21A85bofYWkqw7bO5M',
      placeholder: '',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      master: ''.split(','),
      friends: ''.split(','),
      tagMeta: '博主,小伙伴,访客'.split(','),
      metaPlaceholder: {},
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdnjs.cloudflare.com/ajax/libs/valine/1.4.18/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/canvas-fluttering-ribbon.min.js"></script><script src="//code.tidio.co/s6lf1eubpeuqxvderp74uj8qlp7dx0qc.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/算法/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍡 算法学习笔记 (3)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/C/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍉 C++笔记 (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/MyBatis/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍨 MyBatis笔记 (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/MySql/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍥 MySql笔记 (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/JVM/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍃 JVM笔记 (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/SpringBoot/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍑 SpringBoot笔记 (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/SpringCloud/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🥭 SpringCloud笔记 (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/SSM/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍃 SSM笔记 (3)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/Redis/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍂 Redis笔记 (3)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/JavaWeb/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍁 JavaWeb笔记 (7)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://w-zx.cc/categories/前端/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🌹 前端笔记 (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://w-zx.cc/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/f4ff8066a7ba7ab5adc730e776aadbc3.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/结构/&quot;);" href="javascript:void(0);">结构</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">计算机知识的学习</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/f38fc3400758385eff9bf77265ca2509.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/C/&quot;);" href="javascript:void(0);">C++</a><span class="categoryBar-list-count">5</span><span class="categoryBar-list-descr">C++</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/a8436f6a4af0bec512f29f9a8c71d86d.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/SpringCloud/&quot;);" href="javascript:void(0);">SpringCloud</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr">SpringCloud</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/c562fbb36709afc81f1068deacea08fd.md.png);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/JAVA/&quot;);" href="javascript:void(0);">JAVA</a><span class="categoryBar-list-count">5</span><span class="categoryBar-list-descr">JAVA</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/0fd95029a75de05623edc2512e94b0b8.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/JVM/&quot;);" href="javascript:void(0);">JVM</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr">JVM</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/8e17d3ab324aecc1164680e55d2b316e.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/JavaWeb/&quot;);" href="javascript:void(0);">JavaWeb</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr">JavaWeb</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/6675847a2f316263e92d7cacb5fee143.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/Redis/&quot;);" href="javascript:void(0);">Redis</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">Redis</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/0b571a5a0b0e91f4289ddeb7fe643f66.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/MyBatis/&quot;);" href="javascript:void(0);">MyBatis</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">MyBatis</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/987d0ff1c8f1f402cc76df347b79f660.md.png);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/MySql/&quot;);" href="javascript:void(0);">MySql</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">MySql</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/96a9486dfa9f0d06b9dd3aae8bca1c1d.md.jpg);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/SSM/&quot;);" href="javascript:void(0);">SSM</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">SSM</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/168c6a1a28074990a9919f48dc0b9abd.md.png);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/SpringBoot/&quot;);" href="javascript:void(0);">SpringBoot</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr">SpringBoot</span></li><li class="categoryBar-list-item" style="background:url(https://img.gejiba.com/images/3df36772603dcb3ec71392a2ed49543e.md.png);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/算法/&quot;);" href="javascript:void(0);">算法</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">算法</span></li><li class="categoryBar-list-item" style="background:url(undefined);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/前端/&quot;);" href="javascript:void(0);">前端</a><span class="categoryBar-list-count">5</span><span class="categoryBar-list-descr"></span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/shujuku02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27062" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/shujuku02.html&quot;);" href="javascript:void(0);" alt="">MYSQL</a><div class="blog-slider__text">数据库的基础学习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/shujuku02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/shujuku01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27065" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/shujuku01.html&quot;);" href="javascript:void(0);" alt="">MYSQL</a><div class="blog-slider__text">数据库的基础学习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/shujuku01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/sjms01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27065" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/sjms01.html&quot;);" href="javascript:void(0);" alt="">设计模式</a><div class="blog-slider__text">了解每个模式开发的使用环境</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/sjms01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/javaShuJu.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27056" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/javaShuJu.html&quot;);" href="javascript:void(0);" alt="">Java数据结构</a><div class="blog-slider__text">了解结构</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/javaShuJu.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/own01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27056" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-28</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/own01.html&quot;);" href="javascript:void(0);" alt="">个人学习路线</a><div class="blog-slider__text">自己的学习方向以及个人一些感悟</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/own01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/javawl.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27050" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/javawl.html&quot;);" href="javascript:void(0);" alt="">Java网络编程</a><div class="blog-slider__text">JAVA进阶模块,了解网络</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/javawl.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/hc01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27061" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/hc01.html&quot;);" href="javascript:void(0);" alt="">WebApi</a><div class="blog-slider__text">HTML+CSS复习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/hc01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/css01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27069" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/css01.html&quot;);" href="javascript:void(0);" alt="">CSS</a><div class="blog-slider__text">网页渲染基础知识</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/css01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/js02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27050" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/js02.html&quot;);" href="javascript:void(0);" alt="">JS</a><div class="blog-slider__text">JavaScript进阶教程</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/js02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/js01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27069" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/js01.html&quot;);" href="javascript:void(0);" alt="">JS</a><div class="blog-slider__text">JavaScript教程</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/js01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/html01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27055" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/html01.html&quot;);" href="javascript:void(0);" alt="">HTML</a><div class="blog-slider__text">网页制作基础知识</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/html01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/ES01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27063" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-28</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ES01.html&quot;);" href="javascript:void(0);" alt="">ElasticSearch</a><div class="blog-slider__text">搜素引擎，具备非常强大的功能，可以帮助我们从海量数据中快速找到需要的内容</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/ES01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/MQ01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27056" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/MQ01.html&quot;);" href="javascript:void(0);" alt="">MeassagerQueue</a><div class="blog-slider__text">消息队列，字面意思就是存放消息的队列，也就是事件驱动中的Broker</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/MQ01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/ruiji01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27067" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ruiji01.html&quot;);" href="javascript:void(0);" alt="">瑞吉外卖</a><div class="blog-slider__text">SpringBoot项目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/ruiji01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/ruiji02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27058" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ruiji02.html&quot;);" href="javascript:void(0);" alt="">瑞吉外卖优化</a><div class="blog-slider__text">SpringBoot项目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/ruiji02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/redis03.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27050" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/redis03.html&quot;);" href="javascript:void(0);" alt="">Redis高级</a><div class="blog-slider__text">一个基于内存的`key-value`结构数据库</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/redis03.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/springcloud01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27058" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/springcloud01.html&quot;);" href="javascript:void(0);" alt="">SpringCloud</a><div class="blog-slider__text">指定一套行之有效的标准来约数分布式架构</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/springcloud01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/ssm01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27069" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ssm01.html&quot;);" href="javascript:void(0);" alt="">ssm整合</a><div class="blog-slider__text">三个框架整合在一起，来完成我们的业务功能开发</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/ssm01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/springboot01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27056" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/springboot01.html&quot;);" href="javascript:void(0);" alt="">SpringBoot</a><div class="blog-slider__text">基于SpringBoot的完成SSM整合项目开发</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/springboot01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/git01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27060" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/git01.html&quot;);" href="javascript:void(0);" alt="">Git</a><div class="blog-slider__text">分布式版本控制工具，主要用于管理开发过程中的源代码文件</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/git01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/jdbc01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27067" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/jdbc01.html&quot;);" href="javascript:void(0);" alt="">JDBC</a><div class="blog-slider__text">数据库连接池,掌握数据库的使用</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/jdbc01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/redis02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27055" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/redis02.html&quot;);" href="javascript:void(0);" alt="">Redis基础</a><div class="blog-slider__text">一个基于内存的`key-value`结构数据库</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/redis02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/maven01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27068" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/maven01.html&quot;);" href="javascript:void(0);" alt="">Maven</a><div class="blog-slider__text">仓库的使用, 项目的优化处理, 分模块开发</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/maven01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/redis01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27067" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/redis01.html&quot;);" href="javascript:void(0);" alt="">Redis入门</a><div class="blog-slider__text">一个基于内存的`key-value`结构数据库</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/redis01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/linux01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27065" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/linux01.html&quot;);" href="javascript:void(0);" alt="">Linux</a><div class="blog-slider__text">操作系统</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/linux01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/doceker01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27050" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/doceker01.html&quot;);" href="javascript:void(0);" alt="">Docker</a><div class="blog-slider__text">决大型项目依赖关系复杂，不同组件依赖的兼容性问题</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/doceker01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/SpringBootds.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27059" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-07</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/SpringBootds.html&quot;);" href="javascript:void(0);" alt="">SpringBoot电商项目</a><div class="blog-slider__text">了解SpringBoot+Mybatis等的结构</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/SpringBootds.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/SpringMVC01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27062" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-07</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/SpringMVC01.html&quot;);" href="javascript:void(0);" alt="">SpringMVC</a><div class="blog-slider__text">SSM中的MVC基本使用</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/SpringMVC01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/C02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27068" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/C02.html&quot;);" href="javascript:void(0);" alt="">C++高级</a><div class="blog-slider__text">C++深入的研究</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/C02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/MyBatis01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27068" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/MyBatis01.html&quot;);" href="javascript:void(0);" alt="">MyBatis</a><div class="blog-slider__text">数据库Value-keys的基本使用</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/MyBatis01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/MyBatis02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27057" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/MyBatis02.html&quot;);" href="javascript:void(0);" alt="">MyBatis - Plus</a><div class="blog-slider__text">MyBatis的加强版本</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/MyBatis02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/C04.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27055" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/C04.html&quot;);" href="javascript:void(0);" alt="">C++进阶使用</a><div class="blog-slider__text">C++的使用</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/C04.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/C05.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27062" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/C05.html&quot;);" href="javascript:void(0);" alt="">C++通讯管理项目</a><div class="blog-slider__text">C++的使用</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/C05.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/C07.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27065" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/C07.html&quot;);" href="javascript:void(0);" alt="">C++职工系统项目</a><div class="blog-slider__text">C++职工系统项目, 更好的了解面向对象的知识</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/C07.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/C01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27069" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/C01.html&quot;);" href="javascript:void(0);" alt="">C++入门</a><div class="blog-slider__text">了解C++的基本语法和使用方法</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/C01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/SFzhdl.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27069" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-03</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/SFzhdl.html&quot;);" href="javascript:void(0);" alt="">栈和队列</a><div class="blog-slider__text">算法结构</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/SFzhdl.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/javaWeb03.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27057" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-28</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/javaWeb03.html&quot;);" href="javascript:void(0);" alt="">JavaWab(三)</a><div class="blog-slider__text">正式的开启软件的大门</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/javaWeb03.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/javaWeb02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27065" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/javaWeb02.html&quot;);" href="javascript:void(0);" alt="">JavaWab(二)</a><div class="blog-slider__text">正式的开启软件的大门</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/javaWeb02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/SFecs.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27068" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-01</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/SFecs.html&quot;);" href="javascript:void(0);" alt="">二叉树</a><div class="blog-slider__text">算法结构</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/SFecs.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/SFhs.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27064" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-02</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/SFhs.html&quot;);" href="javascript:void(0);" alt="">回溯</a><div class="blog-slider__text">算法结构</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/SFhs.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/javaWeb04.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27065" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/javaWeb04.html&quot;);" href="javascript:void(0);" alt="">JavaWab(四)</a><div class="blog-slider__text">正式的开启软件的大门</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/javaWeb04.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/JVM04.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27059" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-07</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/JVM04.html&quot;);" href="javascript:void(0);" alt="">JVM类加载</a><div class="blog-slider__text">JAVA中类的加载过程</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/JVM04.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/javaWeb01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27069" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-26</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/javaWeb01.html&quot;);" href="javascript:void(0);" alt="">JavaWab(一)</a><div class="blog-slider__text">正式的开启软件的大门</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/javaWeb01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/JVM03.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27057" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/JVM03.html&quot;);" href="javascript:void(0);" alt="">JVM垃圾回收</a><div class="blog-slider__text">JVM垃圾回收机制</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/JVM03.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/JVM01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27053" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-04</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/JVM01.html&quot;);" href="javascript:void(0);" alt="">JVM导学</a><div class="blog-slider__text">JVM入门导学</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/JVM01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/JVM02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27059" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/JVM02.html&quot;);" href="javascript:void(0);" alt="">JVM内存结构</a><div class="blog-slider__text">JVM的内存结构</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/JVM02.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/JVM05.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27063" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-08</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/JVM05.html&quot;);" href="javascript:void(0);" alt="">JAVA内存模型</a><div class="blog-slider__text">JAVA的内存模型</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/JVM05.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/javadx.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27053" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/javadx.html&quot;);" href="javascript:void(0);" alt="">Java面向对象</a><div class="blog-slider__text">进行深入学习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/javadx.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/java.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27064" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/java.html&quot;);" href="javascript:void(0);" alt="">Java</a><div class="blog-slider__text">进行一些基础的学习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/java.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/Spring01.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imgbed.link/file/27065" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/Spring01.html&quot;);" href="javascript:void(0);" alt="">Spring</a><div class="blog-slider__text">框架的搭建以及一些基本使用方法</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/Spring01.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>